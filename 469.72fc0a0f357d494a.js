"use strict";(self.webpackChunkngx_admin_demo=self.webpackChunkngx_admin_demo||[]).push([[469],{3469:(Nt,U,p)=>{p.r(U),p.d(U,{ReportModule:()=>Ut});var _=p(9808),N=p(4738),C=p(2497),t=p(5e3);let J=(()=>{class i{constructor(){}ngOnInit(){}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=t.Xpm({type:i,selectors:[["ngx-report"]],decls:1,vars:0,template:function(e,a){1&e&&t._UZ(0,"router-outlet")},directives:[C.lC],encapsulation:2}),i})();var c=p(8279),v=p(4847),x=p(8246),b=p(5331),y=p(2340),D=p(3858),A=p(7313);let k=(()=>{class i extends A.Z{constructor(){super(),this.defineOptions({chartTitle:"Thickness vs Year",yTitle:"Thickness (mm)",xTitle:"Year"})}ngOnInit(){this.generateChart("DashboardThickness")}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=t.Xpm({type:i,selectors:[["ngx-dashboard-thickness-chart"]],features:[t.qOj],decls:1,vars:0,consts:[["id","DashboardThickness"]],template:function(e,a){1&e&&t._UZ(0,"canvas",0)},encapsulation:2}),i})(),S=(()=>{class i extends A.Z{constructor(){super(),this.defineOptions({chartTitle:"Remaining Life vs Year",yTitle:"Remaining Life (years)",xTitle:"Year"})}ngOnInit(){this.generateChart("DashboardRemaining")}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=t.Xpm({type:i,selectors:[["ngx-dashboard-remaining-chart"]],features:[t.qOj],decls:1,vars:0,consts:[["id","DashboardRemaining"]],template:function(e,a){1&e&&t._UZ(0,"canvas",0)},encapsulation:2}),i})();var L=p(8539),Y=p(520);let O=(()=>{class i{constructor(e){this.httpClient=e,this.apiUrl=y.N.apiUrl}getAssetsReport(e){return this.httpClient.get(this.apiUrl+"/asset_report/"+e)}getCircuitReport(e){return this.httpClient.get(this.apiUrl+"/circuit_report/"+e)}}return i.\u0275fac=function(e){return new(e||i)(t.LFG(Y.eN))},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();var M=p(7024),u=p(3254),Q=p(9371),T=p(4204),w=p(7531);function j(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"nb-option",25),t.NdJ("click",function(){const r=t.CHM(e).$implicit;return t.oxw().filterByClass(r)}),t._uU(1),t.qZA()}if(2&i){const e=n.$implicit;t.Q6J("value",e),t.xp6(1),t.Oqu(e)}}const z=function(){return{width:"40px"}};function E(i,n){1&i&&(t.TgZ(0,"th",26),t._uU(1," Piping ID "),t.qZA()),2&i&&t.Q6J("ngStyle",t.DdM(1,z))}const G=function(i){return{color:i}};function $(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"td",27,28),t.NdJ("mouseover",function(){return t.CHM(e),t.MAs(1).style.color="#0492c2"})("mouseout",function(){const r=t.CHM(e).$implicit;return t.MAs(1).style.color=t.oxw().pipeData==r?"#0492c2":"black"})("click",function(){const r=t.CHM(e).$implicit;return t.oxw().showData(r)}),t._uU(2),t.qZA()}if(2&i){const e=n.$implicit,a=t.oxw();t.Q6J("ngStyle",t.VKq(2,G,a.pipeData==e?"#0492c2":"black")),t.xp6(2),t.hij(" ",e.piping_id," ")}}function B(i,n){1&i&&t._UZ(0,"tr",29)}function V(i,n){1&i&&t._UZ(0,"tr",30)}function X(i,n){1&i&&(t.TgZ(0,"h5"),t._uU(1,"Please Add Asset Data."),t.qZA())}function W(i,n){1&i&&(t.TgZ(0,"span"),t._uU(1,"No Image Available"),t.qZA())}function K(i,n){if(1&i&&(t.TgZ(0,"div",47)(1,"div",48),t._UZ(2,"img",49),t.qZA()()),2&i){const e=n.$implicit;t.Q6J("ngClass",0==n.index?"active":""),t.xp6(2),t.Q6J("src",e.src,t.LSH)("alt",null==e?null:e.alt)}}function tt(i,n){if(1&i&&(t.TgZ(0,"div",50)(1,"span",51),t._uU(2),t.qZA(),t.TgZ(3,"span",4),t._uU(4),t.qZA()()),2&i){const e=n.$implicit,a=t.oxw(2);t.xp6(2),t.Oqu(e.name),t.xp6(2),t.Oqu(a.pipeData[e.props])}}function et(i,n){if(1&i&&(t.TgZ(0,"section")(1,"h6",17),t._uU(2),t.qZA(),t.TgZ(3,"div",3)(4,"div",31)(5,"div",32)(6,"div",33),t.YNc(7,W,2,0,"span",16),t.YNc(8,K,3,3,"div",34),t.qZA(),t.TgZ(9,"button",35),t._UZ(10,"span",36),t.TgZ(11,"span",37),t._uU(12,"Previous"),t.qZA()(),t.TgZ(13,"button",38),t._UZ(14,"span",39),t.TgZ(15,"span",37),t._uU(16,"Next"),t.qZA()()()(),t.TgZ(17,"div",40)(18,"div")(19,"div",41),t._UZ(20,"ngx-qrcode",42),t.qZA(),t.TgZ(21,"button",43),t._uU(22,"See Attachment"),t.qZA()()()(),t.TgZ(23,"div",44)(24,"span",45),t._uU(25,"Date In Service"),t.qZA(),t.TgZ(26,"span",31),t._uU(27),t.qZA(),t.TgZ(28,"span",45),t._uU(29,"Class"),t.qZA(),t.TgZ(30,"span",31),t._uU(31),t.qZA(),t.TgZ(32,"span",45),t._uU(33,"Notes"),t.qZA(),t.TgZ(34,"span",31),t._uU(35),t.qZA()(),t.TgZ(36,"span",46),t._uU(37,"Recomendation"),t.qZA(),t.TgZ(38,"p"),t._uU(39),t.qZA(),t.TgZ(40,"div",21),t.YNc(41,tt,5,2,"div",22),t.qZA()()),2&i){const e=t.oxw();t.xp6(2),t.hij("Piping Assets ",null==e.pipeData?null:e.pipeData.piping_id,""),t.xp6(5),t.Q6J("ngIf",!e.imageLink),t.xp6(1),t.Q6J("ngForOf",e.imageLink),t.xp6(12),t.Q6J("elementType",e.elementType)("errorCorrectionLevel",e.correctionLevel)("value",e.value),t.xp6(7),t.Oqu((null==e.pipeData?null:e.pipeData.date_in_service)||"-"),t.xp6(4),t.Oqu((null==e.pipeData?null:e.pipeData.class)||"-"),t.xp6(4),t.Oqu((null==e.pipeData?null:e.pipeData.notes)||"-"),t.xp6(4),t.Oqu((null==e.pipeData?null:e.pipeData.recomendation)||"-"),t.xp6(2),t.Q6J("ngForOf",e.spesificationItem)}}function it(i,n){if(1&i&&(t.TgZ(0,"div",3)(1,"span",52),t._uU(2),t.qZA(),t.TgZ(3,"span",4),t._uU(4),t.qZA()()),2&i){const e=n.$implicit;t.xp6(2),t.Oqu(e.name),t.xp6(2),t.Oqu(e.data||"-")}}function at(i,n){if(1&i&&(t.TgZ(0,"div",50)(1,"span",51),t._uU(2),t.qZA(),t.TgZ(3,"span",4),t._uU(4),t.qZA()()),2&i){const e=n.$implicit;t.xp6(2),t.Oqu(e.name),t.xp6(2),t.Oqu((null==e?null:e.data)||"-")}}const R=function(){return{show:!1}};function nt(i,n){if(1&i&&t._UZ(0,"ngx-mat-table",23),2&i){const e=t.oxw();t.Q6J("tableHeader",t.DdM(4,R))("tableFooter",t.DdM(5,R))("columnDetails",e.inspectionHistoryDetails)("tableData",e.inspectionHistoryData)}}const st=function(){return["All",1,2,3,4]},rt=function(){return{pageSize:5}};let ot=(()=>{class i{constructor(e,a,s,r,o){this.pipingAssetsService=e,this.reportService=a,this.variables=s,this.toastr=r,this.thicknesService=o,this.elementType=x.TT.URL,this.correctionLevel=x.Jk.HIGH,this.value="https://www.google.com/",this.tablePosition=[],this.displayedColumns=["piping_id"],this.resultsLength=0,this.imageLink=[],this.spesificationItem=[{props:"nominal_pipe_size",name:"Nominal Pipe Size",unit:"mm"},{props:"pipe_design_code",name:"Pipe Design Code"},{props:"schedule",name:"Schedule",unit:"mm"},{props:"outside_diameter",name:"Outside Diameter"},{props:"longtd_quality_factor",name:"Longtd. Quality Factor (E)"},{props:"weld_joint_factor",name:"Weld Joint Factor (W)"},{props:"allowable_unit_stress",name:"Allowable Unit Stress (S)",unit:"psi"},{props:"coefficient",name:"Coefficient (Y)"},{props:"min_design_pressure",name:"Min. Design Pressure (P min)",unit:"psig"},{props:"max_design_pressure",name:"Max. Design Pressure (P max)",unit:"psig"},{props:"min_design_temperature",name:"Min. Design Temperature (T min)",unit:"F"},{props:"max_design_temperature",name:"Max Design Temperature (T max)",unit:"F"},{props:"corrosion_allowance",name:"Corrosion Allowance",unit:"mm"},{props:"mechanical_allowance",name:"Mechanical Allowances",unit:"mm"},{props:"min_structural_thickness",name:"Min. Structural Thickness",unit:"mm"},{props:"min_alert_thickness",name:"Min. Alert Thickness",unit:"mm"},{props:"nominal_thickness",name:"Nominal Thickness",unit:"mm"}],this.pipingVisual=[{name:"Leaks",props:"leaks_condition",data:null},{name:"Misalignment",props:"misalignment_condition",data:null},{name:"Vibration",props:"vibration_condition",data:null},{name:"Supports",props:"supports_condition",data:null},{name:"Corrosion",props:"corrosion_condition",data:null},{name:"Insulation",props:"insulation_condition",data:null}],this.pipingThickness=[{name:"Reading",props:"reading"},{name:"Long Term Cr",props:"lt_cr"},{name:"Remaining Life",props:"remaining_life"},{name:"Thick. Min",props:"t_min"},{name:"Short Term CR",props:"st_cr"},{name:"Half Life",props:"half_life"},{name:"Retirement Date",props:"retirement_date"}],this.damageMechanismDetails=[{type:"text",prop:"piping_damage_mechanism",head:"Piping Damage Mechanism",width:"200px"},{type:"text",prop:"notes",head:"Notes",width:"200px"},{type:"text",prop:"type_location",head:"Expected Type/Location",width:"200px"},{type:"text",prop:"last_insp_date",head:"Last Insp.Date",width:"200px"},{type:"text",prop:"insp_due_date",head:"Insp. Due Date",width:"200px"}],this.inspectionHistoryData=[],this.inspectionHistoryDetails=[{type:"text",prop:"proposal_id",head:"Inspection Id",width:"100px"},{type:"editable date",prop:"inspection_date",head:"Inspection Date",width:"200px"},{type:"text",prop:"inspection_summary",head:"Inspection Summary",width:"300px"},{type:"check",prop:"caried_out",head:"Caried Out",width:"50px"}]}ngOnInit(){this.thicknesService.getDataThickness().subscribe(({data:e})=>{this.tablePosition=e;const a=e[0];!a||(this.showData(a),this.getReportData(null==a?void 0:a.id),this.dataSource=new c.by(e),this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort)},()=>this.toastr.danger("Please add asset data.","Data not found."))}getReportData(e){this.reportService.getAssetsReport(e).subscribe(({data:{damage_mechanism:a,visual_condition:s,proposal:r,asset:o,cml:h}})=>{var g,f;this.damageMechanismData=null===(g=this.variables.damageMechanismName)||void 0===g?void 0:g.map(({id:l,piping_damage_mechanism:m})=>{const d=null==a?void 0:a[l];return d?Object.assign(Object.assign({},d),{piping_damage_mechanism:m}):null}).filter(l=>null!=l),this.viewTable.regenerateTable(this.damageMechanismData),this.pipingVisual=this.pipingVisual.map(({name:l,props:m})=>{var d;return{name:l,props:m,data:null!==(d=s[m])&&void 0!==d?d:null}}),this.inspectionHistoryData=[Object.assign(Object.assign({},r),{inspection_summary:null===(f=null==r?void 0:r.inspection_method)||void 0===f?void 0:f.map(({type:l,method:m,technique:d})=>` ${l} ${m} ${d}`)})],this.pipingThickness=this.pipingThickness.map(({name:l,props:m})=>{const{reading:d,min_required_thickness:Z,lt_cr:P,st_cr:q,remaining_life:kt,half_life:St,retirement_date:Ot,next_tm_insp_date:Mt,next_ve_insp_date:Ft,mawp:Ht}=this.variables.getThicknessCalculation(Object.assign(Object.assign({},o),{cml:h}));return{name:l,props:m,data:Object.assign(Object.assign({},o),{reading:d.toFixed(4),t_min:Z.toFixed(4),lt_cr:P.toFixed(4),st_cr:q.toFixed(4),remaining_life:kt.toFixed(4),half_life:St.toFixed(4),retirement_date:Ot,next_tm_insp_date:Mt,next_ve_insp_date:Ft,mawp:Ht.toFixed(4)})[m]}})},()=>this.toastr.danger("Please add asset data.","Data not found."))}showData(e){var a;this.pipeData=e,this.imageLink="object"==typeof e.images?null===(a=null==e?void 0:e.images)||void 0===a?void 0:a.map(s=>({src:y.N.apiUrl+"/image/"+s,alt:"Pipe Asssets"})):[],e&&(this.variables.removeChartData(this.thicknessChart),this.variables.removeChartData(this.remainingChart),this.thicknessChartData(this.thicknessChart,e),this.remainingLifeChartData(this.remainingChart,e))}thicknessChartData(e,{cml:a}){const{datasets:s,allYear:r}=this.variables.getCharCML(a,"last_thickness_reading");e.data.labels=r,e.chart.data.datasets=s,e.chart.update()}corrosionChartData(e,a){const s=this.variables.getCMLCalc(a),{datasets:r,allYear:o}=this.variables.getCharCML(s,"lt_cr");e.data.labels=o,e.chart.data.datasets=r,e.chart.update()}remainingLifeChartData(e,a){const s=this.variables.getCMLCalc(a),{datasets:r,allYear:o}=this.variables.getCharCML(s,"remaining_life");e.data.labels=o,e.chart.data.datasets=r,e.chart.update()}filterByClass(e){let a=this.tablePosition.filter(s=>s.class==e);"All"==e&&(a=this.tablePosition),this.dataSource=new c.by(a)}applyFilter(e){this.dataSource.filter=e.target.value.trim().toLowerCase(),this.dataSource.paginator&&this.dataSource.paginator.firstPage()}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(L.M),t.Y36(O),t.Y36(M.L),t.Y36(u.quB),t.Y36(Q.O))},i.\u0275cmp=t.Xpm({type:i,selectors:[["ngx-report-piping-assets"]],viewQuery:function(e,a){if(1&e&&(t.Gf(D.V,5),t.Gf(b.NW,5),t.Gf(v.YE,5),t.Gf(k,5),t.Gf(S,5)),2&e){let s;t.iGM(s=t.CRH())&&(a.viewTable=s.first),t.iGM(s=t.CRH())&&(a.paginator=s.first),t.iGM(s=t.CRH())&&(a.sort=s.first),t.iGM(s=t.CRH())&&(a.thicknessChart=s.first),t.iGM(s=t.CRH())&&(a.remainingChart=s.first)}},decls:53,vars:19,consts:[[1,"d-flex","justify-content-between"],["matInput","","placeholder","Ex. Mia",3,"keyup"],["input",""],[1,"row"],[1,"col"],["placeholder","Class","status","primary","size","small",1,"mx-5"],[3,"value","click",4,"ngFor","ngForOf"],[1,"col-3"],["mat-table","","matSort","",1,"mat-elevation-z8",2,"width","100%","box-shadow","none",3,"dataSource"],["matColumnDef","piping_id"],["mat-header-cell","","mat-sort-header","",3,"ngStyle",4,"matHeaderCellDef"],["mat-cell","","style","cursor : pointer",3,"ngStyle","mouseover","mouseout","click",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",4,"matRowDef","matRowDefColumns"],["aria-label","Select page of GitHub search results",3,"length","pageSize"],[1,"col-9"],[4,"ngIf"],[1,"fw-bolder","text-primary","mb-2","d-block"],[1,"row","row-cols-3"],["class","row",4,"ngFor","ngForOf"],[1,"mt-2"],[1,"row","row-cols-2","mt-3"],["class","row mb-2",4,"ngFor","ngForOf"],[3,"tableHeader","tableFooter","columnDetails","tableData"],[3,"tableHeader","tableFooter","columnDetails","tableData",4,"ngIf"],[3,"value","click"],["mat-header-cell","","mat-sort-header","",3,"ngStyle"],["mat-cell","",2,"cursor","pointer",3,"ngStyle","mouseover","mouseout","click"],["nameCell",""],["mat-header-row",""],["mat-row",""],[1,"col-8"],["id","carouselExampleInterval","data-bs-ride","carousel",1,"carousel","slide"],[1,"carousel-inner"],["class","carousel-item","data-bs-interval","10000",3,"ngClass",4,"ngFor","ngForOf"],["type","button","data-bs-target","#carouselExampleInterval","data-bs-slide","prev",1,"carousel-control-prev"],["aria-hidden","true",1,"carousel-control-prev-icon"],[1,"visually-hidden"],["type","button","data-bs-target","#carouselExampleInterval","data-bs-slide","next",1,"carousel-control-next"],["aria-hidden","true",1,"carousel-control-next-icon"],[1,"col-4","d-flex","justify-content-center","align-self-center"],[1,"border","rounded"],[3,"elementType","errorCorrectionLevel","value"],["nbButton","","status","primary","size","small","outline","",1,"mt-2","w-100"],[1,"row","mt-3"],[1,"text-secondary","col-4"],[1,"text-secondary"],["data-bs-interval","10000",1,"carousel-item",3,"ngClass"],[1,"overflow-hidden","d-flex","align-justify-center",2,"height","15rem"],[1,"w-100","img-fluid",3,"src","alt"],[1,"row","mb-2"],[1,"col-8","text-secondary"],[1,"col","text-secondary"]],template:function(e,a){1&e&&(t.TgZ(0,"nb-card")(1,"nb-card-header",0)(2,"div")(3,"h5"),t._uU(4,"Piping Assets"),t.qZA(),t.TgZ(5,"mat-form-field")(6,"mat-label"),t._uU(7,"Hit Enter To Search"),t.qZA(),t.TgZ(8,"input",1,2),t.NdJ("keyup",function(r){return a.applyFilter(r)}),t.qZA()()(),t.TgZ(10,"div",3)(11,"div",4),t._uU(12,"Class"),t.qZA(),t.TgZ(13,"div",4)(14,"nb-select",5),t.YNc(15,j,2,2,"nb-option",6),t.qZA()()()(),t.TgZ(16,"nb-card-body",3)(17,"div",7)(18,"table",8),t.ynx(19,9),t.YNc(20,E,2,2,"th",10),t.YNc(21,$,3,4,"td",11),t.BQk(),t.YNc(22,B,1,0,"tr",12),t.YNc(23,V,1,0,"tr",13),t.qZA(),t._UZ(24,"mat-paginator",14),t.qZA(),t.TgZ(25,"div",15),t.YNc(26,X,2,0,"h5",16),t.TgZ(27,"nb-card")(28,"nb-card-body"),t.YNc(29,et,42,11,"section",16),t.TgZ(30,"section")(31,"h6",17),t._uU(32,"Piping Visual"),t.qZA(),t.TgZ(33,"div",18),t.YNc(34,it,5,2,"div",19),t.qZA()(),t.TgZ(35,"section",20)(36,"h6",17),t._uU(37,"Piping Calculation"),t.qZA(),t.TgZ(38,"div",21),t.YNc(39,at,5,2,"div",22),t.qZA()(),t.TgZ(40,"section")(41,"h6",17),t._uU(42,"Piping Damage Mechanism"),t.qZA(),t._UZ(43,"ngx-mat-table",23),t.qZA(),t.TgZ(44,"section")(45,"h6",17),t._uU(46,"Inspection History"),t.qZA(),t.YNc(47,nt,1,6,"ngx-mat-table",24),t.qZA(),t.TgZ(48,"section")(49,"h6",17),t._uU(50,"Trend"),t.qZA(),t._UZ(51,"ngx-dashboard-remaining-chart")(52,"ngx-dashboard-thickness-chart"),t.qZA()()()()()()),2&e&&(t.xp6(15),t.Q6J("ngForOf",t.DdM(16,st)),t.xp6(3),t.Q6J("dataSource",a.dataSource),t.xp6(4),t.Q6J("matHeaderRowDef",a.displayedColumns)("matHeaderRowDefSticky",!0),t.xp6(1),t.Q6J("matRowDefColumns",a.displayedColumns),t.xp6(1),t.Q6J("length",a.resultsLength)("pageSize",30),t.xp6(2),t.Q6J("ngIf",!a.pipeData),t.xp6(3),t.Q6J("ngIf",a.pipeData),t.xp6(5),t.Q6J("ngForOf",a.pipingVisual),t.xp6(5),t.Q6J("ngForOf",a.pipingThickness),t.xp6(4),t.Q6J("tableHeader",t.DdM(17,R))("tableFooter",t.DdM(18,rt))("columnDetails",a.damageMechanismDetails)("tableData",a.damageMechanismData),t.xp6(4),t.Q6J("ngIf",a.inspectionHistoryData.length))},directives:[u.Asz,u.ndF,T.KE,T.hX,w.Nt,u.rs,_.sg,u.q51,u.yKW,c.BZ,v.YE,c.w1,c.fO,c.ge,v.nU,_.PC,c.Dz,c.ev,c.as,c.XQ,c.nj,c.Gk,b.NW,_.O5,_.mk,x.zF,u.DPz,D.V,S,k],encapsulation:2}),i})(),F=(()=>{class i extends A.Z{constructor(){super(),this.chartType="bar",this.yLabels=[],this.legendPosition="bottom",this.showRightSclae=!0,this.datasets=[],this.defineOptions({chartTitle:"Chart Piping Circuit"})}ngOnInit(){this.generateChart("piping_circuit_chart")}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=t.Xpm({type:i,selectors:[["ngx-piping-circuit-chart"]],features:[t.qOj],decls:1,vars:0,consts:[["id","piping_circuit_chart"]],template:function(e,a){1&e&&t._UZ(0,"canvas",0)},encapsulation:2}),i})();var ct=p(2787);function lt(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"nb-option",17),t.NdJ("click",function(){const r=t.CHM(e).$implicit;return t.oxw().filterByClass(r)}),t._uU(1),t.qZA()}if(2&i){const e=n.$implicit;t.Q6J("value",e),t.xp6(1),t.Oqu(e)}}const pt=function(){return{width:"40px"}};function ut(i,n){1&i&&(t.TgZ(0,"th",18),t._uU(1," Circuit Id "),t.qZA()),2&i&&t.Q6J("ngStyle",t.DdM(1,pt))}const dt=function(i){return{color:i}};function mt(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"td",19,20),t.NdJ("mouseover",function(){return t.CHM(e),t.MAs(1).style.color="#0492c2"})("mouseout",function(){const r=t.CHM(e).$implicit;return t.MAs(1).style.color=t.oxw().selectionData.piping_circuit_name==r.piping_circuit_name?"#0492c2":"black"})("click",function(){const r=t.CHM(e).$implicit;return t.oxw().showData(r)}),t._uU(2),t.qZA()}if(2&i){const e=n.$implicit,a=t.oxw();t.Q6J("ngStyle",t.VKq(2,dt,a.selectionData.piping_circuit_name==e.piping_circuit_name?"#0492c2":"black")),t.xp6(2),t.hij(" ",e.piping_circuit_name," ")}}function gt(i,n){1&i&&t._UZ(0,"tr",21)}function ht(i,n){1&i&&t._UZ(0,"tr",22)}function _t(i,n){1&i&&(t.TgZ(0,"h5"),t._uU(1,"Please Add Circuit Data."),t.qZA())}function ft(i,n){1&i&&(t.TgZ(0,"span"),t._uU(1,"No Image Available"),t.qZA())}function vt(i,n){if(1&i&&(t.TgZ(0,"div",45)(1,"div",46),t._UZ(2,"img",47),t.qZA()()),2&i){const e=n.$implicit;t.Q6J("ngClass",0==n.index?"active":""),t.xp6(2),t.Q6J("src",e.src,t.LSH)("alt",null==e?null:e.alt)}}function xt(i,n){if(1&i&&(t.TgZ(0,"div",3)(1,"span",48),t._uU(2),t.qZA(),t.TgZ(3,"span",4),t._uU(4),t.qZA()()),2&i){const e=n.$implicit;t.xp6(2),t.Oqu(e.name),t.xp6(2),t.Oqu(e.data)}}const H=function(){return{show:!1}},I=function(){return{pageSize:5}};function bt(i,n){if(1&i&&t._UZ(0,"ngx-mat-table",49),2&i){const e=t.oxw(2);t.Q6J("tableHeader",t.DdM(4,H))("tableFooter",t.DdM(5,I))("columnDetails",e.columnDetails)("tableData",e.pipingThicknessData)}}function Tt(i,n){if(1&i&&(t.TgZ(0,"nb-list-item",50),t._uU(1),t.qZA()),2&i){const e=n.$implicit;t.xp6(1),t.hij(" ",e," ")}}function Zt(i,n){if(1&i&&t._UZ(0,"ngx-mat-table",49),2&i){const e=t.oxw(2);t.Q6J("tableHeader",t.DdM(4,H))("tableFooter",t.DdM(5,I))("columnDetails",e.inspectionHistoryDetails)("tableData",e.inspectionHistoryData)}}function Ct(i,n){if(1&i&&(t.TgZ(0,"nb-card")(1,"nb-card-body")(2,"section")(3,"h6",23),t._uU(4),t.qZA(),t.TgZ(5,"div",3)(6,"div",24)(7,"div",25)(8,"div",26),t.YNc(9,ft,2,0,"span",16),t.YNc(10,vt,3,3,"div",27),t.qZA(),t.TgZ(11,"button",28),t._UZ(12,"span",29),t.TgZ(13,"span",30),t._uU(14,"Previous"),t.qZA()(),t.TgZ(15,"button",31),t._UZ(16,"span",32),t.TgZ(17,"span",30),t._uU(18,"Next"),t.qZA()()()(),t.TgZ(19,"div",33)(20,"div")(21,"div",34),t._UZ(22,"ngx-qrcode",35),t.qZA(),t.TgZ(23,"button",36),t._uU(24,"See Attachment"),t.qZA()()()(),t.TgZ(25,"div",37)(26,"span",38),t._uU(27,"Date In Service"),t.qZA(),t.TgZ(28,"span",24),t._uU(29),t.qZA(),t.TgZ(30,"span",38),t._uU(31,"Class"),t.qZA(),t.TgZ(32,"span",24),t._uU(33),t.qZA(),t.TgZ(34,"span",38),t._uU(35,"Notes"),t.qZA(),t.TgZ(36,"span",24),t._uU(37),t.qZA()(),t.TgZ(38,"span",39),t._uU(39,"Recomendation"),t.qZA(),t.TgZ(40,"p"),t._uU(41),t.qZA()(),t.TgZ(42,"section")(43,"h6",23),t._uU(44,"Piping Visual"),t.qZA(),t.TgZ(45,"div",40),t.YNc(46,xt,5,2,"div",41),t.qZA()(),t.TgZ(47,"section",42)(48,"h6",23),t._uU(49,"Piping Thickness"),t.qZA(),t.YNc(50,bt,1,6,"ngx-mat-table",43),t.qZA(),t.TgZ(51,"section")(52,"h6",23),t._uU(53,"Piping Circuit Damage Mechanisms"),t.qZA(),t.TgZ(54,"span",39),t._uU(55,"Active Damage Mechanism"),t.qZA(),t.TgZ(56,"nb-list"),t.YNc(57,Tt,2,1,"nb-list-item",44),t.qZA()(),t.TgZ(58,"section")(59,"h6",23),t._uU(60,"Inspection History"),t.qZA(),t.YNc(61,Zt,1,6,"ngx-mat-table",43),t.qZA(),t.TgZ(62,"section")(63,"h6",23),t._uU(64,"Trend"),t.qZA(),t._UZ(65,"ngx-piping-circuit-chart"),t.qZA()()()),2&i){const e=t.oxw();t.xp6(4),t.Oqu(null==e.selectionData?null:e.selectionData.piping_circuit_name),t.xp6(5),t.Q6J("ngIf",!e.imageLink),t.xp6(1),t.Q6J("ngForOf",e.imageLink),t.xp6(12),t.Q6J("elementType",e.elementType)("errorCorrectionLevel",e.correctionLevel)("value",e.value),t.xp6(7),t.Oqu(null==e.selectionData?null:e.selectionData.date_in_service),t.xp6(4),t.Oqu(null==e.selectionData?null:e.selectionData.class),t.xp6(4),t.Oqu(null==e.selectionData?null:e.selectionData.notes),t.xp6(4),t.Oqu(null==e.selectionData?null:e.selectionData.recomendation),t.xp6(5),t.Q6J("ngForOf",e.pipingVisual),t.xp6(4),t.Q6J("ngIf",e.pipingThicknessData),t.xp6(7),t.Q6J("ngForOf",e.activeDamageMechaninsm),t.xp6(4),t.Q6J("ngIf",e.inspectionHistoryData.length)}}const yt=function(){return["All",1,2,3,4]},Dt=[{path:"",component:J,children:[{path:"piping-assets",component:ot},{path:"piping-circuits",component:(()=>{class i{constructor(e,a,s){this.pipingCircuitService=e,this.reportService=a,this.variables=s,this.elementType=x.TT.URL,this.correctionLevel=x.Jk.HIGH,this.value="https://www.google.com/",this.datasets=[{label:"Reading (mm)",yAxisID:"A",prop:"reading"},{label:"T minimum (mm)",yAxisID:"A",prop:"min_required_thickness"},{label:"Nominal Thickness (mm)",yAxisID:"A",prop:"nominal_thickness"},{label:"Corrosion Rate (mm/Year)",yAxisID:"B",prop:"lt_cr"}],this.tablePosition=[],this.dataSource=new c.by(this.tablePosition),this.displayedColumns=["piping_circuit_name"],this.resultsLength=0,this.imageLink=[],this.pipingVisual=[{name:"Leaks",props:"leaks_condition",data:null},{name:"Misalignment",props:"misalignment_condition",data:null},{name:"Vibration",props:"vibration_condition",data:null},{name:"Supports",props:"supports_condition",data:null},{name:"Corrosion",props:"corrosion_condition",data:null},{name:"Insulation",props:"insulation_condition",data:null}],this.activeDamageMechaninsm=[],this.columnDetails=[{type:"text",prop:"piping_id",head:"Piping Id",width:"200px"},{type:"text",prop:"reading",head:"Reading (mm)",width:"200px"},{type:"text",prop:"min_required_thickness",head:"T min (mm)",width:"200px"},{type:"text",prop:"lt_cr",head:"LT CR (mm/Year)",width:"200px"},{type:"text",prop:"st_cr",head:"ST CR (mm/Year)",width:"200px"},{type:"text",prop:"remaining_life",head:"RL (Years)",width:"200px"},{type:"text",prop:"half_life",head:"HL (Years)",width:"200px"},{type:"text",prop:"retirement_date",head:"Retirement date",width:"200px"},{type:"text",prop:"next_tm_insp_date",head:"Next TM",width:"200px"},{type:"text",prop:"next_ve_insp_date",head:"Next VE",width:"200px"},{type:"text",prop:"mawp",head:"MAWP",width:"200px"}],this.inspectionHistoryData=[],this.inspectionHistoryDetails=[{type:"text",prop:"proposal_id",head:"Inspection Id",width:"100px"},{type:"editable date",prop:"inspection_date",head:"Inspection Date",width:"200px"},{type:"text",prop:"inspection_summary",head:"Inspection Summary",width:"300px"},{type:"check",prop:"caried_out",head:"Caried Out",width:"50px"}]}ngOnInit(){this.pipingCircuitService.getPipingCircuits().subscribe(({data:e})=>{this.tablePosition=e;const a=e[0];!a||(this.showData(a),this.getCircuitReport(null==a?void 0:a.id),this.dataSource=new c.by(e),this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort)})}getCircuitReport(e){this.reportService.getCircuitReport(e).subscribe(({data:{assets:a}})=>{const s=a.map(({asset:r,cml:o})=>Object.assign(Object.assign({},r),{cml:o}));this.circuitChartData(this.circuitChart,{piping:s}),this.pipingVisual=this.pipingVisual.map(({name:r,props:o})=>({name:r,props:o,data:this.switchToLevel(Math.round(this.visualConditionAvg(a,o)/a.length))})),a.filter(r=>null!=r).forEach(({damage_mechanism:r,proposal:o})=>{var h;if(!this.inspectionHistoryData.find(l=>l.id==(null==o?void 0:o.id))){const l=o?null===(h=o.inspection_method)||void 0===h?void 0:h.map(({type:m,technique:d,method:Z})=>` ${m} ${Z} ${d}`):[];this.inspectionHistoryData.push(Object.assign(Object.assign({},o),{inspection_summary:l}))}this.variables.damageMechanismName.map(({id:l,piping_damage_mechanism:m})=>{const d=null==r?void 0:r[l];return d?Object.assign(Object.assign({},d),{piping_damage_mechanism:m}):null}).filter(l=>null!=l).map(({piping_damage_mechanism:l})=>l).forEach(l=>{this.activeDamageMechaninsm.includes(l)||this.activeDamageMechaninsm.push(l)})}),this.pipingThicknessData=a.map(r=>{const{min_required_thickness:o,reading:h,lt_cr:g,st_cr:f,remaining_life:l,half_life:m,retirement_date:d,next_tm_insp_date:Z,next_ve_insp_date:P,mawp:q}=this.variables.getThicknessCalculation(Object.assign(Object.assign({},r.asset),{cml:r.cml}));return Object.assign(Object.assign({},r.asset),{min_required_thickness:o.toFixed(2),reading:h.toFixed(2),lt_cr:g.toFixed(2),st_cr:f.toFixed(2),remaining_life:l.toFixed(2),half_life:m.toFixed(2),retirement_date:d,next_tm_insp_date:Z,next_ve_insp_date:P,mawp:q.toFixed(2)})})})}circuitChartData(e,a){const{piping:s}=a,r=null==s?void 0:s.map(g=>g.piping_id);this.variables.removeChartData(this.circuitChart);const o=s.map(g=>this.variables.getThicknessCalculation(g));e.data.labels=r;const h=this.datasets.map(g=>{const f="#"+(16777216*Math.random()|0).toString(16).padStart(6,"0"),l=r.map(m=>o.find(d=>d.piping_id==m)[g.prop]);return Object.assign(Object.assign({},g),{borderColor:f,backgroundColor:f,data:l})});e.chart.data.datasets=h,e.chart.update()}visualConditionAvg(e,a){return null==e?void 0:e.map(s=>{var r;return this.switchToPoint(null===(r=null==s?void 0:s.visual_condition)||void 0===r?void 0:r[a])}).reduce((s,r)=>s+r,0)}switchToPoint(e){return"Excellent"==e?5:"Good"==e?4:"Average"==e?3:"Below Average"==e?2:"Poor"==e?1:0}switchToLevel(e){return 5==e?"Excellent":4==e?"Good":3==e?"Average":2==e?"Below Average":1==e?"Poor":null}filterByClass(e){let a=this.tablePosition.filter(s=>s.class==e);"All"==e&&(a=this.tablePosition),this.dataSource=new c.by(a)}showData(e){var a;this.selectionData=e,this.getCircuitReport(e.id),this.imageLink=null===(a=null==e?void 0:e.images)||void 0===a?void 0:a.map(s=>({src:y.N.apiUrl+"/image/"+s,alt:"Pipe Asssets"}))}applyFilter(e){this.dataSource.filter=e.target.value.trim().toLowerCase(),this.dataSource.paginator&&this.dataSource.paginator.firstPage()}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(ct.t),t.Y36(O),t.Y36(M.L))},i.\u0275cmp=t.Xpm({type:i,selectors:[["ngx-report-piping-circuit"]],viewQuery:function(e,a){if(1&e&&(t.Gf(F,5),t.Gf(b.NW,5),t.Gf(v.YE,5)),2&e){let s;t.iGM(s=t.CRH())&&(a.circuitChart=s.first),t.iGM(s=t.CRH())&&(a.paginator=s.first),t.iGM(s=t.CRH())&&(a.sort=s.first)}},decls:28,vars:10,consts:[[1,"d-flex","justify-content-between"],["matInput","","placeholder","Ex. Mia",3,"keyup"],["input",""],[1,"row"],[1,"col"],["placeholder","Class","status","primary","size","small",1,"mx-5"],[3,"value","click",4,"ngFor","ngForOf"],[1,"col-3"],["mat-table","","matSort","",1,"mat-elevation-z8",2,"width","100%","box-shadow","none",3,"dataSource"],["matColumnDef","piping_circuit_name"],["mat-header-cell","","mat-sort-header","",3,"ngStyle",4,"matHeaderCellDef"],["mat-cell","","style","cursor : pointer",3,"ngStyle","mouseover","mouseout","click",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",4,"matRowDef","matRowDefColumns"],["aria-label","Select page of GitHub search results",3,"length","pageSize"],[1,"col-9"],[4,"ngIf"],[3,"value","click"],["mat-header-cell","","mat-sort-header","",3,"ngStyle"],["mat-cell","",2,"cursor","pointer",3,"ngStyle","mouseover","mouseout","click"],["nameCell",""],["mat-header-row",""],["mat-row",""],[1,"fw-bolder","text-primary","mb-2","d-block"],[1,"col-8"],["id","carouselExampleInterval","data-bs-ride","carousel",1,"carousel","slide"],[1,"carousel-inner"],["class","carousel-item","data-bs-interval","10000",3,"ngClass",4,"ngFor","ngForOf"],["type","button","data-bs-target","#carouselExampleInterval","data-bs-slide","prev",1,"carousel-control-prev"],["aria-hidden","true",1,"carousel-control-prev-icon"],[1,"visually-hidden"],["type","button","data-bs-target","#carouselExampleInterval","data-bs-slide","next",1,"carousel-control-next"],["aria-hidden","true",1,"carousel-control-next-icon"],[1,"col-4","d-flex","justify-content-center","align-self-center"],[1,"border","rounded"],[3,"elementType","errorCorrectionLevel","value"],["nbButton","","status","primary","size","small","outline","",1,"mt-2","w-100"],[1,"row","mt-3"],[1,"text-secondary","col-4"],[1,"text-secondary"],[1,"row","row-cols-3"],["class","row",4,"ngFor","ngForOf"],[1,"mt-3"],[3,"tableHeader","tableFooter","columnDetails","tableData",4,"ngIf"],["style","height: 1rem;",4,"ngFor","ngForOf"],["data-bs-interval","10000",1,"carousel-item",3,"ngClass"],[1,"overflow-hidden","d-flex","align-justify-center",2,"height","15rem"],[1,"w-100","img-fluid",3,"src","alt"],[1,"col","text-secondary"],[3,"tableHeader","tableFooter","columnDetails","tableData"],[2,"height","1rem"]],template:function(e,a){1&e&&(t.TgZ(0,"nb-card")(1,"nb-card-header",0)(2,"div")(3,"h5"),t._uU(4,"Piping Circuit"),t.qZA(),t.TgZ(5,"mat-form-field")(6,"mat-label"),t._uU(7,"Hit Enter To Search"),t.qZA(),t.TgZ(8,"input",1,2),t.NdJ("keyup",function(r){return a.applyFilter(r)}),t.qZA()()(),t.TgZ(10,"div",3)(11,"div",4),t._uU(12,"Class"),t.qZA(),t.TgZ(13,"div",4)(14,"nb-select",5),t.YNc(15,lt,2,2,"nb-option",6),t.qZA()()()(),t.TgZ(16,"nb-card-body",3)(17,"div",7)(18,"table",8),t.ynx(19,9),t.YNc(20,ut,2,2,"th",10),t.YNc(21,mt,3,4,"td",11),t.BQk(),t.YNc(22,gt,1,0,"tr",12),t.YNc(23,ht,1,0,"tr",13),t.qZA(),t._UZ(24,"mat-paginator",14),t.qZA(),t.TgZ(25,"div",15),t.YNc(26,_t,2,0,"h5",16),t.YNc(27,Ct,66,14,"nb-card",16),t.qZA()()()),2&e&&(t.xp6(15),t.Q6J("ngForOf",t.DdM(9,yt)),t.xp6(3),t.Q6J("dataSource",a.dataSource),t.xp6(4),t.Q6J("matHeaderRowDef",a.displayedColumns)("matHeaderRowDefSticky",!0),t.xp6(1),t.Q6J("matRowDefColumns",a.displayedColumns),t.xp6(1),t.Q6J("length",a.resultsLength)("pageSize",30),t.xp6(2),t.Q6J("ngIf",!a.selectionData),t.xp6(1),t.Q6J("ngIf",a.selectionData))},directives:[u.Asz,u.ndF,T.KE,T.hX,w.Nt,u.rs,_.sg,u.q51,u.yKW,c.BZ,v.YE,c.w1,c.fO,c.ge,v.nU,_.PC,c.Dz,c.ev,c.as,c.XQ,c.nj,c.Gk,b.NW,_.O5,_.mk,x.zF,u.DPz,D.V,u.zP_,u.qBV,F],encapsulation:2}),i})()}]}];let At=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[[C.Bz.forChild(Dt)],C.Bz]}),i})();var wt=p(9511),Rt=p(2368),Pt=p(7446),qt=p(4107);let Ut=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[[_.ez,N.O,At,u.zyh,u.x4g,u.IIj,u.nKr,u.COg,u.T2N,wt.H,Rt.rP,c.p0,Pt.p9,b.TU,T.lN,w.c,qt.LD,v.JX,x.F5,u.LW9.forRoot({destroyByClick:!0,duration:3e3,position:u.fe3.BOTTOM_RIGHT,preventDuplicates:!0,limit:3})]]}),i})()}}]);