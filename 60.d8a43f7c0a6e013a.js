"use strict";(self.webpackChunkngx_admin_demo=self.webpackChunkngx_admin_demo||[]).push([[60],{2356:(w,g,l)=>{l.d(g,{Z:()=>c});var m=l(9808),f=l(4738),s=l(3254),v=l(8246),u=l(5e3);let c=(()=>{class d{}return d.\u0275fac=function(D){return new(D||d)},d.\u0275mod=u.oAB({type:d}),d.\u0275inj=u.cJS({imports:[[m.ez,f.O,s.zyh,s.T2N,s.KdK,v.F5,s.j7H.forChild({closeOnBackdropClick:!0})]]}),d})()},6060:(w,g,l)=>{l.r(g),l.d(g,{AssesmentModule:()=>Tt});var m=l(9808),f=l(4738),s=l(3254),v=l(2497),u=l(4847),c=l(8279),d=l(5331),t=l(5e3),D=l(2340),k=l(520);let J=(()=>{class i{constructor(e){this.httpClient=e,this.apiUrl=D.N.apiUrl}getVisualConditions(){return this.httpClient.get(this.apiUrl+"/visual_condition")}updateVisualConditions(e,n){return this.httpClient.put(this.apiUrl+"/visual_condition/"+n,e)}}return i.\u0275fac=function(e){return new(e||i)(t.LFG(k.eN))},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();var b=l(4204),C=l(7531),h=l(3075),A=l(4107),E=l(3252);const N=function(){return{width:"40px"}};function I(i,a){1&i&&(t.TgZ(0,"th",27),t._uU(1," Piping ID "),t.qZA()),2&i&&t.Q6J("ngStyle",t.DdM(1,N))}const Q=function(i){return{color:i}};function R(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"td",28,29),t.NdJ("mouseover",function(){return t.CHM(e),t.MAs(1).style.color="#0492c2"})("mouseout",function(){const r=t.CHM(e).$implicit;return t.MAs(1).style.color=t.oxw().selectionData.piping_id==r.piping_id?"#0492c2":"black"})("click",function(){const r=t.CHM(e).$implicit;return t.oxw().showData(r)}),t._uU(2),t.qZA()}if(2&i){const e=a.$implicit,n=t.oxw();t.Q6J("ngStyle",t.VKq(2,Q,n.selectionData.piping_id==e.piping_id?"#0492c2":"black")),t.xp6(2),t.hij(" ",e.piping_id," ")}}function H(i,a){1&i&&t._UZ(0,"tr",30)}function B(i,a){1&i&&t._UZ(0,"tr",31)}function L(i,a){if(1&i&&(t.TgZ(0,"mat-option",32),t._uU(1),t.qZA()),2&i){const e=a.$implicit;t.Q6J("value",e),t.xp6(1),t.Oqu(e)}}function Y(i,a){if(1&i&&(t.TgZ(0,"mat-option",32),t._uU(1),t.qZA()),2&i){const e=a.$implicit;t.Q6J("value",e),t.xp6(1),t.Oqu(e)}}function V(i,a){if(1&i&&(t.TgZ(0,"nb-list-item",0)(1,"span"),t._uU(2),t.qZA(),t._UZ(3,"nb-checkbox",39),t.qZA()),2&i){const e=a.$implicit,n=t.oxw(2);t.xp6(2),t.Oqu(null==e?null:e.title),t.xp6(1),t.Q6J("ngModel",null==n.selectionData?null:n.selectionData.visual_condition[e.props])("name",null==e?null:e.props)}}const O=function(){return["Excellent","Good","Average","Below Average","Poor"]};function j(i,a){if(1&i&&(t.TgZ(0,"section",33)(1,"div",34)(2,"label",21),t._uU(3),t.qZA(),t.TgZ(4,"mat-form-field")(5,"mat-label"),t._uU(6,"Condition"),t.qZA(),t.TgZ(7,"mat-select",35),t.YNc(8,Y,2,2,"mat-option",19),t.qZA()()(),t.TgZ(9,"div",36),t._UZ(10,"textarea",37),t.qZA(),t.TgZ(11,"nb-list"),t.YNc(12,V,4,3,"nb-list-item",38),t.qZA()()),2&i){const e=a.$implicit,n=t.oxw();t.xp6(3),t.Oqu(e.title),t.xp6(4),t.Q6J("ngModel",null==n.selectionData?null:n.selectionData.visual_condition[null==e||null==e.conditions?null:e.conditions.props])("name",null==e||null==e.conditions?null:e.conditions.props),t.xp6(1),t.Q6J("ngForOf",t.DdM(8,O)),t.xp6(2),t.Q6J("ngModel",null==n.selectionData?null:n.selectionData.visual_condition[null==e||null==e.comment?null:e.comment.props])("name",null==e||null==e.comment?null:e.comment.props)("id",null==e||null==e.comment?null:e.comment.props),t.xp6(2),t.Q6J("ngForOf",e.source)}}let G=(()=>{class i{constructor(e,n){this.visualConditionService=e,this.toastrService=n,this.displayedColumns=["piping_id"],this.resultsLength=0,this.externalCheckList=[{title:"Leaks",conditions:{title:"Leaks",props:"leaks_condition"},comment:{title:"Leaks Comment",props:"leaks_comment"},source:[{title:"Process",props:"leaks_process"},{title:"Steam Tracking",props:"leaks_steam_tracing"}]},{title:"Misalignment",conditions:{title:"Misalignment",props:"misalignment_condition"},comment:{title:"Misalignment Comment",props:"misalignment_comment"},source:[{title:"Piping Misalignment",props:"misalignment_piping_misalignment"},{title:"Expainsion Joint Misalignment",props:"misalignment_expainsion_joint"},{title:"Existing Clamp",props:"misalignment_existing_clamps"}]},{title:"Vibration",conditions:{title:"Vibration",props:"vibration_condition"},comment:{title:"Vibration Comment",props:"vibration_comment"},source:[{title:"Excessive Overhung Weight",props:"vibration_excessive_overhung"},{title:"Inadequate Support",props:"vibration_inadequate_support"},{title:"Thin, Small-bore, or Alloy Piping",props:"vibration_thin_small"},{title:"Threaded Connections",props:"vibration_threaded_connections"},{title:"Loose Support Causing Metal Wear",props:"vibration_loose_support"}]},{title:"Corrosion",conditions:{title:"Corrosion",props:"corrosion_condition"},comment:{title:"Corrosion Comment",props:"corrosion_comment"},source:[{title:"Bolting Support Points Under Clamps",props:"corrosion_bolting_support"},{title:"Coating/Painting Deterioration",props:"corrosion_coating_painting"},{title:"Soil-to-air Interfaces",props:"corrosion_soil_to_air"},{title:"Insulation Interfaces",props:"corrosion_insulation_interface"},{title:"Biloogical Growth",props:"corrosion_biological_growth"}]},{title:"Supports",conditions:{title:"Supports",props:"supports_condition"},comment:{title:"Support Comment",props:"supports_comment"},source:[{title:"Shoes Off Supports",props:"supports_shoes_supports"},{title:"Hanger Distortion of Breakage",props:"supports_hanger_distortion"},{title:"Bottomed Out Springs",props:"supports_bottomed_out"},{title:"Brace Distorsion/Breakage",props:"supports_brace_distortion"},{title:"Loose Brackets",props:"supports_loose_brackets"},{title:"Slides Plates/Rollers",props:"supports_slides_plates"},{title:"Counter Balance Condition",props:"supports_counter_balance"},{title:"Support Corrosion",props:"supports_support_corrosion"}]},{title:"Insulation",conditions:{title:"Insulation",props:"insulation_condition"},comment:{title:"Insulation Comment",props:"insulation_comment"},source:[{title:"Damage/Penetrations",props:"insulation_damage_penetrations"},{title:"Missing Jacketing Insulation",props:"insulation_missing_jacketing"},{title:"Sealing Deterioration",props:"insulation_sealing_deterioration"},{title:"Bulging",props:"insulation_bulging"},{title:"Banding (Broken/Missing)",props:"insulation_banding"}]}]}ngOnInit(){this.visualConditionService.getVisualConditions().subscribe(({data:e})=>{var n;const o=e.map(r=>Object.assign(Object.assign({},r.piping),{visual_condition:Object.assign(Object.assign({},r),{piping:null})}));this.tableData=o,this.selectionData=null!==(n=this.selectionData)&&void 0!==n?n:o[0],this.dataSource=new c.by(o),this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort})}showData(e){this.selectionData=e}onSubmit(e){this.visualConditionService.updateVisualConditions(e,this.selectionData.visual_condition.id).subscribe(o=>this.ngOnInit(),()=>this.toastrService.danger("Please input all conditions field.","Your request failed."),()=>this.toastrService.success("Data has been updated.","Your request success."))}applyFilter(e){this.dataSource.filter=e.target.value.trim().toLowerCase(),this.dataSource.paginator&&this.dataSource.paginator.firstPage()}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(J),t.Y36(s.quB))},i.\u0275cmp=t.Xpm({type:i,selectors:[["ngx-visual-condition"]],viewQuery:function(e,n){if(1&e&&(t.Gf(d.NW,5),t.Gf(u.YE,5)),2&e){let o;t.iGM(o=t.CRH())&&(n.paginator=o.first),t.iGM(o=t.CRH())&&(n.sort=o.first)}},decls:52,vars:14,consts:[[1,"d-flex","justify-content-between"],["matInput","","placeholder","Ex. Mia",3,"keyup"],["input",""],[1,"row"],[1,"col-3"],["matSort","","mat-table","",1,"mat-elevation-z8",2,"width","100%","box-shadow","none",3,"dataSource"],["matColumnDef","piping_id"],["mat-header-cell","","mat-sort-header","",3,"ngStyle",4,"matHeaderCellDef"],["mat-cell","","style","cursor : pointer",3,"ngStyle","mouseover","mouseout","click",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",4,"matRowDef","matRowDefColumns"],["aria-label","Select page of GitHub search results",3,"length","pageSize"],[1,"col-9",3,"ngSubmit"],["visualConditionForm","ngForm"],["multi",""],["expanded","true"],[1,"fw-bold","text-info"],[1,"my-2"],["name","general_condition","required","",3,"ngModel"],[3,"value",4,"ngFor","ngForOf"],[1,"w-100","px-2"],["for","finding",1,"d-block","mb-2"],["nbInput","","id","finding","fullWidth","","rows","5","name","general_finding",3,"ngModel"],["for","recomendation",1,"d-block","mb-2"],["nbInput","","name","general_recomendation","id","recomendation","fullWidth","","rows","5",3,"ngModel"],["class","pb-5 px-4 col-6",4,"ngFor","ngForOf"],["nbButton","","status","success","type","submit",1,"w-100","m-2",3,"disabled"],["mat-header-cell","","mat-sort-header","",3,"ngStyle"],["mat-cell","",2,"cursor","pointer",3,"ngStyle","mouseover","mouseout","click"],["nameCell",""],["mat-header-row",""],["mat-row",""],[3,"value"],[1,"pb-5","px-4","col-6"],[1,"d-flex","align-items-center","justify-content-between"],["required","",3,"ngModel","name"],[1,"w-100"],["nbInput","","fullWidth","","rows","5",3,"ngModel","name","id"],["class","d-flex justify-content-between",4,"ngFor","ngForOf"],[1,"mx-2",3,"ngModel","name"]],template:function(e,n){if(1&e){const o=t.EpF();t.TgZ(0,"nb-card")(1,"nb-card-header",0)(2,"div")(3,"h5"),t._uU(4,"Visual Condition"),t.qZA(),t.TgZ(5,"mat-form-field")(6,"mat-label"),t._uU(7,"Hit Enter To Search"),t.qZA(),t.TgZ(8,"input",1,2),t.NdJ("keyup",function(p){return n.applyFilter(p)}),t.qZA()()()(),t.TgZ(10,"nb-card-body",3)(11,"div",4)(12,"table",5),t.ynx(13,6),t.YNc(14,I,2,2,"th",7),t.YNc(15,R,3,4,"td",8),t.BQk(),t.YNc(16,H,1,0,"tr",9),t.YNc(17,B,1,0,"tr",10),t.qZA(),t._UZ(18,"mat-paginator",11),t.qZA(),t.TgZ(19,"form",12,13),t.NdJ("ngSubmit",function(){t.CHM(o);const p=t.MAs(20);return n.onSubmit(p.value)}),t.TgZ(21,"nb-accordion",14)(22,"nb-accordion-item",15)(23,"nb-accordion-item-header"),t._uU(24,"General"),t.qZA(),t.TgZ(25,"nb-accordion-item-body")(26,"div",0)(27,"span",16),t._uU(28),t.qZA(),t.TgZ(29,"div")(30,"mat-form-field",17)(31,"mat-label"),t._uU(32,"Condition"),t.qZA(),t.TgZ(33,"mat-select",18),t.YNc(34,L,2,2,"mat-option",19),t.qZA()()()(),t.TgZ(35,"div",0)(36,"div",20)(37,"label",21),t._uU(38,"Finding"),t.qZA(),t._UZ(39,"textarea",22),t.qZA(),t.TgZ(40,"div",20)(41,"label",23),t._uU(42,"Recomendation"),t.qZA(),t._UZ(43,"textarea",24),t.qZA()()()(),t.TgZ(44,"nb-accordion-item",15)(45,"nb-accordion-item-header"),t._uU(46,"External Checklist"),t.qZA(),t.TgZ(47,"nb-accordion-item-body")(48,"div",3),t.YNc(49,j,13,9,"section",25),t.qZA()()()(),t.TgZ(50,"button",26),t._uU(51,"Submit"),t.qZA()()()()}if(2&e){const o=t.MAs(20);t.xp6(12),t.Q6J("dataSource",n.dataSource),t.xp6(4),t.Q6J("matHeaderRowDef",n.displayedColumns)("matHeaderRowDefSticky",!0),t.xp6(1),t.Q6J("matRowDefColumns",n.displayedColumns),t.xp6(1),t.Q6J("length",n.resultsLength)("pageSize",30),t.xp6(10),t.hij("Selected Pipe : ",null==n.selectionData?null:n.selectionData.piping_id,""),t.xp6(5),t.Q6J("ngModel",null==n.selectionData||null==n.selectionData.visual_condition?null:n.selectionData.visual_condition.general_condition),t.xp6(1),t.Q6J("ngForOf",t.DdM(13,O)),t.xp6(5),t.Q6J("ngModel",null==n.selectionData||null==n.selectionData.visual_condition?null:n.selectionData.visual_condition.general_finding),t.xp6(4),t.Q6J("ngModel",null==n.selectionData||null==n.selectionData.visual_condition?null:n.selectionData.visual_condition.general_recomendation),t.xp6(6),t.Q6J("ngForOf",n.externalCheckList),t.xp6(1),t.Q6J("disabled",!(o.form.valid&&n.selectionData))}},directives:[s.Asz,s.ndF,b.KE,b.hX,C.Nt,s.yKW,c.BZ,u.YE,c.w1,c.fO,c.ge,u.nU,m.PC,c.Dz,c.ev,c.as,c.XQ,c.nj,c.Gk,d.NW,h._Y,h.JL,h.F,s.qCO,s.SaG,s.YZd,s.AvE,A.gD,h.Q7,h.JJ,h.On,m.sg,E.ey,s.h8i,h.Fj,s.zP_,s.qBV,s.NTf,s.DPz],encapsulation:2}),i})();var q=l(4641),T=l.n(q),W=l(8493),z=l(7238),K=l.n(z);const $=["pdfThickness"];function X(i,a){if(1&i&&(t.TgZ(0,"th")(1,"b",7),t._uU(2),t.qZA()()),2&i){const e=a.$implicit;t.xp6(2),t.Oqu(e.name)}}function tt(i,a){if(1&i&&(t.TgZ(0,"td"),t._uU(1),t.qZA()),2&i){const e=a.$implicit,n=t.oxw().$implicit;t.xp6(1),t.hij(" ",null==n?null:n[e.props]," ")}}function et(i,a){if(1&i&&(t.TgZ(0,"tr"),t.YNc(1,tt,2,1,"td",6),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.Q6J("ngForOf",e.pdfHead)}}function nt(i,a){if(1&i&&(t.TgZ(0,"table",5)(1,"tr"),t.YNc(2,X,3,1,"th",6),t.qZA(),t.YNc(3,et,2,1,"tr",6),t.qZA()),2&i){const e=t.oxw();t.Akn(e.tableStyle),t.xp6(2),t.Q6J("ngForOf",e.pdfHead),t.xp6(1),t.Q6J("ngForOf",e.tableData)}}T().vfs=W.I.vfs;let U=(()=>{class i{constructor(){this.tableStyle={"font-size":"12px"},this.pdfHead=[{name:"Id",props:"piping_id",width:"*"},{name:"Reading",props:"reading",width:"auto"},{name:"T min",props:"t_min",width:"auto"},{name:"LT CR",props:"lt_cr",width:"auto"},{name:"ST CR",props:"st_cr",width:"auto"},{name:"Remaining",props:"remaining_life",width:"auto"},{name:"Half",props:"half_life",width:"auto"},{name:"Retirement",props:"retirement_date",width:"*"},{name:"Next TM",props:"next_tm_insp_date",width:"*"},{name:"Next VE",props:"next_ve_insp_date",width:"*"},{name:"MAWP",props:"mawp",width:"auto"}]}ngOnInit(){T().tableLayouts={exampleLayout:{hLineWidth:function(e,n){return 0===e||e===n.table.body.length?0:e===n.table.headerRows?2:1},vLineWidth:function(e){return 0},hLineColor:function(e){return 1===e?"black":"#aaa"},paddingLeft:function(e){return 0===e?0:8},paddingRight:function(e,n){return e===n.table.widths.length-1?0:8}}}}generateData(e){this.tableData=e,setTimeout(()=>{this.downloadAsPDF()},500)}downloadAsPDF(){const e=this.pdfThickness.nativeElement,o={content:[K()(e.innerHTML)],pageBreakBefore:function(r){return r.style&&r.style.indexOf("pdf-pagebreak-before")>-1}};T().createPdf(o).print()}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=t.Xpm({type:i,selectors:[["thickness-pdf"]],viewQuery:function(e,n){if(1&e&&t.Gf($,5),2&e){let o;t.iGM(o=t.CRH())&&(n.pdfThickness=o.first)}},decls:6,vars:1,consts:[[1,"container",2,"display","none"],["id","Thickness"],["pdfThickness",""],[2,"width","100%","margin","0 0 1rem 0","color","#5588EE"],["data-pdfmake",'{"widths":["*", "auto", "auto", "auto", "auto", "auto", "auto", "*", "*", "*", "auto"], "layout" : "exampleLayout"}',3,"style",4,"ngIf"],["data-pdfmake",'{"widths":["*", "auto", "auto", "auto", "auto", "auto", "auto", "*", "*", "*", "auto"], "layout" : "exampleLayout"}'],[4,"ngFor","ngForOf"],[2,"font-weight","bold"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1,2)(3,"h5",3),t._uU(4,"Thickness"),t.qZA(),t.YNc(5,nt,4,4,"table",4),t.qZA()()),2&e&&(t.xp6(5),t.Q6J("ngIf",n.tableData))},directives:[m.O5,m.sg],encapsulation:2}),i})();var it=l(9371),F=l(7024),x=l(3858);function ot(i,a){1&i&&(t.TgZ(0,"nb-alert",4),t._uU(1,"Data Not Available. Please add asset."),t.qZA())}function at(i,a){if(1&i&&t._UZ(0,"ngx-mat-table",5),2&i){const e=t.oxw();t.Q6J("tableHeader",e.tableHeader)("columnDetails",e.columnDetails)("tableData",e.tableData)}}let st=(()=>{class i{constructor(e,n){this.thicknessService=e,this.variables=n,this.tableHeader={title:"Thickness",filter:[{name:"MAWP",value:["Normal","Good","Worst"],title:"class-assets"}]},this.tableData=[],this.columnDetails=[{type:"navto",prop:"piping_id",head:"Piping ID",width:"200px",nav:"/pages/cml/"},{type:"text",prop:"reading",head:"Reading (mm)",width:"200px"},{type:"text",prop:"t_min",head:"T min (mm)",width:"200px"},{type:"text",prop:"lt_cr",head:"LT CR (mm/Year)",width:"200px"},{type:"text",prop:"st_cr",head:"ST CR (mm/Year)",width:"200px"},{type:"text",prop:"remaining_life",head:"Remaining Life (Year)",width:"200px"},{type:"text",prop:"half_life",head:"Half Life (Year)",width:"200px"},{type:"text",prop:"retirement_date",head:"Retirement Date",width:"200px"},{type:"text",prop:"next_tm_insp_date",head:"Next TM Insp Date",width:"200px"},{type:"text",prop:"next_ve_insp_date",head:"Next VE Insp Date",width:"200px"},{type:"text",prop:"mawp",head:"MAWP (psi)",width:"200px"}]}ngOnInit(){this.thicknessService.getDataThickness().subscribe(({data:e})=>{this.tableData=e.map(n=>{const{reading:o,min_required_thickness:r,lt_cr:p,st_cr:_,remaining_life:y,half_life:M,retirement_date:Z,next_tm_insp_date:S,next_ve_insp_date:xt,mawp:yt}=this.variables.getThicknessCalculation(n);return Object.assign(Object.assign({},n),{reading:o.toFixed(3),t_min:r.toFixed(3),lt_cr:p.toFixed(3),st_cr:_.toFixed(3),remaining_life:y.toFixed(2),half_life:M.toFixed(2),retirement_date:Z,next_tm_insp_date:S,next_ve_insp_date:xt,mawp:yt.toFixed(2)})})})}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(it.O),t.Y36(F.L))},i.\u0275cmp=t.Xpm({type:i,selectors:[["ngx-thickness"]],viewQuery:function(e,n){if(1&e&&t.Gf(U,5),2&e){let o;t.iGM(o=t.CRH())&&(n.pdfThickness=o.first)}},decls:9,vars:3,consts:[["nbButton","","outline","","size","small","status","primary",3,"disabled","click"],["icon","printer-outline",1,"m-1"],["status","danger",4,"ngIf"],[3,"tableHeader","columnDetails","tableData",4,"ngIf"],["status","danger"],[3,"tableHeader","columnDetails","tableData"]],template:function(e,n){1&e&&(t.TgZ(0,"nb-card")(1,"nb-card-body")(2,"button",0),t.NdJ("click",function(){return n.pdfThickness.generateData(n.tableData)}),t._UZ(3,"nb-icon",1),t.TgZ(4,"span"),t._uU(5,"Print"),t.qZA()()()(),t.YNc(6,ot,2,0,"nb-alert",2),t.YNc(7,at,1,3,"ngx-mat-table",3),t._UZ(8,"thickness-pdf")),2&e&&(t.xp6(2),t.Q6J("disabled",!(null!=n.tableData&&n.tableData.length)),t.xp6(4),t.Q6J("ngIf",!n.tableData.length),t.xp6(1),t.Q6J("ngIf",n.tableData.length))},directives:[s.Asz,s.yKW,s.DPz,s.fMN,m.O5,s.$9b,x.V,U],encapsulation:2}),i})(),lt=(()=>{class i{constructor(e){this.httpClient=e,this.apiUrl=D.N.apiUrl}getDamageMechanism(){return this.httpClient.get(this.apiUrl+"/damage_mechanism")}updateDamageMechanism(e,n){return this.httpClient.put(this.apiUrl+"/damage_mechanism/"+e,n)}}return i.\u0275fac=function(e){return new(e||i)(t.LFG(k.eN))},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const rt=function(){return{width:"40px"}};function ct(i,a){1&i&&(t.TgZ(0,"th",16),t._uU(1," Piping ID "),t.qZA()),2&i&&t.Q6J("ngStyle",t.DdM(1,rt))}const pt=function(i){return{color:i}};function dt(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"td",17,18),t.NdJ("mouseover",function(){return t.CHM(e),t.MAs(1).style.color="#0492c2"})("mouseout",function(){const r=t.CHM(e).$implicit,p=t.MAs(1),_=t.oxw();return p.style.color=(null==_.selectionData?null:_.selectionData.piping_id)==r.piping_id?"#0492c2":"black"})("click",function(){const r=t.CHM(e).$implicit;return t.oxw().showData(r)}),t._uU(2),t.qZA()}if(2&i){const e=a.$implicit,n=t.oxw();t.Q6J("ngStyle",t.VKq(2,pt,(null==n.selectionData?null:n.selectionData.piping_id)==e.piping_id?"#0492c2":"black")),t.xp6(2),t.hij(" ",null==e||null==e.piping?null:e.piping.piping_id," ")}}function ut(i,a){1&i&&t._UZ(0,"tr",19)}function mt(i,a){1&i&&t._UZ(0,"tr",20)}const P=function(){return{show:!1}};let _t=(()=>{class i{constructor(e,n,o,r){this.damageMechanismService=e,this.datePipe=n,this.toastrService=o,this.variables=r,this.columnDetails=[{type:"text",prop:"piping_damage_mechanism",head:"Piping Damage Mechanism",width:"200px"},{type:"check",prop:"active",head:"Active",width:"100px"},{type:"drop-down",prop:"susceptibility",head:"Susceptibility",width:"50px",value:["Low","Medium","High"]},{type:"editable text",prop:"notes",head:"Notes",width:"800px"},{type:"editable text",prop:"type_location",head:"Expected Type/Location",width:"200px"},{type:"editable date",prop:"last_insp_date",head:"Last Insp.Date",width:"200px"},{type:"editable date",prop:"insp_due_date",head:"Insp. Due Date",width:"200px"}],this.displayedColumns=["piping_id"]}ngOnInit(){this.damageMechanismService.getDamageMechanism().subscribe(({data:e})=>{var n;this.selectionData=e[0],this.regenerateTableData(null===(n=e[0])||void 0===n?void 0:n.damage_mechanism),this.dataSource=new c.by(e),this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort})}regenerateTableData(e){const n=this.variables.damageMechanismName.map(o=>{const{id:r}=o;if(null==e?void 0:e[r]){const{last_insp_date:p,insp_due_date:_}=e[r];return Object.assign(Object.assign(Object.assign({},o),e[r]),{active:!0,last_insp_date:new Date(p),insp_due_date:new Date(_)})}return Object.assign({},o)});this.viewTable.regenerateTable(n),this.tableData=this.variables.damageMechanismName}onSubmit(){const e=this.viewTable.getDataSource()._data._value,n=this.selectionData.id,o=e.filter(p=>null==p?void 0:p.active).map(p=>Object.assign(Object.assign({},p),{last_insp_date:this.datePipe.transform(p.last_insp_date,"yyyy-MM-dd"),insp_due_date:this.datePipe.transform(p.insp_due_date,"yyyy-MM-dd")}));let r={};o.forEach(({id:p,insp_due_date:_,last_insp_date:y,notes:M,susceptibility:Z,type_location:S})=>{r[p]={notes:M,type_location:S,susceptibility:Z,last_insp_date:y,insp_due_date:_}}),this.damageMechanismService.updateDamageMechanism(n,{damage_mechanism:r}).subscribe(()=>this.ngOnInit(),()=>this.toastrService.danger("Please check your connection and try again.","Your request failed."),()=>this.toastrService.success("Data has been updated.","Your request success."))}showData(e){this.selectionData=e,this.regenerateTableData(null==e?void 0:e.damage_mechanism)}applyFilter(e){this.dataSource.filter=e.target.value.trim().toLowerCase(),this.dataSource.paginator&&this.dataSource.paginator.firstPage()}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(lt),t.Y36(m.uU),t.Y36(s.quB),t.Y36(F.L))},i.\u0275cmp=t.Xpm({type:i,selectors:[["ngx-demage-mechanism"]],viewQuery:function(e,n){if(1&e&&(t.Gf(x.V,5),t.Gf(d.NW,5),t.Gf(u.YE,5)),2&e){let o;t.iGM(o=t.CRH())&&(n.viewTable=o.first),t.iGM(o=t.CRH())&&(n.paginator=o.first),t.iGM(o=t.CRH())&&(n.sort=o.first)}},decls:25,vars:12,consts:[[1,"d-flex","justify-content-between"],["matInput","","placeholder","Ex. Mia",3,"keyup"],["input",""],[1,"row"],[1,"col-3"],["mat-table","","matSort","",1,"mat-elevation-z8",2,"width","100%","box-shadow","none",3,"dataSource"],["matColumnDef","piping_id"],["mat-header-cell","","mat-sort-header","",3,"ngStyle",4,"matHeaderCellDef"],["mat-cell","","style","cursor : pointer",3,"ngStyle","mouseover","mouseout","click",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",4,"matRowDef","matRowDefColumns"],["aria-label","Select page of GitHub search results",3,"pageSize"],[1,"col-9"],[3,"tableHeader","tableFooter","columnDetails","tableData"],[1,"w-100","d-flex","justify-content-center"],["nbButton","","size","medium","status","success",3,"disabled","click"],["mat-header-cell","","mat-sort-header","",3,"ngStyle"],["mat-cell","",2,"cursor","pointer",3,"ngStyle","mouseover","mouseout","click"],["nameCell",""],["mat-header-row",""],["mat-row",""]],template:function(e,n){1&e&&(t.TgZ(0,"nb-card")(1,"nb-card-header",0)(2,"div")(3,"h5"),t._uU(4,"Damage Mechanism"),t.qZA(),t.TgZ(5,"mat-form-field")(6,"mat-label"),t._uU(7,"Hit Enter To Search"),t.qZA(),t.TgZ(8,"input",1,2),t.NdJ("keyup",function(r){return n.applyFilter(r)}),t.qZA()()()(),t.TgZ(10,"nb-card-body")(11,"div",3)(12,"div",4)(13,"table",5),t.ynx(14,6),t.YNc(15,ct,2,2,"th",7),t.YNc(16,dt,3,4,"td",8),t.BQk(),t.YNc(17,ut,1,0,"tr",9),t.YNc(18,mt,1,0,"tr",10),t.qZA(),t._UZ(19,"mat-paginator",11),t.qZA(),t.TgZ(20,"div",12),t._UZ(21,"ngx-mat-table",13),t.TgZ(22,"div",14)(23,"button",15),t.NdJ("click",function(){return n.onSubmit()}),t._uU(24,"Save"),t.qZA()()()()()()),2&e&&(t.xp6(13),t.Q6J("dataSource",n.dataSource),t.xp6(4),t.Q6J("matHeaderRowDef",n.displayedColumns)("matHeaderRowDefSticky",!0),t.xp6(1),t.Q6J("matRowDefColumns",n.displayedColumns),t.xp6(1),t.Q6J("pageSize",30),t.xp6(2),t.Q6J("tableHeader",t.DdM(10,P))("tableFooter",t.DdM(11,P))("columnDetails",n.columnDetails)("tableData",n.tableData),t.xp6(2),t.Q6J("disabled",!n.selectionData))},directives:[s.Asz,s.ndF,b.KE,b.hX,C.Nt,s.yKW,c.BZ,u.YE,c.w1,c.fO,c.ge,u.nU,m.PC,c.Dz,c.ev,c.as,c.XQ,c.nj,c.Gk,d.NW,x.V,s.DPz],encapsulation:2}),i})();const gt=[{path:"",component:l(3870).M,children:[{path:"visual-condition",component:G},{path:"thickness",component:st},{path:"damage-mechanism",component:_t}]}];let ft=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[[v.Bz.forChild(gt)],v.Bz]}),i})();var vt=l(9511),bt=l(2356),Dt=l(2368),Ct=l(7446);let Tt=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[[m.ez,f.O,s.j5J,ft,bt.Z,vt.H,s.zyh,s.COg,s.IIj,s.oGl,s.nKr,s.MfT,s.T2N,s.BW0,s.KdK,Dt.rP,c.p0,Ct.p9,b.lN,C.c,A.LD,d.TU,u.JX,h.u5,s.PYG,s.LW9.forRoot({destroyByClick:!0,duration:3e3,position:s.fe3.BOTTOM_RIGHT,preventDuplicates:!0,limit:3})]]}),i})()},9371:(w,g,l)=>{l.d(g,{O:()=>v});var m=l(2340),f=l(5e3),s=l(520);let v=(()=>{class u{constructor(d){this.httpClient=d,this.apiUrl=m.N.apiUrl}getDataThickness(){return this.httpClient.get(this.apiUrl+"/thickness")}}return u.\u0275fac=function(d){return new(d||u)(f.LFG(s.eN))},u.\u0275prov=f.Yz7({token:u,factory:u.\u0275fac,providedIn:"root"}),u})()}}]);