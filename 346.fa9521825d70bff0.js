(self.webpackChunkngx_admin_demo=self.webpackChunkngx_admin_demo||[]).push([[346],{1346:(H,k,d)=>{"use strict";d.r(k),d.d(k,{DashboardModule:()=>_e});var _=d(9808),I=d(4738),m=d(3254),N=d(2497),t=d(5e3);let L=(()=>{class s{constructor(){}ngOnInit(){}}return s.\u0275fac=function(e){return new(e||s)},s.\u0275cmp=t.Xpm({type:s,selectors:[["ngx-dashboard"]],decls:1,vars:0,template:function(e,n){1&e&&t._UZ(0,"router-outlet")},directives:[N.lC],encapsulation:2}),s})();var C=d(3872),M=d(2340),w=d(520);let y=(()=>{class s{constructor(e){this.httpClient=e,this.apiUrl=M.N.apiUrl}addImage(e){return this.httpClient.post(this.apiUrl+"/image",e)}showImage(e){return this.httpClient.get(this.apiUrl+"/image/"+e)}addDocument(e){return this.httpClient.post(this.apiUrl+"/document",e,{reportProgress:!0,observe:"events"})}showDocument(e){return this.httpClient.get(this.apiUrl+"/document/"+e)}}return s.\u0275fac=function(e){return new(e||s)(t.LFG(w.eN))},s.\u0275prov=t.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();var f=d(3075);function E(s,c){if(1&s&&(t.TgZ(0,"div",41)(1,"label",42),t._uU(2),t.qZA(),t._UZ(3,"input",43),t.TgZ(4,"span",44),t._uU(5),t.qZA()()),2&s){const e=c.$implicit,n=t.oxw();t.xp6(1),t.Q6J("for",e.id),t.xp6(1),t.Oqu(e.name),t.xp6(1),t.Q6J("id",e.id)("name",e.id)("ngModel",null==n.dialogData||null==n.dialogData.data?null:n.dialogData.data[e.id]),t.xp6(2),t.hij(" ",null==e?null:e.unit," ")}}function A(s,c){if(1&s){const e=t.EpF();t.TgZ(0,"div",45)(1,"div",46)(2,"img",47),t.NdJ("click",function(){return t.CHM(e),t.oxw(),t.MAs(22).click()}),t.qZA()()()}if(2&s){const e=c.$implicit;t.Q6J("ngClass",0==c.index?"active":""),t.xp6(2),t.Q6J("src",e.src,t.LSH)("alt",null==e?null:e.alt)}}function Z(s,c){if(1&s&&(t.TgZ(0,"nb-option",48),t._uU(1),t.qZA()),2&s){const e=c.$implicit;t.Q6J("value",e),t.xp6(1),t.Oqu(e)}}const V=function(s){return{display:s}},$=function(){return[1,2,3,4]};let R=(()=>{class s{constructor(e,n,i){this.dialog=e,this.pageMenuService=n,this.toastr=i,this.spesificationItem=[{id:"piping_id",name:"Piping Id"},{id:"piping_name",name:"Piping Name",unbit:"mm"},{id:"nominal_pipe_size",name:"Nominal Pipe Size"},{id:"pipe_design_code",name:"Pipe Design Code"},{id:"schedule",name:"Schedule"},{id:"outside_diameter",name:"Outside Diameter",unit:"mm"},{id:"longtd_quality_factor",name:"Longtd. Quality Factor (E)"},{id:"weld_joint_factor",name:"Weld Joint Factor (W)"},{id:"allowable_unit_stress",name:"Allowable Unit Stress (S)",unit:"psi"},{id:"coefficient",name:"Coefficient (Y)"},{id:"min_design_pressure",name:"Min. Design Pressure (P min)",unit:"psig"},{id:"max_design_pressure",name:"Max. Design Pressure (P max)",unit:"psig"},{id:"min_design_temperature",name:"Min. Design Temperature (T min)",unit:"F"},{id:"max_design_temperature",name:"Max Design Temperature (T max)",unit:"F"},{id:"corrosion_allowance",name:"Corrosion Allowance",unit:"mm"},{id:"mechanical_allowance",name:"Mechanical Allowances",unit:"mm"},{id:"min_structural_thickness",name:"Min. Structural Thickness",unit:"mm"},{id:"min_alert_thickness",name:"Min. Alert Thickness",unit:"mm"},{id:"nominal_thickness",name:"Nominal Thickness",unit:"mm"}],this.imageLink=[],this.loading=null}ngOnInit(){var e,n;const i=null===(n=null===(e=this.dialogData)||void 0===e?void 0:e.data)||void 0===n?void 0:n.images;i&&(this.imageLink=null==i?void 0:i.map(a=>({src:M.N.apiUrl+"/image/"+a,alt:"Piping Assets"})))}parseToInt(e){return parseInt(e)}onFileChange(e){const n=e.target.files;this.uploadImageFile=n;for(let a of n){var i=new FileReader;i.readAsDataURL(a),i.onload=h=>{this.imageLink.push({src:h.target.result,alt:a.name})}}}onUploadAttachment(e){const n=e.target.files[0],i=new FormData;i.append("document",n),this.pageMenuService.addDocument(i).subscribe(a=>{if(a.type===w.dt.UploadProgress)this.loading=100*Math.round(a.loaded/a.total);else if(a.type===w.dt.Response){const h=a,{id:v}=h.body.data;this.attachment=v,this.loading=null,this.toastr.success("Your File has been uploaded.","Success upload file.")}})}closeDialog(e=null){e||this.dialog.close(),e&&(e=Object.assign(Object.assign({},e),{image:this.uploadImageFile,attachment:this.attachment}),console.log(this.attachment),this.dialog.close(e))}}return s.\u0275fac=function(e){return new(e||s)(t.Y36(m.X4l),t.Y36(y),t.Y36(m.quB))},s.\u0275cmp=t.Xpm({type:s,selectors:[["ngx-add-assets"]],inputs:{dialogData:"dialogData"},decls:58,vars:18,consts:[[1,"w-100","d-flex","justify-content-center","mt-5"],["nbSpinnerStatus","success",1,"mt-5",2,"max-height","35rem","min-width","90rem",3,"nbSpinner","nbSpinnerMessage"],[1,"d-flex"],[1,"w-100"],[1,"flex-shrink-1"],["nbButton","","status","danger","size","tiny",3,"click"],["icon","close-outline"],[3,"ngSubmit"],["addAssetsForm","ngForm"],[1,"row"],[1,"col-8"],[1,"row","row-cols-3"],["class","col mb-2",4,"ngFor","ngForOf"],[1,"col-4"],["id","carouselExampleInterval","data-bs-ride","carousel",1,"carousel","slide"],[1,"carousel-inner"],["class","carousel-item","data-bs-interval","10000",3,"ngClass",4,"ngFor","ngForOf"],["for","addImage"],["placeholder","Add image","multiple","","fullWidth","","nbInput","","type","file","accept","image/png, image/gif, image/jpeg","id","addImage",2,"display","none",3,"ngStyle","change"],["addImage",""],["type","button","data-bs-target","#carouselExampleInterval","data-bs-slide","prev",1,"carousel-control-prev"],["aria-hidden","true",1,"carousel-control-prev-icon"],[1,"visually-hidden"],["type","button","data-bs-target","#carouselExampleInterval","data-bs-slide","next",1,"carousel-control-next"],["aria-hidden","true",1,"carousel-control-next-icon"],[1,"row","row-cols-2"],["for","dateInService",1,"mb-1","d-block"],["fullWidth","","nbInput","","fieldSize","small","name","date_in_service","required","",3,"nbDatepicker","ngModel"],["datepicker",""],["for","class",1,"mb-1","d-block"],["placeholder","Class","size","small","status","primary","name","class",1,"",3,"ngModel"],[3,"value",4,"ngFor","ngForOf"],["for","notes",1,"mb-1","d-block"],["fullWidth","","nbInput","","fieldSize","small","type","text","id","notes","name","notes",3,"ngModel"],["for","addAttach",1,"d-block","mb-1"],["fullWidth","","fieldSize","tiny","nbInput","","type","file","id","addAttach","accept","application/pdf","id","addAttachment","name","attachment",3,"ngModel","change"],["addAttach",""],["for","recomendation",1,"d-block","mb-1"],["fullWidth","","nbInput","","name","recomendation","id","recomendation","rows","2",3,"ngModel"],[1,"d-flex","justify-content-center"],["nbButton","","status","success","type","submit",1,"m-1","w-100",3,"disabled"],[1,"col","mb-2"],[1,"d-block",2,"font-size",".9rem",3,"for"],["fieldSize","small","required","","nbInput","","type","text",1,"col-8",3,"id","name","ngModel"],[1,"col"],["data-bs-interval","10000",1,"carousel-item",3,"ngClass"],[1,"overflow-hidden","d-flex","align-justify-center",2,"height","13rem"],[1,"w-100",3,"src","alt","click"],[3,"value"]],template:function(e,n){if(1&e){const i=t.EpF();t.TgZ(0,"div",0)(1,"nb-card",1)(2,"nb-card-header",2)(3,"h5",3),t._uU(4),t.qZA(),t.TgZ(5,"div",4)(6,"button",5),t.NdJ("click",function(){return n.closeDialog()}),t._UZ(7,"nb-icon",6),t.qZA()()(),t.TgZ(8,"nb-card-body")(9,"form",7,8),t.NdJ("ngSubmit",function(){t.CHM(i);const h=t.MAs(10);return n.closeDialog(h.value)}),t.TgZ(11,"div",9)(12,"div",10)(13,"div",11),t.YNc(14,E,6,6,"div",12),t.qZA()(),t.TgZ(15,"div",13)(16,"div",14)(17,"div",15),t.YNc(18,A,3,3,"div",16),t.TgZ(19,"label",17),t._uU(20,"Image"),t.qZA(),t.TgZ(21,"input",18,19),t.NdJ("change",function(h){return n.onFileChange(h)}),t.qZA()(),t.TgZ(23,"button",20),t._UZ(24,"span",21),t.TgZ(25,"span",22),t._uU(26,"Previous"),t.qZA()(),t.TgZ(27,"button",23),t._UZ(28,"span",24),t.TgZ(29,"span",22),t._uU(30,"Next"),t.qZA()()(),t.TgZ(31,"div",25)(32,"div")(33,"label",26),t._uU(34,"Date In Service"),t.qZA(),t._UZ(35,"input",27)(36,"nb-datepicker",null,28),t.qZA(),t.TgZ(38,"div")(39,"label",29),t._uU(40,"Class"),t.qZA(),t.TgZ(41,"nb-select",30),t.YNc(42,Z,2,2,"nb-option",31),t.qZA()(),t.TgZ(43,"div")(44,"label",32),t._uU(45,"Notes"),t.qZA(),t._UZ(46,"input",33),t.qZA(),t.TgZ(47,"div")(48,"label",34),t._uU(49,"Attachment"),t.qZA(),t.TgZ(50,"input",35,36),t.NdJ("change",function(h){return n.onUploadAttachment(h)}),t.qZA()()()()(),t.TgZ(52,"label",37),t._uU(53,"Recomendation"),t.qZA(),t._UZ(54,"textarea",38),t.TgZ(55,"div",39)(56,"button",40),t._uU(57),t.qZA()()()()()()}if(2&e){const i=t.MAs(10),a=t.MAs(37);t.xp6(1),t.Q6J("nbSpinner",n.loading)("nbSpinnerMessage",n.loading),t.xp6(3),t.Oqu(null==n.dialogData?null:n.dialogData.title),t.xp6(10),t.Q6J("ngForOf",n.spesificationItem),t.xp6(4),t.Q6J("ngForOf",n.imageLink),t.xp6(3),t.Q6J("ngStyle",t.VKq(15,V,n.imageLink.length?"none":"block")),t.xp6(14),t.Q6J("nbDatepicker",a)("ngModel",null==n.dialogData||null==n.dialogData.data?null:n.dialogData.data.date_in_service),t.xp6(6),t.Q6J("ngModel",n.parseToInt(null==n.dialogData||null==n.dialogData.data?null:n.dialogData.data.class)),t.xp6(1),t.Q6J("ngForOf",t.DdM(17,$)),t.xp6(4),t.Q6J("ngModel",null==n.dialogData||null==n.dialogData.data?null:n.dialogData.data.notes),t.xp6(4),t.Q6J("ngModel",null==n.dialogData||null==n.dialogData.data?null:n.dialogData.data.attachment),t.xp6(4),t.Q6J("ngModel",null==n.dialogData||null==n.dialogData.data?null:n.dialogData.data.recomendation),t.xp6(2),t.Q6J("disabled",!i.form.valid),t.xp6(1),t.Oqu(null==n.dialogData?null:n.dialogData.title)}},directives:[m.Asz,m.Q7R,m.ndF,m.DPz,m.fMN,m.yKW,f._Y,f.JL,f.F,_.sg,m.h8i,f.Fj,f.Q7,f.JJ,f.On,_.mk,_.PC,m.$kf,m.B4C,m.rs,m.q51],encapsulation:2}),s})();var J=d(3858),Q=d(7625),Y=d(8929),dt=d(2185),O=d(574),ut=d(9441),pt=(d(7456),d(4641)),q=d.n(pt),K=d(8493),st=d(7238),ot=d.n(st);const Mt=["pdfAssets"];function St(s,c){if(1&s&&(t.TgZ(0,"th")(1,"b",6),t._uU(2),t.qZA()()),2&s){const e=c.$implicit;t.xp6(2),t.Oqu(e.name)}}function Ft(s,c){if(1&s&&(t.TgZ(0,"td"),t._uU(1),t.qZA()),2&s){const e=c.$implicit,n=t.oxw().$implicit;t.xp6(1),t.hij(" ",n[null==e?null:e.props]," ")}}function wt(s,c){if(1&s&&(t.TgZ(0,"div")(1,"tr"),t.YNc(2,Ft,2,1,"td",5),t.qZA(),t.TgZ(3,"tr")(4,"td",7)(5,"b",8),t._uU(6,"Notes"),t.qZA()(),t.TgZ(7,"td",9),t._uU(8),t.qZA()()()),2&s){const e=c.$implicit,n=t.oxw();t.xp6(2),t.Q6J("ngForOf",n.assetsHead),t.xp6(6),t.hij(" ",e.notes," ")}}const ue=function(){return{"font-size":"10px"}};q().vfs=K.I.vfs;let ht=(()=>{class s{constructor(){this.assetsHead=[{name:"Id",props:"piping_id"},{name:"Name",props:"piping_name"},{name:"Date In Service",props:"date_in_service"},{name:"Class",props:"class"},{name:"TM",props:"tm_inspection_interval"},{name:"VE",props:"ve_inspection_interval"}]}generateData(e){this.tableData=e,setTimeout(()=>{this.downloadAsPDF()},500)}downloadAsPDF(){q().tableLayouts={exampleLayout:{hLineWidth:function(a,h){return 0===a||a===h.table.body.length?0:a===h.table.headerRows?2:1},vLineWidth:function(a){return 0},hLineColor:function(a){return 1===a?"black":"#aaa"},paddingLeft:function(a){return 0===a?0:8},paddingRight:function(a,h){return a===h.table.widths.length-1?0:8}}};const e=this.pdfAssets.nativeElement,i={content:[ot()(e.innerHTML),{pageBreak:"before",text:"Attachment\n",style:{bold:!0,fontSize:16,color:"#5588EE"},pageOrientation:"landscape"}],pageBreakBefore:function(a){return a.style&&a.style.indexOf("pdf-pagebreak-before")>-1}};q().createPdf(i).print()}}return s.\u0275fac=function(e){return new(e||s)},s.\u0275cmp=t.Xpm({type:s,selectors:[["pdf-assets-dashboard"]],viewQuery:function(e,n){if(1&e&&t.Gf(Mt,5),2&e){let i;t.iGM(i=t.CRH())&&(n.pdfAssets=i.first)}},decls:9,vars:5,consts:[[1,"container",2,"display","none"],["id","pdfTable"],["pdfAssets",""],[2,"width","100%","margin","0 0 1rem 0","color","#5588EE"],["data-pdfmake","{'widths':[ 'auto', '*', '*', 20, '*', '*' ], 'layout' : 'exampleLayout'}"],[4,"ngFor","ngForOf"],[2,"font-weight","bold"],["colspan","1"],[2,"color","darkcyan"],["colspan","5"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1,2)(3,"h5",3),t._uU(4," Piping Assets "),t.qZA(),t.TgZ(5,"table",4)(6,"tr"),t.YNc(7,St,3,1,"th",5),t.qZA(),t.YNc(8,wt,9,2,"div",5),t.qZA()()()),2&e&&(t.xp6(5),t.Akn(t.DdM(4,ue)),t.xp6(2),t.Q6J("ngForOf",n.assetsHead),t.xp6(1),t.Q6J("ngForOf",n.tableData))},directives:[_.sg],encapsulation:2}),s})(),X=(()=>{class s{constructor(e){this.httpClient=e,this.apiUrl=M.N.apiUrl}getPipingAssets(){const e=this.apiUrl+"/assets",n=new w.WM;return n.append("enctype","multipart/form-data"),n.append("Accept","*/*"),this.httpClient.get(e)}addPipingAssets(e){return this.httpClient.post(this.apiUrl+"/assets",e)}updatePipingAssets(e){return this.httpClient.put(this.apiUrl+"/assets/"+e.id,e)}deletePipingAssets(e){return this.httpClient.delete(this.apiUrl+"/assets/"+e)}uploadImage(e){return this.httpClient.post(this.apiUrl+"/file/upload",e,{reportProgress:!0,observe:"events"})}importAsset(e){return this.httpClient.post(this.apiUrl+"/import_assets",e)}}return s.\u0275fac=function(e){return new(e||s)(t.LFG(w.eN))},s.\u0275prov=t.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();var at=d(7024);function z(s,c){if(1&s){const e=t.EpF();t.TgZ(0,"button",2),t.NdJ("click",function(){const a=t.CHM(e).$implicit,h=t.MAs(2),v=t.oxw();return"New"==a.name?v.addAssets():"Import"==a.name?h.click():"Export"==a.name?v.exportExcelFile():"Print"==a.name?v.pdfAssets.generateData(v.tableData):null}),t.TgZ(1,"input",3,4),t.NdJ("change",function(i){return t.CHM(e),t.oxw().importExcelFile(i)}),t.qZA(),t._UZ(3,"nb-icon",5),t.TgZ(4,"span"),t._uU(5),t.qZA()()}if(2&s){const e=c.$implicit,n=t.oxw();let i;t.Q6J("disabled",!("Export"!=(null==e?null:e.name)&&"Print"!=(null==e?null:e.name)||null!=n.tableData&&n.tableData.length)),t.xp6(3),t.Q6J("icon",e.icon)("pack",null!==(i=e.pack)&&void 0!==i?i:"eva"),t.xp6(2),t.Oqu(e.name)}}const rt=function(){return{name:"New",icon:"plus-outline"}},mt=function(){return{name:"Import",icon:"download-outline"}},Ut=function(){return{name:"Export",icon:"upload-outline"}},kt=function(){return{name:"Print",icon:"printer-outline"}},pe=function(s,c,e,n){return[s,c,e,n]};let Et=(()=>{class s{constructor(e,n,i,a,h,v){this.assetsService=e,this.dialogService=n,this.toastrService=i,this.pageMenuService=a,this.datePipe=h,this.variables=v,this.destroy$=new Y.xQ,this.tableHeader={title:"Piping Assets",filter:[{name:"Class",value:["All",1,2,3,4],title:"class-assets"}]},this.columnDetails=[{type:"select",prop:"select",head:"",width:"20px"},{type:"text",prop:"piping_id",head:"Piping Id",width:"100px"},{type:"text",prop:"piping_name",head:"Piping Name",width:"200px"},{type:"text",prop:"date_in_service",head:"Date In Service",width:"200px"},{type:"text",prop:"class",head:"Class",width:"50px"},{type:"text",prop:"tm_inspection_interval",head:"TM Inspection Interval",width:"200px"},{type:"text",prop:"ve_inspection_interval",head:"VE Inspection Interval",width:"200px"},{type:"text",prop:"notes",head:"Notes",width:"200px"},{type:"button",prop:"edit",width:"80px",button:[{icon:"edit-outline",status:"info",title:"edit-assets"},{icon:"trash-2-outline",status:"danger",title:"delete-assets"}]}],this.dataSubject=new dt.c,this.transformExcelDate=T=>null==T?"":new Date(Math.round(86400*(T-25569)*1e3))}ngOnInit(){this.assetsService.getPipingAssets().subscribe(({data:e})=>{this.tableData=e.map(n=>{let{tm_inspection_interval:i,ve_inspection_interval:a}=n;return({tm_inspection_interval:i,ve_inspection_interval:a}=this.variables.getInspectionInt(n)),i=i?i.toFixed(1):0,a=a?a.toFixed(1):0,Object.assign(Object.assign({},n),{tm_inspection_interval:i,ve_inspection_interval:a})}),this.viewTable.regenerateTable(this.tableData)},()=>this.toastrService.danger("Please check your connection and try again.","Your request failed."))}onClickTable(e,n){"delete-assets"==n&&this.deleteAsset(e),"edit-assets"==n&&this.updateAssets(e),"class-assets"==n&&this.filterByClass(e),"Export To Excel"==n&&this.exportExcelFile()}filterByClass(e){if("All"==e)this.viewTable.regenerateTable(this.tableData);else{const n=this.tableData.filter(i=>i.class==e);this.viewTable.regenerateTable(n)}}uploadImage(e){const n=new FormData;n.append("image",e),this.pageMenuService.addImage(n).pipe((0,Q.R)(this.destroy$)).subscribe(i=>{this.dataSubject.next(i),this.dataSubject.complete()},()=>this.toastrService.danger("Please check your connection and try again.","Failed to upload image."))}addAssets(){this.dialogService.open(R,{context:{dialogData:{title:"Add Assets"}}}).onClose.subscribe(e=>{!e||this.reconstructAssetsData(e,"add")})}updateAssets(e){this.dialogService.open(R,{context:{dialogData:{title:"Update Assets",data:Object.assign(Object.assign({},e),{date_in_service:new Date(e.date_in_service)})}}}).onClose.subscribe(n=>{!n||this.reconstructAssetsData(n,"update",e)})}reconstructAssetsData(e,n,i=null){const{image:a}=e,h=Object.assign(Object.assign(Object.assign({},i),e),{date_in_service:this.datePipe.transform(e.date_in_service,"yyyy-MM-dd")});if(a)for(let v of a)this.uploadImage(v);this.dataSubject.asObservable().pipe((0,Q.R)(this.destroy$)).subscribe(v=>{var T;let F=[...null!==(T=null==i?void 0:i.images)&&void 0!==T?T:[]],U=v.data.id;for(let j=U;j<U+a.length;j++)F.push(j);h.images=F,"add"==n&&this.onUploadaddAsset(h),"update"==n&&this.onUploadUpdateAsset(h)}),"add"==n&&!a&&this.onUploadaddAsset(h),"update"==n&&!a&&this.onUploadUpdateAsset(h)}onUploadaddAsset(e){this.assetsService.addPipingAssets(e).subscribe(()=>this.ngOnInit(),()=>this.toastrService.danger("Please check your connection and try again.","Your request failed."),()=>this.toastrService.success("Data has been added.","Your request success."))}onUploadUpdateAsset(e){this.assetsService.updatePipingAssets(e).pipe((0,Q.R)(this.destroy$)).subscribe(()=>this.ngOnInit(),()=>this.toastrService.danger("Please check your connection and try again.","Your request failed."),()=>this.toastrService.success("Data has been updated.","Your request success."))}deleteAsset(e){this.dialogService.open(C.F,{context:{dialogData:{title:"Delete Assets",name:e.piping_name,id:e.id}}}).onClose.subscribe(n=>{n&&this.assetsService.deletePipingAssets(n.id).pipe((0,Q.R)(this.destroy$)).subscribe(()=>this.ngOnInit(),()=>this.toastrService.danger("Please check your connection and try again.","Your request failed."),()=>this.toastrService.success("Data has been delete.","Your request success."))})}exportExcelFile(){const e=this.viewTable.selectTableRow(),i={Sheets:{"Piping Assets":O.P6.json_to_sheet(e)},SheetNames:["Piping Assets"]},a=O.cW(i,{bookType:"xlsx",type:"array"});this.saveAsExcelFile(a,"Assets")}saveAsExcelFile(e,n){const i=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});ut.saveAs(i,n+"_PIPING_MONITORING_"+(new Date).getTime()+".xlsx")}importExcelFile(e){const n=e.target.files[0];if(!n)return;const i=new FileReader;i.readAsBinaryString(n),i.onload=a=>{const T=O.ij(a.target.result,{type:"binary"}).Sheets["Data Assets"];let F=0,U=!0;for(;U;){if(F>100&&(U=!1),T["A"+F]){U=!1;break}F++}const j=O.P6.sheet_to_json(T,{range:F-1,defval:""});this.reconstructDataExcel(j)}}reconstructDataExcel(e){e=e.map(n=>{let{"Piping ID":i,"Piping Name":a,NPS:h,"Pipe Design Code":v,Schedule:T,"Outside Diameter":F,"Long. Quality Factor":U,"Weld Joint Factor":j,"Allowable Stress":B,Coefficient:ve,"Min. Design Pressure":xe,"Max. Design Pressure":ye,"Min. Design Temperature":Ce,"Max. Design Temperature":Ae,"Corrosion Allowance":De,"Mechanical Allowance":Te,"Min. Structural Thickness":Pe,"Min. Alert Thickness":Ze,"Nominal Thickness":Me,"Date in Service":de,Notes:Se,Recomendation:Fe,Class:we}=n;return de=this.datePipe.transform(this.transformExcelDate(de),"yyyy-MM-dd"),{piping_id:i,piping_name:a,nominal_pipe_size:h,pipe_design_code:v,schedule:T,outside_diameter:F,longtd_quality_factor:U,weld_joint_factor:j,allowable_unit_stress:B,coefficient:ve,min_design_pressure:xe,max_design_pressure:ye,min_design_temperature:Ce,max_design_temperature:Ae,corrosion_allowance:De,mechanical_allowance:Te,min_structural_thickness:Pe,min_alert_thickness:Ze,nominal_thickness:Me,date_in_service:de,notes:Se,recomendation:Fe,class:we}}),this.assetsService.importAsset(e).subscribe(()=>this.ngOnInit(),()=>this.toastrService.danger("Please check your connection and try again.","Your request failed."),()=>this.toastrService.success("Data has been delete.","Your request success."))}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}}return s.\u0275fac=function(e){return new(e||s)(t.Y36(X),t.Y36(m.Gln),t.Y36(m.quB),t.Y36(y),t.Y36(_.uU),t.Y36(at.L))},s.\u0275cmp=t.Xpm({type:s,selectors:[["ngx-piping-assets"]],viewQuery:function(e,n){if(1&e&&(t.Gf(J.V,5),t.Gf(ht,5)),2&e){let i;t.iGM(i=t.CRH())&&(n.viewTable=i.first),t.iGM(i=t.CRH())&&(n.pdfAssets=i.first)}},decls:5,vars:13,consts:[["nbButton","","outline","","size","small","status","primary","class","m-2",3,"disabled","click",4,"ngFor","ngForOf"],[3,"tableHeader","columnDetails","tableData","onClickTable"],["nbButton","","outline","","size","small","status","primary",1,"m-2",3,"disabled","click"],["type","file","accept",".xls,.xlsx",2,"display","none",3,"change"],["importExcel",""],[1,"m-1",3,"icon","pack"]],template:function(e,n){1&e&&(t.TgZ(0,"nb-card")(1,"nb-card-body"),t.YNc(2,z,6,4,"button",0),t.qZA()(),t.TgZ(3,"ngx-mat-table",1),t.NdJ("onClickTable",function(a){return n.onClickTable(a.data,a.title)}),t.qZA(),t._UZ(4,"pdf-assets-dashboard")),2&e&&(t.xp6(2),t.Q6J("ngForOf",t.l5B(8,pe,t.DdM(4,rt),t.DdM(5,mt),t.DdM(6,Ut),t.DdM(7,kt))),t.xp6(1),t.Q6J("tableHeader",n.tableHeader)("columnDetails",n.columnDetails)("tableData",n.tableData))},directives:[m.Asz,m.yKW,_.sg,m.DPz,m.fMN,J.V,ht],encapsulation:2}),s.\u0275prov=t.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();function ft(s,c){if(1&s&&(t.TgZ(0,"nb-option",43),t._uU(1),t.qZA()),2&s){const e=c.$implicit;t.Q6J("value",e.id),t.xp6(1),t.hij("",null==e?null:e.piping_id," ")}}function Ot(s,c){if(1&s&&(t.TgZ(0,"nb-option",43),t._uU(1),t.qZA()),2&s){const e=c.$implicit;t.Q6J("value",e),t.xp6(1),t.Oqu(e)}}function Nt(s,c){if(1&s){const e=t.EpF();t.TgZ(0,"div",44)(1,"div",45)(2,"img",46),t.NdJ("click",function(){return t.CHM(e),t.oxw(),t.MAs(52).click()}),t.qZA()()()}if(2&s){const e=c.$implicit;t.Q6J("ngClass",0==c.index?"active":""),t.xp6(2),t.Q6J("src",e.src,t.LSH)("alt",null==e?null:e.alt)}}const bt=function(){return[]},W=function(){return[1,2,3,4]},jt=function(s){return{display:s}};let tt=(()=>{class s{constructor(e,n,i,a){this.dialog=e,this.assetsService=n,this.pageMenuService=i,this.toastr=a,this.apiUrl=M.N.apiUrl,this.imageLink=[],this.loading=null}ngOnInit(){var e,n;this.assetsService.getPipingAssets().subscribe(({data:a})=>{this.piping=a.filter(h=>{var v,T;return!h.piping_circuit||(null===(T=null===(v=this.dialogData)||void 0===v?void 0:v.data)||void 0===T?void 0:T.piping_id.includes(h.id))})});const i=null===(n=null===(e=this.dialogData)||void 0===e?void 0:e.data)||void 0===n?void 0:n.images;i&&(this.imageLink=i.map(a=>({src:this.apiUrl+"/image/"+a,alt:"Piping Assets"})))}onFileChange(e){const n=e.target.files;this.uploadImageFile=n;for(let a of n){var i=new FileReader;i.readAsDataURL(a),i.onload=h=>{this.imageLink.push({src:h.target.result,alt:a.name})}}}parseInt(e){return e?parseInt(e):null}onUploadAttachment(e){const n=e.target.files[0],i=new FormData;i.append("document",n),this.pageMenuService.addDocument(i).subscribe(a=>{if(a.type===w.dt.UploadProgress)this.loading=100*Math.round(a.loaded/a.total);else if(a.type===w.dt.Response){const h=a,{id:v}=h.body.data;this.attachment=v,this.loading=null,this.toastr.success("Your File has been uploaded.","Success upload file.")}})}closeDialog(e=null){e||this.dialog.close(),e&&(e=Object.assign(Object.assign({},e),{image:this.uploadImageFile,attachment:this.attachment}),this.dialog.close(e))}}return s.\u0275fac=function(e){return new(e||s)(t.Y36(m.X4l),t.Y36(X),t.Y36(y),t.Y36(m.quB))},s.\u0275cmp=t.Xpm({type:s,selectors:[["ngx-add-circuit"]],inputs:{dialogData:"dialogData"},decls:60,vars:22,consts:[[1,"d-flex","justify-content-center","align-items-center","mt-4"],["nbSpinnerStatus","success",1,"mt-5",2,"max-height","35rem","min-width","90rem",3,"nbSpinner","nbSpinnerMessage"],[1,"d-flex"],[1,"w-100"],[1,"flex-shrink-1"],["nbButton","","status","danger","size","tiny",3,"click"],["icon","close-outline"],[3,"ngSubmit"],["addCircuitForm","ngForm"],[1,"row"],[1,"col-6"],["for","piping_circuit_id",1,"mb-1","d-block"],["fullWidth","","nbInput","","fieldSize","small","type","text","id","piping_circuit_id","name","piping_circuit_id","required","",3,"ngModel"],["for","piping_id",1,"mb-1","d-block"],["multiple","","placeholder","Select Assets","name","piping_id",2,"min-width","35rem",3,"ngModel"],[3,"value",4,"ngFor","ngForOf"],["for","piping_circuit_name",1,"mb-1","d-block"],["fullWidth","","nbInput","","fieldSize","small","type","text","id","piping_circuit_name","name","piping_circuit_name","required","",3,"ngModel"],["for","dateInService",1,"mb-1","d-block"],["fullWidth","","nbInput","","fieldSize","small","name","date_in_service","required","",3,"nbDatepicker","ngModel"],["datepicker",""],["for","class",1,"mb-1","d-block"],["placeholder","Class","size","small","status","primary","name","class","required","",3,"ngModel"],["for","notes",1,"mb-1","d-block"],["fullWidth","","nbInput","","fieldSize","small","type","text","id","notes","name","notes",3,"ngModel"],["for","addAttach",1,"d-block","mb-1"],["fullWidth","","fieldSize","tiny","nbInput","","type","file","id","addAttach","accept","application/pdf","id","addAttachment","name","attachment",3,"ngModel","change"],["addAttach",""],[1,"col-6","align-self-center"],["id","carouselExampleInterval","data-bs-ride","carousel",1,"carousel","slide"],[1,"carousel-inner"],["class","carousel-item","data-bs-interval","10000",3,"ngClass",4,"ngFor","ngForOf"],["type","button","data-bs-target","#carouselExampleInterval","data-bs-slide","prev",1,"carousel-control-prev"],["aria-hidden","true",1,"carousel-control-prev-icon"],[1,"visually-hidden"],["type","button","data-bs-target","#carouselExampleInterval","data-bs-slide","next",1,"carousel-control-next"],["aria-hidden","true",1,"carousel-control-next-icon"],["placeholder","Add image","multiple","","fullWidth","","nbInput","","type","file","accept","image/png, image/gif, image/jpeg","id","addImage",2,"display","none",3,"ngStyle","change"],["addImage",""],["for","recomendation",1,"d-block","mb-1"],["fullWidth","","nbInput","","name","recomendation","id","recomendation","rows","2","name","recomendation",3,"ngModel"],[1,"d-flex","justify-content-center"],["nbButton","","status","success","type","submit",1,"m-1","w-100",3,"disabled"],[3,"value"],["data-bs-interval","10000",1,"carousel-item",3,"ngClass"],[1,"overflow-hidden","d-flex","align-justify-center",2,"height","18rem"],[1,"w-100",3,"src","alt","click"]],template:function(e,n){if(1&e){const i=t.EpF();t.TgZ(0,"div",0)(1,"nb-card",1)(2,"nb-card-header",2)(3,"h5",3),t._uU(4),t.qZA(),t.TgZ(5,"div",4)(6,"button",5),t.NdJ("click",function(){return n.closeDialog()}),t._UZ(7,"nb-icon",6),t.qZA()()(),t.TgZ(8,"nb-card-body")(9,"form",7,8),t.NdJ("ngSubmit",function(){t.CHM(i);const h=t.MAs(10);return n.closeDialog(h.value)}),t.TgZ(11,"div",9)(12,"div",10)(13,"label",11),t._uU(14,"Piping Circuit Id"),t.qZA(),t._UZ(15,"input",12),t.TgZ(16,"label",13),t._uU(17,"Piping Id"),t.qZA(),t.TgZ(18,"nb-select",14),t.YNc(19,ft,2,2,"nb-option",15),t.qZA(),t.TgZ(20,"label",16),t._uU(21,"Piping Circuit Name"),t.qZA(),t._UZ(22,"input",17),t.TgZ(23,"label",18),t._uU(24,"Date In Service"),t.qZA(),t._UZ(25,"input",19)(26,"nb-datepicker",null,20),t.TgZ(28,"label",21),t._uU(29,"Class"),t.qZA(),t.TgZ(30,"nb-select",22),t.YNc(31,Ot,2,2,"nb-option",15),t.qZA(),t.TgZ(32,"label",23),t._uU(33,"Notes"),t.qZA(),t._UZ(34,"input",24),t.TgZ(35,"label",25),t._uU(36,"Attachment"),t.qZA(),t.TgZ(37,"input",26,27),t.NdJ("change",function(h){return n.onUploadAttachment(h)}),t.qZA()(),t.TgZ(39,"div",28)(40,"div",29)(41,"div",30),t.YNc(42,Nt,3,3,"div",31),t.qZA(),t.TgZ(43,"button",32),t._UZ(44,"span",33),t.TgZ(45,"span",34),t._uU(46,"Previous"),t.qZA()(),t.TgZ(47,"button",35),t._UZ(48,"span",36),t.TgZ(49,"span",34),t._uU(50,"Next"),t.qZA()()(),t.TgZ(51,"input",37,38),t.NdJ("change",function(h){return n.onFileChange(h)}),t.qZA()(),t.TgZ(53,"div")(54,"label",39),t._uU(55,"Recomendation"),t.qZA(),t._UZ(56,"textarea",40),t.qZA(),t.TgZ(57,"div",41)(58,"button",42),t._uU(59),t.qZA()()()()()()()}if(2&e){const i=t.MAs(10),a=t.MAs(27);let h;t.xp6(1),t.Q6J("nbSpinner",n.loading)("nbSpinnerMessage",n.loading),t.xp6(3),t.Oqu(null==n.dialogData?null:n.dialogData.title),t.xp6(11),t.Q6J("ngModel",null==n.dialogData||null==n.dialogData.data?null:n.dialogData.data.piping_circuit_id),t.xp6(3),t.Q6J("ngModel",null!==(h=null==n.dialogData||null==n.dialogData.data?null:n.dialogData.data.piping_id)&&void 0!==h?h:t.DdM(18,bt)),t.xp6(1),t.Q6J("ngForOf",n.piping),t.xp6(3),t.Q6J("ngModel",null==n.dialogData||null==n.dialogData.data?null:n.dialogData.data.piping_circuit_name),t.xp6(3),t.Q6J("nbDatepicker",a)("ngModel",null==n.dialogData||null==n.dialogData.data?null:n.dialogData.data.date_in_service),t.xp6(5),t.Q6J("ngModel",n.parseInt(null==n.dialogData||null==n.dialogData.data?null:n.dialogData.data.class)),t.xp6(1),t.Q6J("ngForOf",t.DdM(19,W)),t.xp6(3),t.Q6J("ngModel",null==n.dialogData||null==n.dialogData.data?null:n.dialogData.data.notes),t.xp6(3),t.Q6J("ngModel",null==n.dialogData||null==n.dialogData.data?null:n.dialogData.data.attachment),t.xp6(5),t.Q6J("ngForOf",n.imageLink),t.xp6(9),t.Q6J("ngStyle",t.VKq(20,jt,n.imageLink.length?"none":"block")),t.xp6(5),t.Q6J("ngModel",null==n.dialogData||null==n.dialogData.data?null:n.dialogData.data.recomendation),t.xp6(2),t.Q6J("disabled",!i.form.valid),t.xp6(1),t.Oqu(null==n.dialogData?null:n.dialogData.title)}},directives:[m.Asz,m.Q7R,m.ndF,m.DPz,m.fMN,m.yKW,f._Y,f.JL,f.F,m.h8i,f.Fj,f.Q7,f.JJ,f.On,m.rs,_.sg,m.q51,m.$kf,m.B4C,_.mk,_.PC],encapsulation:2}),s})();const Jt=["pdfCircuit"];function qt(s,c){if(1&s&&(t.TgZ(0,"th")(1,"b",6),t._uU(2),t.qZA()()),2&s){const e=c.$implicit;t.xp6(2),t.Oqu(e.name)}}function _t(s,c){if(1&s&&(t.TgZ(0,"td"),t._uU(1),t.qZA()),2&s){const e=c.$implicit,n=t.oxw().$implicit;t.xp6(1),t.hij(" ",n[null==e?null:e.props]," ")}}function Lt(s,c){if(1&s&&(t.TgZ(0,"div")(1,"tr"),t.YNc(2,_t,2,1,"td",5),t.qZA(),t.TgZ(3,"tr")(4,"td",7)(5,"b",8),t._uU(6,"Notes"),t.qZA()(),t.TgZ(7,"td",9),t._uU(8),t.qZA()()()),2&s){const e=c.$implicit,n=t.oxw();t.xp6(2),t.Q6J("ngForOf",n.assetsHead),t.xp6(6),t.hij(" ",e.notes," ")}}const Qt=function(){return{"font-size":"10px"}};q().vfs=K.I.vfs;let vt=(()=>{class s{constructor(){this.assetsHead=[{name:"Id",props:"piping_circuit_id"},{name:"Name",props:"piping_circuit_name"},{name:"Date In Service",props:"date_in_service"},{name:"Class",props:"class"}]}generateData(e){this.tableData=e,setTimeout(()=>{this.downloadAsPDF()},500)}downloadAsPDF(){q().tableLayouts={exampleLayout:{hLineWidth:function(a,h){return 0===a||a===h.table.body.length?0:a===h.table.headerRows?2:1},vLineWidth:function(a){return 0},hLineColor:function(a){return 1===a?"black":"#aaa"},paddingLeft:function(a){return 0===a?0:8},paddingRight:function(a,h){return a===h.table.widths.length-1?0:8}}};const e=this.pdfCircuit.nativeElement,i={content:[ot()(e.innerHTML),{pageBreak:"before",text:"Attachment\n",style:{bold:!0,fontSize:16,color:"#5588EE"},pageOrientation:"landscape"}],pageBreakBefore:function(a){return a.style&&a.style.indexOf("pdf-pagebreak-before")>-1}};q().createPdf(i).print()}}return s.\u0275fac=function(e){return new(e||s)},s.\u0275cmp=t.Xpm({type:s,selectors:[["pdf-circuit-dashboard"]],viewQuery:function(e,n){if(1&e&&t.Gf(Jt,5),2&e){let i;t.iGM(i=t.CRH())&&(n.pdfCircuit=i.first)}},decls:9,vars:5,consts:[[1,"container",2,"display","none"],["id","pdfTable"],["pdfCircuit",""],[2,"width","100%","margin","0 0 1rem 0","color","#5588EE"],["data-pdfmake","{'widths':[ '*', '*', '*', '*' ], 'layout' : 'exampleLayout'}"],[4,"ngFor","ngForOf"],[2,"font-weight","bold"],["colspan","1"],[2,"color","darkcyan"],["colspan","3"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1,2)(3,"h5",3),t._uU(4," Piping Circuits "),t.qZA(),t.TgZ(5,"table",4)(6,"tr"),t.YNc(7,qt,3,1,"th",5),t.qZA(),t.YNc(8,Lt,9,2,"div",5),t.qZA()()()),2&e&&(t.xp6(5),t.Akn(t.DdM(4,Qt)),t.xp6(2),t.Q6J("ngForOf",n.assetsHead),t.xp6(1),t.Q6J("ngForOf",n.tableData))},directives:[_.sg],encapsulation:2}),s})();var xt=d(2787);function Rt(s,c){if(1&s){const e=t.EpF();t.TgZ(0,"button",2),t.NdJ("click",function(){const a=t.CHM(e).$implicit,h=t.MAs(2),v=t.oxw();return"New"==a.name?v.addCircuit():"Import"==a.name?h.click():"Export"==a.name?v.exportExcelFile():"Print"==a.name?v.pdfCircuit.generateData(v.tableData):null}),t.TgZ(1,"input",3,4),t.NdJ("change",function(i){return t.CHM(e),t.oxw().importExcelFile(i)}),t.qZA(),t._UZ(3,"nb-icon",5),t.TgZ(4,"span"),t._uU(5),t.qZA()()}if(2&s){const e=c.$implicit,n=t.oxw();let i;t.Q6J("disabled",!("Export"!=(null==e?null:e.name)&&"Print"!=(null==e?null:e.name)||null!=n.tableData&&n.tableData.length)),t.xp6(3),t.Q6J("icon",e.icon)("pack",null!==(i=e.pack)&&void 0!==i?i:"eva"),t.xp6(2),t.Oqu(e.name)}}const yt=function(){return{name:"New",icon:"plus-outline"}},Yt=function(){return{name:"Import",icon:"download-outline"}},Bt=function(){return{name:"Export",icon:"upload-outline"}},lt=function(){return{name:"Print",icon:"printer-outline"}},Ht=function(s,c,e,n){return[s,c,e,n]};let Ct=(()=>{class s{constructor(e,n,i,a,h,v){this.circuitService=e,this.dialogService=n,this.toastrService=i,this.datePipe=a,this.pageMenuService=h,this.variables=v,this.tableHeader={title:"Piping Circuits",filter:[{name:"Class",value:["All",1,2,3,4],title:"class-circuit"}]},this.columnDetails=[{type:"select",prop:"select",head:"",width:"20px"},{type:"text",prop:"piping_circuit_id",head:"Piping Circuit Id",width:"100px"},{type:"text",prop:"piping_circuit_name",head:"Piping Circuit Name",width:"200px"},{type:"text",prop:"date_in_service",head:"Date In Service",width:"200px"},{type:"text",prop:"class",head:"Class",width:"50px"},{type:"text",prop:"notes",head:"Notes",width:"400px"},{type:"button",prop:"edit",width:"80px",button:[{icon:"edit-outline",status:"info",title:"update-circuits"},{icon:"trash-2-outline",status:"danger",title:"delete-circuits"}]}],this.dataSubject=new dt.c}ngOnInit(){this.circuitService.getPipingCircuits().subscribe(({data:e})=>{this.tableData=e,this.viewTable.regenerateTable(e)})}onClickTable(e,n){if("class-circuit"==n)if("All"==e)this.viewTable.regenerateTable(this.tableData);else{const i=this.tableData.filter(a=>a.class==e);this.viewTable.regenerateTable(i)}"update-circuits"==n&&this.updateCircuit(e),"delete-circuits"==n&&this.deleteCircuit(e)}uploadImage(e){const n=new FormData;n.append("image",e),this.pageMenuService.addImage(n).subscribe(i=>{this.dataSubject.next(i),this.dataSubject.complete()},()=>this.toastrService.danger("Please check your connection and try again.","Failed to upload image."))}importExcelFile(e){const n=e.target.files[0];if(!n)return;const i=new FileReader;i.readAsBinaryString(n),i.onload=a=>{const v=O.ij(a.target.result,{type:"binary"}),T=v.Sheets[v.SheetNames[0]];let F=0,U=!0;for(;U;){if(F>100&&(U=!1),T["A"+F]){U=!1;break}F++}const j=O.P6.sheet_to_json(T,{range:F-1,defval:""});this.reconstructDataExcel(j)}}reconstructDataExcel(e){const n=e.map(({"Piping Circuit Id":i,"Piping Circuit Name":a,Notes:h,Class:v,"Date In Service":T,Recommendation:F})=>(T=this.variables.transformExcelDate(T),{piping_circuit_id:i,piping_circuit_name:a,notes:h,class:v,date_in_service:T=this.datePipe.transform(T,"yyyy-MM-dd"),recomendation:F}));console.log(n),this.circuitService.importCircuits(n).subscribe(()=>this.ngOnInit(),()=>this.toastrService.danger("Please check your connection and try again.","Your request failed."),()=>this.toastrService.success("Data has been imported.","Your request success."))}exportExcelFile(){const e=this.viewTable.selectTableRow(),i={Sheets:{"Piping Circuit":O.P6.json_to_sheet(e)},SheetNames:["Piping Circuit"]},a=O.cW(i,{bookType:"xlsx",type:"array"});this.saveAsExcelFile(a,"Circuit")}saveAsExcelFile(e,n){const i=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});ut.saveAs(i,n+"_PIPING_MONITORING_"+(new Date).getTime()+".xlsx")}addCircuit(){this.dialogService.open(tt,{context:{dialogData:{title:"Add Circuit"}}}).onClose.subscribe(e=>{!e||this.reconstructDataCircuit(e,"add")})}updateCircuit(e){const n=e.piping.map(i=>i.id);this.dialogService.open(tt,{context:{dialogData:{title:"Update Circuit",data:Object.assign(Object.assign({},e),{date_in_service:new Date(e.date_in_service),piping_id:n})}}}).onClose.subscribe(i=>{!i||this.reconstructDataCircuit(i,"update",e)})}reconstructDataCircuit(e,n,i=null){const{image:a}=e;if(a)for(let v of a)this.uploadImage(v);this.dataSubject.asObservable().subscribe(v=>{var T;let F=[...null!==(T=null==i?void 0:i.images)&&void 0!==T?T:[]],U=v.data.id;for(let B=U;B<U+a.length;B++)F.push(B);const j=Object.assign(Object.assign(Object.assign({},i),e),{images:F,date_in_service:this.datePipe.transform(e.date_in_service,"yyyy-MM-dd")});console.log(j),"add"==n&&this.onUploadaddCircuit(j),"update"==n&&this.onUploadUpdateCircuit(j)});const h=Object.assign(Object.assign(Object.assign({},i),e),{date_in_service:this.datePipe.transform(e.date_in_service,"yyyy-MM-dd")});"add"==n&&!a&&this.onUploadaddCircuit(h),"update"==n&&!a&&this.onUploadUpdateCircuit(h)}onUploadaddCircuit(e){this.circuitService.addPipingCircuits(e).subscribe(()=>this.ngOnInit(),()=>this.toastrService.danger("Please check your connection and try again.","Your request failed."),()=>this.toastrService.success("Data has been added.","Your request success."))}onUploadUpdateCircuit(e){this.circuitService.updatePipingCircuits(e).subscribe(()=>this.ngOnInit(),()=>this.toastrService.danger("Please check your connection and try again.","Your request failed."),()=>this.toastrService.success("Data has been added.","Your request success."))}deleteCircuit(e){this.dialogService.open(C.F,{context:{dialogData:{title:"Add Circuit",name:e.piping_circuit_name,id:e.id}}}).onClose.subscribe(n=>{!n||this.circuitService.deletePipingCircuits(n.id).subscribe(()=>this.ngOnInit(),()=>this.toastrService.danger("Please check your connection and try again.","Your request failed."),()=>this.toastrService.success("Data has been added.","Your request success."))})}}return s.\u0275fac=function(e){return new(e||s)(t.Y36(xt.t),t.Y36(m.Gln),t.Y36(m.quB),t.Y36(_.uU),t.Y36(y),t.Y36(at.L))},s.\u0275cmp=t.Xpm({type:s,selectors:[["ngx-piping-circuits"]],viewQuery:function(e,n){if(1&e&&(t.Gf(J.V,5),t.Gf(vt,5)),2&e){let i;t.iGM(i=t.CRH())&&(n.viewTable=i.first),t.iGM(i=t.CRH())&&(n.pdfCircuit=i.first)}},decls:5,vars:13,consts:[["nbButton","","outline","","size","small","status","primary","class","m-2",3,"disabled","click",4,"ngFor","ngForOf"],[3,"tableHeader","columnDetails","tableData","onClickTable"],["nbButton","","outline","","size","small","status","primary",1,"m-2",3,"disabled","click"],["type","file","accept",".xls,.xlsx",2,"display","none",3,"change"],["importExcel",""],[1,"m-1",3,"icon","pack"]],template:function(e,n){1&e&&(t.TgZ(0,"nb-card")(1,"nb-card-body"),t.YNc(2,Rt,6,4,"button",0),t.qZA()(),t.TgZ(3,"ngx-mat-table",1),t.NdJ("onClickTable",function(a){return n.onClickTable(a.data,a.title)}),t.qZA(),t._UZ(4,"pdf-circuit-dashboard")),2&e&&(t.xp6(2),t.Q6J("ngForOf",t.l5B(8,Ht,t.DdM(4,yt),t.DdM(5,Yt),t.DdM(6,Bt),t.DdM(7,lt))),t.xp6(1),t.Q6J("tableHeader",n.tableHeader)("columnDetails",n.columnDetails)("tableData",n.tableData))},directives:[m.Asz,m.yKW,_.sg,m.DPz,m.fMN,J.V,vt],encapsulation:2}),s.\u0275prov=t.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();var et=d(4204),At=d(4107),Dt=d(3252);const nt=function(s){return{color:s}};function $t(s,c){if(1&s){const e=t.EpF();t.TgZ(0,"nb-list-item",34)(1,"span",35,36),t.NdJ("mouseover",function(){return t.CHM(e),t.MAs(2).style.color="#0492c2"})("mouseout",function(){const a=t.CHM(e).index;return t.MAs(2).style.color=t.oxw(2).selectionCircuit==a?"#0492c2":"black"})("click",function(){const a=t.CHM(e).index;return t.oxw(2).selectCircuit(a)}),t._uU(3),t.qZA()()}if(2&s){const e=c.$implicit,n=c.index,i=t.oxw(2);t.xp6(1),t.Q6J("ngStyle",t.VKq(2,nt,i.selectionCircuit==n?"#0492c2":"black")),t.xp6(2),t.hij(" ",e.piping_circuit_name," ")}}function Gt(s,c){if(1&s){const e=t.EpF();t.TgZ(0,"nb-list-item",34)(1,"span",35,37),t.NdJ("mouseover",function(){return t.CHM(e),t.MAs(2).style.color="#0492c2"})("mouseout",function(){const a=t.CHM(e).index;return t.MAs(2).style.color=t.oxw(2).selectionPipe==a?"#0492c2":"black"})("click",function(){const i=t.CHM(e),a=i.index,h=i.$implicit;return t.oxw(2).selectPipe(a,h)}),t._uU(3),t.qZA()()}if(2&s){const e=c.$implicit,n=c.index,i=t.oxw(2);t.xp6(1),t.Q6J("ngStyle",t.VKq(2,nt,i.selectionPipe==n?"#0492c2":"black")),t.xp6(2),t.hij(" ",e.piping_id," ")}}function Vt(s,c){if(1&s&&(t.TgZ(0,"nb-list-item",34)(1,"span",null,37),t._uU(3),t.qZA()()),2&s){const e=c.$implicit;t.xp6(3),t.hij(" ",null==e?null:e.piping_id," ")}}function Kt(s,c){if(1&s){const e=t.EpF();t.TgZ(0,"mat-option",38),t.NdJ("click",function(){const a=t.CHM(e).$implicit;return t.oxw(2).selectInspectionType(a)}),t._uU(1),t.qZA()}if(2&s){const e=c.$implicit;t.Q6J("value",e),t.xp6(1),t.hij(" ",e," ")}}function Xt(s,c){if(1&s){const e=t.EpF();t.TgZ(0,"nb-list-item",39)(1,"span",35,40),t.NdJ("mouseover",function(){return t.CHM(e),t.MAs(2).style.color="#0492c2"})("mouseout",function(){const a=t.CHM(e).index;return t.MAs(2).style.color=t.oxw(2).selectionMethod==a?"#0492c2":"black"})("click",function(){const a=t.CHM(e).index;return t.oxw(2).selectMethod(a)}),t._uU(3),t.qZA()()}if(2&s){const e=c.$implicit,n=c.index,i=t.oxw(2);t.xp6(1),t.Q6J("ngStyle",t.VKq(2,nt,i.selectionMethod==n?"#0492c2":"black")),t.xp6(2),t.hij(" ",null==e?null:e.name," ")}}function te(s,c){if(1&s){const e=t.EpF();t.TgZ(0,"nb-list-item",34)(1,"span",35,41),t.NdJ("mouseover",function(){return t.CHM(e),t.MAs(2).style.color="#0492c2"})("mouseout",function(){const a=t.CHM(e).index;return t.MAs(2).style.color=t.oxw(2).selectionTechnique==a?"#0492c2":"black"})("click",function(){const i=t.CHM(e),a=i.index,h=i.$implicit;return t.oxw(2).selectTechnique(a,h.name)}),t._uU(3),t.qZA()()}if(2&s){const e=c.$implicit,n=c.index,i=t.oxw(2);t.xp6(1),t.Q6J("ngStyle",t.VKq(2,nt,i.selectionTechnique==n?"#0492c2":"black")),t.xp6(2),t.hij(" ",null==e?null:e.name," ")}}function ee(s,c){if(1&s&&(t.TgZ(0,"span",47),t._uU(1),t.qZA()),2&s){const e=t.oxw().$implicit;t.xp6(1),t.hij(" + ",null==e?null:e.method," ")}}function ne(s,c){if(1&s&&(t.TgZ(0,"span",47),t._uU(1),t.qZA()),2&s){const e=t.oxw().$implicit;t.xp6(1),t.hij(" + ",null==e?null:e.technique," ")}}function ie(s,c){if(1&s){const e=t.EpF();t.TgZ(0,"nb-list-item",42)(1,"div",43)(2,"span",44),t.NdJ("click",function(){const a=t.CHM(e).index;return t.oxw(2).activationMethod(a)}),t.TgZ(3,"div",45)(4,"span"),t._uU(5),t.qZA(),t._UZ(6,"nb-icon",46),t.qZA()(),t.TgZ(7,"span",47),t._uU(8),t.qZA(),t.YNc(9,ee,2,1,"span",48),t.YNc(10,ne,2,1,"span",48),t.TgZ(11,"input",49),t.NdJ("ngModelChange",function(i){return t.CHM(e).$implicit.coverage=i}),t.qZA(),t.TgZ(12,"div",50)(13,"button",6),t.NdJ("click",function(){const a=t.CHM(e).index;return t.oxw(2).deleteMethod(a)}),t._UZ(14,"nb-icon",51),t.qZA()()()()}if(2&s){const e=c.$implicit,n=c.index;t.xp6(5),t.hij(" ",n+1," "),t.xp6(1),t.Q6J("icon",null!=e&&e.active?"radio-button-on-outline":"radio-button-off-outline")("status",null!=e&&e.active?"success":"basic"),t.xp6(2),t.hij(" ",null==e?null:e.type," "),t.xp6(1),t.Q6J("ngIf",null==e?null:e.method),t.xp6(1),t.Q6J("ngIf",null==e?null:e.technique),t.xp6(1),t.Q6J("ngModel",e.coverage)}}const it=function(){return["Instrusive","Non Instrusive"]};function ct(s,c){if(1&s){const e=t.EpF();t.TgZ(0,"div",1)(1,"nb-card",2)(2,"nb-card-header",3)(3,"h5",4),t._uU(4),t.qZA(),t.TgZ(5,"div",5)(6,"button",6),t.NdJ("click",function(){return t.CHM(e),t.oxw().closeDialog()}),t._UZ(7,"nb-icon",7),t.qZA()()(),t.TgZ(8,"nb-card-body")(9,"form",8,9),t.NdJ("ngSubmit",function(){t.CHM(e);const i=t.MAs(10);return t.oxw().closeDialog(i.value)}),t.TgZ(11,"h6"),t._uU(12,"IN"),t.qZA(),t.TgZ(13,"section")(14,"nb-card",10)(15,"nb-card-body",3)(16,"div",4)(17,"span",11),t._uU(18,"Circuit ID"),t.qZA(),t.TgZ(19,"nb-list"),t.YNc(20,$t,4,4,"nb-list-item",12),t.qZA()(),t.TgZ(21,"div",13)(22,"span",11),t._uU(23,"Piping ID"),t.qZA(),t.TgZ(24,"nb-list"),t.YNc(25,Gt,4,4,"nb-list-item",12),t.qZA()(),t.TgZ(26,"div",13)(27,"span",11),t._uU(28,"Choosen Pipe"),t.qZA(),t.TgZ(29,"nb-list"),t.YNc(30,Vt,4,1,"nb-list-item",12),t.qZA()()()(),t.TgZ(31,"div")(32,"div",14)(33,"div")(34,"label",15),t._uU(35,"Proposal ID"),t.qZA(),t._UZ(36,"input",16),t.qZA(),t.TgZ(37,"div")(38,"label",15),t._uU(39,"Inspection Planned Date"),t.qZA(),t._UZ(40,"input",17)(41,"nb-datepicker",null,18),t.qZA(),t.TgZ(43,"div")(44,"label",15),t._uU(45,"Recomendation Date"),t.qZA(),t._UZ(46,"input",19)(47,"nb-datepicker",null,20),t.qZA()(),t.TgZ(49,"div",4)(50,"label",21),t._uU(51,"Remarks"),t.qZA(),t._UZ(52,"textarea",22),t.qZA()()(),t.TgZ(53,"h6",23),t._uU(54,"Inspection Method"),t.qZA(),t.TgZ(55,"section",24)(56,"div",25)(57,"mat-form-field",26)(58,"mat-label"),t._uU(59,"Inspection Type"),t.qZA(),t.TgZ(60,"mat-select"),t.YNc(61,Kt,2,2,"mat-option",27),t.qZA()()(),t.TgZ(62,"div",28)(63,"nb-card")(64,"nb-card-body",3)(65,"div",29)(66,"span",11),t._uU(67,"Inspection Method"),t.qZA(),t.TgZ(68,"nb-list"),t.YNc(69,Xt,4,4,"nb-list-item",30),t.qZA()(),t.TgZ(70,"div",4)(71,"span",11),t._uU(72,"Inspection Technique"),t.qZA(),t.TgZ(73,"nb-list"),t.YNc(74,te,4,4,"nb-list-item",12),t.qZA()()()()(),t.TgZ(75,"div",28)(76,"nb-card",31)(77,"nb-list"),t.YNc(78,ie,15,7,"nb-list-item",32),t.qZA()()()(),t.TgZ(79,"button",33),t._uU(80,"Add Proposal"),t.qZA()()()()()}if(2&s){const e=t.MAs(42),n=t.MAs(48),i=t.oxw();t.xp6(4),t.Oqu(null==i.dialogData?null:i.dialogData.title),t.xp6(16),t.Q6J("ngForOf",i.circuitData),t.xp6(5),t.Q6J("ngForOf",null==i.circuitData[i.selectionCircuit]?null:i.circuitData[i.selectionCircuit].piping),t.xp6(5),t.Q6J("ngForOf",i.choosenPipe),t.xp6(6),t.Q6J("ngModel",null==i.dialogData||null==i.dialogData.data?null:i.dialogData.data.proposal_id),t.xp6(4),t.Q6J("nbDatepicker",e)("ngModel",null==i.dialogData||null==i.dialogData.data?null:i.dialogData.data.inspection_planned_date),t.xp6(6),t.Q6J("nbDatepicker",n),t.xp6(6),t.Q6J("ngModel",null==i.dialogData||null==i.dialogData.data?null:i.dialogData.data.remarks),t.xp6(9),t.Q6J("ngForOf",t.DdM(14,it)),t.xp6(8),t.Q6J("ngForOf",i.inspectionMethod),t.xp6(5),t.Q6J("ngForOf",null==i.inspectionMethod[i.selectionMethod]?null:i.inspectionMethod[i.selectionMethod].children),t.xp6(4),t.Q6J("ngForOf",i.inspectionMethodList),t.xp6(1),t.Q6J("disabled",!i.choosenPipe.length)}}let Tt=(()=>{class s{constructor(e,n,i){this.circuitService=e,this.toastr=n,this.dialog=i,this.selectionCircuit=0,this.selectionMethod=0,this.inspectionMethodList=[],this.choosenPipe=[],this.inspectionMethod=[{name:"Acoustic Emission",children:[{name:"Crack Detection"},{name:"Leak Detection"}]},{name:"Eddy Current",children:[{name:"ACFM"},{name:"Low Frequency"},{name:"Pulsed"},{name:"Remote Field"},{name:"Standard (flat coil)"}]},{name:"Magnetic",children:[{name:"Magnetic Fluorescent Inspection"},{name:"Magnetic Flux Leakage"},{name:"Magnetic Particle Inspection"}]},{name:"Metallurgical",children:[{name:"Hardness Surveys"},{name:"Microstructure Replication"}]},{name:"Monitoring",children:[{name:"On-line Monitoring"}]},{name:"Penetrant",children:[{name:"Liquid Penetrant Inspection"},{name:"Penetrant Leak Inspection"}]},{name:"Radiography",children:[{name:"Compton Scatter"},{name:"Gamma Radiography"},{name:"Real-time Radiography"},{name:"X-Radiography"}]},{name:"Thermography",children:[{name:"Passive Thermography"},{name:"Transient Thermography"}]},{name:"Ultrasonic",children:[{name:"Advanced Ultrasonic Backscatter Technique"},{name:"Angled Compression Wave"},{name:"Angled Shear Wave"},{name:"A-scan Thickness Survey"},{name:"B-Scan"},{name:"Chime"},{name:"C-Scan"},{name:"Digital Ultrasonic Thickness Gauge"},{name:"Internal Rotational Inspection System"},{name:"Lorus"},{name:"Surface Waves"},{name:"Teletest"},{name:"TOFD"}]},{name:"Visual",children:[{name:"Endoscopy"},{name:"Holiday Test"},{name:"Hydrotesting"},{name:"Naked Eye"},{name:"Video"}]}]}ngOnInit(){this.circuitService.getPipingCircuits().subscribe(({data:e})=>{this.circuitData=e})}selectCircuit(e){this.selectionPipe=null,this.selectionCircuit=e}selectPipe(e,n){this.selectionPipe=e,this.choosenPipe.includes(n)||this.choosenPipe.push(n)}selectMethod(e){if(!this.inspectionMethodList.length)return this.toastr.danger("Please input inspection type first.","Selection denied.");this.selectionTechnique=null,this.selectionMethod=e,this.inspectionMethodList[this.activeMethod].method=this.inspectionMethod[this.selectionMethod].name}selectTechnique(e,n){if(!this.inspectionMethodList.length)return this.toastr.danger("Please input inspection type first.","Selection denied.");this.selectionTechnique=e,this.inspectionMethodList[this.activeMethod].method=this.inspectionMethod[this.selectionMethod].name,this.inspectionMethodList[this.activeMethod].technique=n}selectInspectionType(e){this.inspectionMethodList=this.inspectionMethodList.map(n=>Object.assign(Object.assign({},n),{active:!1})),this.inspectionMethodList.push({type:e,active:!0,coverage:0}),this.activeMethod=this.inspectionMethodList.length-1}activationMethod(e){this.inspectionMethodList=this.inspectionMethodList.map(n=>Object.assign(Object.assign({},n),{active:!1})),this.inspectionMethodList[e].active=!0,this.activeMethod=e}deleteMethod(e){this.inspectionMethodList[e]=null,this.inspectionMethodList=this.inspectionMethodList.filter(n=>null!=n),e==this.inspectionMethodList.length&&this.activationMethod(e-1)}closeDialog(e=null){e||this.dialog.close(),e&&(e=Object.assign(Object.assign({},e),{list_of_piping_id:this.choosenPipe.map(n=>n.id),inspection_method:this.inspectionMethodList}),this.dialog.close(e))}}return s.\u0275fac=function(e){return new(e||s)(t.Y36(xt.t),t.Y36(m.quB),t.Y36(m.X4l))},s.\u0275cmp=t.Xpm({type:s,selectors:[["ngx-add-proposal"]],inputs:{dialogData:"dialogData"},decls:1,vars:1,consts:[["class","w-100 d-flex justify-content-center mt-5",4,"ngIf"],[1,"w-100","d-flex","justify-content-center","mt-5"],[1,"mt-5",2,"max-height","35rem","min-width","90rem"],[1,"d-flex"],[1,"w-100"],[1,"flex-shrink-1"],["nbButton","","status","danger","size","tiny",3,"click"],["icon","close-outline"],[3,"ngSubmit"],["proposalForm","ngForm"],[2,"max-height","15rem"],[1,"text-secondary"],["style","max-height: .7rem;",4,"ngFor","ngForOf"],[1,"w-100","ms-4"],[1,"d-flex","justify-content-evenly"],["for","dateInService",1,"mb-1","d-block"],["fullWidth","","nbInput","","fieldSize","small","name","proposal_id",3,"ngModel"],["fullWidth","","nbInput","","fieldSize","small","name","inspection_planned_date",3,"nbDatepicker","ngModel"],["inspection_planned_date",""],["fullWidth","","nbInput","","fieldSize","small","name","recomendation_date","ngModel","","disabled","true",3,"nbDatepicker"],["recomendation_date",""],["for","remarks",1,"d-block"],["nbInput","","name","remarks","id","remarks","rows","2","fullWidth","",3,"ngModel"],[1,"mt-5"],[1,"row"],[1,"col-12"],[1,"my-2"],[3,"value","click",4,"ngFor","ngForOf"],[1,"col-6","p-1"],[1,"w-50"],["style","max-height: .7rem; cursor: pointer;",4,"ngFor","ngForOf"],[2,"max-height","24rem"],["style","cursor: pointer;","class","w-100",4,"ngFor","ngForOf"],["nbButton","","status","success","size","small",1,"w-100",3,"disabled"],[2,"max-height",".7rem"],[2,"cursor","pointer",3,"ngStyle","mouseover","mouseout","click"],["circuitcell",""],["pipingcell",""],[3,"value","click"],[2,"max-height",".7rem","cursor","pointer"],["methodcell",""],["techniquecell",""],[1,"w-100",2,"cursor","pointer"],[1,"d-flex","justify-content-between","w-100","row"],[1,"col-1",3,"click"],[1,"d-flex","align-items-center"],[1,"align-self-center","ms-2",2,"font-size","20px",3,"icon","status"],[1,"col-2"],["class","col-2",4,"ngIf"],["type","number","nbInput","","min","0","max","100","name","coverage","fieldSize","tiny",1,"col-2",3,"ngModel","ngModelChange"],[1,"col-1","d-flex","justify-content-center","align-items-center"],["icon","trash-2-outline"]],template:function(e,n){1&e&&t.YNc(0,ct,81,15,"div",0),2&e&&t.Q6J("ngIf",n.circuitData)},directives:[_.O5,m.Asz,m.ndF,m.DPz,m.fMN,m.yKW,f._Y,f.JL,f.F,m.zP_,_.sg,m.qBV,_.PC,m.h8i,f.Fj,f.JJ,f.On,m.$kf,m.B4C,et.KE,et.hX,At.gD,Dt.ey,f.qQ,f.Fd,f.wV],encapsulation:2}),s})();const se=["pdfCircuit"];function oe(s,c){if(1&s&&(t.TgZ(0,"th")(1,"b",6),t._uU(2),t.qZA()()),2&s){const e=c.$implicit;t.xp6(2),t.Oqu(e.name)}}function ae(s,c){if(1&s&&(t.TgZ(0,"td"),t._uU(1),t.qZA()),2&s){const e=c.$implicit,n=t.oxw().$implicit;t.xp6(1),t.hij(" ",n[null==e?null:e.props]," ")}}function re(s,c){if(1&s&&(t.TgZ(0,"div")(1,"tr"),t.YNc(2,ae,2,1,"td",5),t.qZA(),t.TgZ(3,"tr")(4,"td",7)(5,"b",8),t._uU(6,"Remarks"),t.qZA()(),t.TgZ(7,"td",9),t._uU(8),t.qZA()()()),2&s){const e=c.$implicit,n=t.oxw();t.xp6(2),t.Q6J("ngForOf",n.assetsHead),t.xp6(6),t.hij(" ",e.remarks," ")}}const le=function(){return{"font-size":"10px"}};q().vfs=K.I.vfs;let Pt=(()=>{class s{constructor(){this.assetsHead=[{name:"Id",props:"proposal_id"},{name:"Insp Plan Date",props:"inspection_planned_date"},{name:"Piping Circuit / Assets",props:"list_circuit"}]}generateData(e){this.tableData=e,setTimeout(()=>{this.downloadAsPDF()},500)}downloadAsPDF(){q().tableLayouts={exampleLayout:{hLineWidth:function(a,h){return 0===a||a===h.table.body.length?0:a===h.table.headerRows?2:1},vLineWidth:function(a){return 0},hLineColor:function(a){return 1===a?"black":"#aaa"},paddingLeft:function(a){return 0===a?0:8},paddingRight:function(a,h){return a===h.table.widths.length-1?0:8}}};const e=this.pdfCircuit.nativeElement,i={content:[ot()(e.innerHTML),{pageBreak:"before",text:"Attachment\n",style:{bold:!0,fontSize:16,color:"#5588EE"},pageOrientation:"landscape"}],pageBreakBefore:function(a){return a.style&&a.style.indexOf("pdf-pagebreak-before")>-1}};q().createPdf(i).print()}}return s.\u0275fac=function(e){return new(e||s)},s.\u0275cmp=t.Xpm({type:s,selectors:[["pdf-proposal-dashboard"]],viewQuery:function(e,n){if(1&e&&t.Gf(se,5),2&e){let i;t.iGM(i=t.CRH())&&(n.pdfCircuit=i.first)}},decls:9,vars:5,consts:[[1,"container",2,"display","none"],["id","pdfTable"],["pdfCircuit",""],[2,"width","100%","margin","0 0 1rem 0","color","#5588EE"],["data-pdfmake","{'widths':[ '*', '*', '*' ], 'layout' : 'exampleLayout'}"],[4,"ngFor","ngForOf"],[2,"font-weight","bold"],["colspan","1"],[2,"color","darkcyan"],["colspan","2"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1,2)(3,"h5",3),t._uU(4," Proposals "),t.qZA(),t.TgZ(5,"table",4)(6,"tr"),t.YNc(7,oe,3,1,"th",5),t.qZA(),t.YNc(8,re,9,2,"div",5),t.qZA()()()),2&e&&(t.xp6(5),t.Akn(t.DdM(4,le)),t.xp6(2),t.Q6J("ngForOf",n.assetsHead),t.xp6(1),t.Q6J("ngForOf",n.tableData))},directives:[_.sg],encapsulation:2}),s})(),ce=(()=>{class s{constructor(e){this.httpClient=e,this.apiUrl=M.N.apiUrl}getProposals(){return this.httpClient.get(this.apiUrl+"/proposal")}addProposals(e){return this.httpClient.post(this.apiUrl+"/proposal",e)}updateProposal(e,n){return this.httpClient.put(this.apiUrl+"/proposal/"+n,e)}deleteProposal(e){return this.httpClient.delete(this.apiUrl+"/proposal/"+e)}}return s.\u0275fac=function(e){return new(e||s)(t.LFG(w.eN))},s.\u0275prov=t.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();function u(s,c){if(1&s){const e=t.EpF();t.TgZ(0,"button",2),t.NdJ("click",function(){const a=t.CHM(e).$implicit,h=t.oxw();return"New"==a.name?h.addProposal():"Print"==a.name?h.pdfProposals.generateData(h.tableData):null}),t._UZ(1,"nb-icon",3),t.TgZ(2,"span"),t._uU(3),t.qZA()()}if(2&s){const e=c.$implicit,n=t.oxw();let i;t.Q6J("disabled",!("Export"!=(null==e?null:e.name)&&"Print"!=(null==e?null:e.name)||null!=n.tableData&&n.tableData.length)),t.xp6(1),t.Q6J("icon",e.icon)("pack",null!==(i=e.pack)&&void 0!==i?i:"eva"),t.xp6(2),t.Oqu(e.name)}}const o=function(){return{name:"New",icon:"plus-outline"}},r=function(){return{name:"Print",icon:"printer-outline"}},l=function(s,c){return[s,c]},p=function(){return{title:"Proposal"}},x=[{path:"",component:L,children:[{path:"piping-assets",component:Et,data:{routename:"assets"}},{path:"piping-circuits",component:Ct,data:{routename:"circuit"}},{path:"view-proposal",component:(()=>{class s{constructor(e,n,i,a){this.proposalService=e,this.dialogService=n,this.datePipe=i,this.toastrService=a,this.tableData=[],this.columnDetails=[{type:"select",prop:"select",head:"",width:"20px"},{type:"text",prop:"proposal_id",head:"Proposal ID",width:"100px"},{type:"text",prop:"inspection_planned_date",head:"Inspection Plan Date",width:"200px"},{type:"text",prop:"list_circuit",head:"Piping Circuit / Assets",width:"200px"},{type:"text",prop:"remarks",head:"Remarks",width:"400px"},{type:"button",prop:"edit",width:"40px",button:[{icon:"edit-outline",status:"info",title:"update-proposal"},{icon:"trash-2-outline",status:"danger",title:"delete-proposal"}]}]}ngOnInit(){this.proposalService.getProposals().subscribe(({data:e})=>{this.tableData=e.map(n=>{const i=n.circuit.map(a=>[a.piping_circuit_id,...a.piping.map(({piping_id:h})=>" "+h)]);return Object.assign(Object.assign({},n),{list_circuit:[...i]})}),this.viewTable.regenerateTable(this.tableData)})}addProposal(){this.dialogService.open(Tt,{context:{dialogData:{title:"Add Proposal"}}}).onClose.subscribe(e=>{if(!e)return;const{inspection_planned_date:n,recomendation_date:i}=e;e=Object.assign(Object.assign({},e),{inspection_planned_date:this.datePipe.transform(n,"yyyy-MM-dd"),recomendation_date:this.datePipe.transform(i,"yyyy-MM-dd")}),this.proposalService.addProposals(e).subscribe(()=>this.ngOnInit(),()=>this.toastrService.danger("Please check your connection and try again.","Your request failed."),()=>this.toastrService.success("Data has been added.","Your request success."))})}onClickTable(e,n){"update-proposal"==n&&this.updateProposal(e),"delete-proposal"==n&&this.deleteProposal(e)}updateProposal(e){this.dialogService.open(Tt,{context:{dialogData:{title:"Add Proposal",data:Object.assign(Object.assign({},e),{inspection_planned_date:new Date(e.inspection_planned_date)})}}}).onClose.subscribe(n=>{if(!n)return;const{inspection_planned_date:i,recomendation_date:a}=n;n=Object.assign(Object.assign({},n),{inspection_planned_date:this.datePipe.transform(i,"yyyy-MM-dd"),recomendation_date:this.datePipe.transform(a,"yyyy-MM-dd")}),this.proposalService.updateProposal(n,e.id).subscribe(()=>this.ngOnInit(),()=>this.toastrService.danger("Please check your connection and try again.","Your request failed."),()=>this.toastrService.success("Data has been updated.","Your request success."))})}deleteProposal(e){this.dialogService.open(C.F,{context:{dialogData:{title:"Delete Assets",name:e.piping_name,id:e.id}}}).onClose.subscribe(n=>{n&&this.proposalService.deleteProposal(n.id).subscribe(()=>this.ngOnInit(),()=>this.toastrService.danger("Please check your connection and try again.","Your request failed."),()=>this.toastrService.success("Data has been delete.","Your request success."))})}}return s.\u0275fac=function(e){return new(e||s)(t.Y36(ce),t.Y36(m.Gln),t.Y36(_.uU),t.Y36(m.quB))},s.\u0275cmp=t.Xpm({type:s,selectors:[["ngx-view-proposal"]],viewQuery:function(e,n){if(1&e&&(t.Gf(J.V,5),t.Gf(Pt,5)),2&e){let i;t.iGM(i=t.CRH())&&(n.viewTable=i.first),t.iGM(i=t.CRH())&&(n.pdfProposals=i.first)}},decls:5,vars:10,consts:[["nbButton","","outline","","size","small","status","primary","class","m-2",3,"disabled","click",4,"ngFor","ngForOf"],[3,"tableHeader","columnDetails","tableData","onClickTable"],["nbButton","","outline","","size","small","status","primary",1,"m-2",3,"disabled","click"],[1,"m-1",3,"icon","pack"]],template:function(e,n){1&e&&(t.TgZ(0,"nb-card")(1,"nb-card-body"),t.YNc(2,u,4,4,"button",0),t.qZA()(),t.TgZ(3,"ngx-mat-table",1),t.NdJ("onClickTable",function(a){return n.onClickTable(a.data,a.title)}),t.qZA(),t._UZ(4,"pdf-proposal-dashboard")),2&e&&(t.xp6(2),t.Q6J("ngForOf",t.WLB(6,l,t.DdM(4,o),t.DdM(5,r))),t.xp6(1),t.Q6J("tableHeader",t.DdM(9,p))("columnDetails",n.columnDetails)("tableData",n.tableData))},directives:[m.Asz,m.yKW,_.sg,m.DPz,m.fMN,J.V,Pt],encapsulation:2}),s.\u0275prov=t.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),data:{routename:"proposal"}}]}];let b=(()=>{class s{}return s.\u0275fac=function(e){return new(e||s)},s.\u0275mod=t.oAB({type:s}),s.\u0275inj=t.cJS({imports:[[N.Bz.forChild(x)],N.Bz]}),s})();var P=d(2356),D=d(9511),S=d(2368),G=d(8279),he=d(7446),me=d(5331),ge=d(7531),fe=d(8246);let be=(()=>{class s{}return s.\u0275fac=function(e){return new(e||s)},s.\u0275mod=t.oAB({type:s}),s.\u0275inj=t.cJS({imports:[[_.ez,I.O,m.j7H.forChild({closeOnBackdropClick:!0}),m.zyh,m.KdK,m.T2N]]}),s})(),_e=(()=>{class s{}return s.\u0275fac=function(e){return new(e||s)},s.\u0275mod=t.oAB({type:s}),s.\u0275inj=t.cJS({imports:[[_.ez,I.O,m.j5J,m.zyh,m.x4g,m.IIj,m.oGl,m.nKr,m.OA,m.T2N,m.KdK,m.COg,m.KdK,m.LW9.forRoot({destroyByClick:!0,duration:3e3,position:m.fe3.BOTTOM_RIGHT,preventDuplicates:!0,limit:3}),m.uuI,fe.F5,f.u5,b,P.Z,D.H,S.rP,G.p0,he.p9,me.TU,et.lN,ge.c,At.LD,be]]}),s})()},2787:(H,k,d)=>{"use strict";d.d(k,{t:()=>N});var _=d(2340),I=d(5e3),m=d(520);let N=(()=>{class t{constructor(C){this.httpClient=C,this.apiUrl=_.N.apiUrl}getPipingCircuits(){return this.httpClient.get(this.apiUrl+"/circuit")}addPipingCircuits(C){return this.httpClient.post(this.apiUrl+"/circuit",C)}updatePipingCircuits(C){return this.httpClient.put(this.apiUrl+"/circuit/"+C.id,C)}deletePipingCircuits(C){return this.httpClient.delete(this.apiUrl+"/circuit/"+C)}importCircuits(C){return this.httpClient.post(this.apiUrl+"/import_circuits",C)}}return t.\u0275fac=function(C){return new(C||t)(I.LFG(m.eN))},t.\u0275prov=I.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},9441:function(H,k){var I;void 0!==(I=function(){"use strict";function N(y,f,E){var A=new XMLHttpRequest;A.open("GET",y),A.responseType="blob",A.onload=function(){w(A.response,f,E)},A.onerror=function(){console.error("could not download file")},A.send()}function t(y){var f=new XMLHttpRequest;f.open("HEAD",y,!1);try{f.send()}catch(E){}return 200<=f.status&&299>=f.status}function L(y){try{y.dispatchEvent(new MouseEvent("click"))}catch(E){var f=document.createEvent("MouseEvents");f.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),y.dispatchEvent(f)}}var C="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof global&&global.global===global?global:void 0,M=C.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),w=C.saveAs||("object"!=typeof window||window!==C?function(){}:"download"in HTMLAnchorElement.prototype&&!M?function(y,f,E){var A=C.URL||C.webkitURL,Z=document.createElement("a");Z.download=f=f||y.name||"download",Z.rel="noopener","string"==typeof y?(Z.href=y,Z.origin===location.origin?L(Z):t(Z.href)?N(y,f,E):L(Z,Z.target="_blank")):(Z.href=A.createObjectURL(y),setTimeout(function(){A.revokeObjectURL(Z.href)},4e4),setTimeout(function(){L(Z)},0))}:"msSaveOrOpenBlob"in navigator?function(y,f,E){if(f=f||y.name||"download","string"!=typeof y)navigator.msSaveOrOpenBlob(function m(y,f){return void 0===f?f={autoBom:!1}:"object"!=typeof f&&(console.warn("Deprecated: Expected third argument to be a object"),f={autoBom:!f}),f.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(y.type)?new Blob(["\ufeff",y],{type:y.type}):y}(y,E),f);else if(t(y))N(y,f,E);else{var A=document.createElement("a");A.href=y,A.target="_blank",setTimeout(function(){L(A)})}}:function(y,f,E,A){if((A=A||open("","_blank"))&&(A.document.title=A.document.body.innerText="downloading..."),"string"==typeof y)return N(y,f,E);var Z="application/octet-stream"===y.type,V=/constructor/i.test(C.HTMLElement)||C.safari,$=/CriOS\/[\d]+/.test(navigator.userAgent);if(($||Z&&V||M)&&"undefined"!=typeof FileReader){var R=new FileReader;R.onloadend=function(){var Y=R.result;Y=$?Y:Y.replace(/^data:[^;]*;/,"data:attachment/file;"),A?A.location.href=Y:location=Y,A=null},R.readAsDataURL(y)}else{var J=C.URL||C.webkitURL,Q=J.createObjectURL(y);A?A.location=Q:location.href=Q,A=null,setTimeout(function(){J.revokeObjectURL(Q)},4e4)}});C.saveAs=w.saveAs=w,H.exports=w}.apply(k,[]))&&(H.exports=I)},2231:(H,k,d)=>{"use strict";Object.defineProperty(k,"__esModule",{value:!0});var _=d(2403);_.Observable.forkJoin=_.forkJoin},2403:(H,k,d)=>{"use strict";d.r(k),d.d(k,{ArgumentOutOfRangeError:()=>Mt.W,AsyncSubject:()=>Z.c,BehaviorSubject:()=>E.X,ConnectableObservable:()=>I.c,EMPTY:()=>W.E,EmptyError:()=>St.K,GroupedObservable:()=>M,NEVER:()=>yt,Notification:()=>pt.P,NotificationKind:()=>pt.W,ObjectUnsubscribedError:()=>Ft.N,Observable:()=>_.y,ReplaySubject:()=>A.t,Scheduler:()=>ut.b,Subject:()=>f.xQ,Subscriber:()=>Zt.L,Subscription:()=>m.w,TimeoutError:()=>ht,UnsubscriptionError:()=>wt.B,VirtualAction:()=>O,VirtualTimeScheduler:()=>dt,animationFrame:()=>J.r,animationFrameScheduler:()=>J.Z,asap:()=>V.e,asapScheduler:()=>V.E,async:()=>$.P,asyncScheduler:()=>$.z,bindCallback:()=>mt,bindNodeCallback:()=>gt,combineLatest:()=>Ot.aj,concat:()=>Nt.z,config:()=>ce.v,defer:()=>bt.P,empty:()=>W.c,forkJoin:()=>jt.D,from:()=>tt.D,fromEvent:()=>Jt.R,fromEventPattern:()=>_t,generate:()=>Lt,identity:()=>st.y,iif:()=>vt,interval:()=>xt.F,isObservable:()=>ot.b,merge:()=>Rt.T,never:()=>Yt,noop:()=>K.Z,observable:()=>y.L,of:()=>Bt.of,onErrorResumeNext:()=>lt,pairs:()=>Ht,partition:()=>At,pipe:()=>q.z,queue:()=>R.c,queueScheduler:()=>R.N,race:()=>Gt,range:()=>Xt,scheduled:()=>Pt.x,throwError:()=>ee._,timer:()=>ne.H,using:()=>ie,zip:()=>Tt});var _=d(4202),I=d(1762),m=d(4096);class M extends _.y{constructor(o,r,l){super(),this.key=o,this.groupSubject=r,this.refCountSubscription=l}_subscribe(o){const r=new m.w,{refCountSubscription:l,groupSubject:p}=this;return l&&!l.closed&&r.add(new w(l)),r.add(p.subscribe(o)),r}}class w extends m.w{constructor(o){super(),this.parent=o,o.count++}unsubscribe(){const o=this.parent;!o.closed&&!this.closed&&(super.unsubscribe(),o.count-=1,0===o.count&&o.attemptedToUnsubscribe&&o.unsubscribe())}}var y=d(3821),f=d(8929),E=d(591),A=d(2247),Z=d(2185),V=d(8139),$=d(353),R=d(341),J=d(352),Q=d(6686),Y=d(198);let dt=(()=>{class u extends Y.v{constructor(r=O,l=Number.POSITIVE_INFINITY){super(r,()=>this.frame),this.maxFrames=l,this.frame=0,this.index=-1}flush(){const{actions:r,maxFrames:l}=this;let p,g;for(;(g=r[0])&&g.delay<=l&&(r.shift(),this.frame=g.delay,!(p=g.execute(g.state,g.delay))););if(p){for(;g=r.shift();)g.unsubscribe();throw p}}}return u.frameTimeFactor=10,u})();class O extends Q.o{constructor(o,r,l=(o.index+=1)){super(o,r),this.scheduler=o,this.work=r,this.index=l,this.active=!0,this.index=o.index=l}schedule(o,r=0){if(!this.id)return super.schedule(o,r);this.active=!1;const l=new O(this.scheduler,this.work);return this.add(l),l.schedule(o,r)}requestAsyncId(o,r,l=0){this.delay=o.frame+l;const{actions:p}=o;return p.push(this),p.sort(O.sortActions),!0}recycleAsyncId(o,r,l=0){}_execute(o,r){if(!0===this.active)return super._execute(o,r)}static sortActions(o,r){return o.delay===r.delay?o.index===r.index?0:o.index>r.index?1:-1:o.delay>r.delay?1:-1}}var ut=d(2221),Zt=d(3489),pt=d(9312),q=d(4843),K=d(7876),st=d(5379),ot=d(4715),Mt=d(4231),St=d(4450),Ft=d(5279),wt=d(7964);const ht=(()=>{function u(){return Error.call(this),this.message="Timeout has occurred",this.name="TimeoutError",this}return u.prototype=Object.create(Error.prototype),u})();var X=d(4850),at=d(9476),z=d(6688),rt=d(2866);function mt(u,o,r){if(o){if(!(0,rt.K)(o))return(...l)=>mt(u,r)(...l).pipe((0,X.U)(p=>(0,z.k)(p)?o(...p):o(p)));r=o}return function(...l){const p=this;let g;const x={context:p,subject:g,callbackFunc:u,scheduler:r};return new _.y(b=>{if(r)return r.schedule(Ut,0,{args:l,subscriber:b,params:x});if(!g){g=new Z.c;const P=(...D)=>{g.next(D.length<=1?D[0]:D),g.complete()};try{u.apply(p,[...l,P])}catch(D){(0,at._)(g)?g.error(D):console.warn(D)}}return g.subscribe(b)})}}function Ut(u){const{args:r,subscriber:l,params:p}=u,{callbackFunc:g,context:x,scheduler:b}=p;let{subject:P}=p;if(!P){P=p.subject=new Z.c;const D=(...S)=>{this.add(b.schedule(kt,0,{value:S.length<=1?S[0]:S,subject:P}))};try{g.apply(x,[...r,D])}catch(S){P.error(S)}}this.add(P.subscribe(l))}function kt(u){const{value:o,subject:r}=u;r.next(o),r.complete()}function gt(u,o,r){if(o){if(!(0,rt.K)(o))return(...l)=>gt(u,r)(...l).pipe((0,X.U)(p=>(0,z.k)(p)?o(...p):o(p)));r=o}return function(...l){const p={subject:void 0,args:l,callbackFunc:u,scheduler:r,context:this};return new _.y(g=>{const{context:x}=p;let{subject:b}=p;if(r)return r.schedule(It,0,{params:p,subscriber:g,context:x});if(!b){b=p.subject=new Z.c;const P=(...D)=>{const S=D.shift();S?b.error(S):(b.next(D.length<=1?D[0]:D),b.complete())};try{u.apply(x,[...l,P])}catch(D){(0,at._)(b)?b.error(D):console.warn(D)}}return b.subscribe(g)})}}function It(u){const{params:o,subscriber:r,context:l}=u,{callbackFunc:p,args:g,scheduler:x}=o;let b=o.subject;if(!b){b=o.subject=new Z.c;const P=(...D)=>{const S=D.shift();this.add(S?x.schedule(ft,0,{err:S,subject:b}):x.schedule(Et,0,{value:D.length<=1?D[0]:D,subject:b}))};try{p.apply(l,[...g,P])}catch(D){this.add(x.schedule(ft,0,{err:D,subject:b}))}}this.add(b.subscribe(r))}function Et(u){const{value:o,subject:r}=u;r.next(o),r.complete()}function ft(u){const{err:o,subject:r}=u;r.error(o)}var Ot=d(6053),Nt=d(1221),bt=d(8514),W=d(8896),jt=d(567),tt=d(3527),Jt=d(3753),qt=d(7043);function _t(u,o,r){return r?_t(u,o).pipe((0,X.U)(l=>(0,z.k)(l)?r(...l):r(l))):new _.y(l=>{const p=(...x)=>l.next(1===x.length?x[0]:x);let g;try{g=u(p)}catch(x){return void l.error(x)}if((0,qt.m)(o))return()=>o(p,g)})}function Lt(u,o,r,l,p){let g,x;return 1==arguments.length?(x=u.initialState,o=u.condition,r=u.iterate,g=u.resultSelector||st.y,p=u.scheduler):void 0===l||(0,rt.K)(l)?(x=u,g=st.y,p=l):(x=u,g=l),new _.y(b=>{let P=x;if(p)return p.schedule(Qt,0,{subscriber:b,iterate:r,condition:o,resultSelector:g,state:P});for(;;){if(o){let S;try{S=o(P)}catch(G){return void b.error(G)}if(!S){b.complete();break}}let D;try{D=g(P)}catch(S){return void b.error(S)}if(b.next(D),b.closed)break;try{P=r(P)}catch(S){return void b.error(S)}}})}function Qt(u){const{subscriber:o,condition:r}=u;if(o.closed)return;if(u.needIterate)try{u.state=u.iterate(u.state)}catch(p){return void o.error(p)}else u.needIterate=!0;if(r){let p;try{p=r(u.state)}catch(g){return void o.error(g)}if(!p)return void o.complete();if(o.closed)return}let l;try{l=u.resultSelector(u.state)}catch(p){return void o.error(p)}return o.closed||(o.next(l),o.closed)?void 0:this.schedule(u)}function vt(u,o=W.E,r=W.E){return(0,bt.P)(()=>u()?o:r)}var xt=d(1715),Rt=d(6787);const yt=new _.y(K.Z);function Yt(){return yt}var Bt=d(1086);function lt(...u){if(0===u.length)return W.E;const[o,...r]=u;return 1===u.length&&(0,z.k)(o)?lt(...o):new _.y(l=>{const p=()=>l.add(lt(...r).subscribe(l));return(0,tt.D)(o).subscribe({next(g){l.next(g)},error:p,complete:p})})}function Ht(u,o){return new _.y(o?r=>{const l=Object.keys(u),p=new m.w;return p.add(o.schedule(zt,0,{keys:l,index:0,subscriber:r,subscription:p,obj:u})),p}:r=>{const l=Object.keys(u);for(let p=0;p<l.length&&!r.closed;p++){const g=l[p];u.hasOwnProperty(g)&&r.next([g,u[g]])}r.complete()})}function zt(u){const{keys:o,index:r,subscriber:l,subscription:p,obj:g}=u;if(!l.closed)if(r<o.length){const x=o[r];l.next([x,g[x]]),p.add(this.schedule({keys:o,index:r+1,subscriber:l,subscription:p,obj:g}))}else l.complete()}function Wt(u,o){function r(){return!r.pred.apply(r.thisArg,arguments)}return r.pred=u,r.thisArg=o,r}var Ct=d(9249),et=d(2198);function At(u,o,r){return[(0,et.h)(o,r)(new _.y((0,Ct.s)(u))),(0,et.h)(Wt(o,r))(new _.y((0,Ct.s)(u)))]}var Dt=d(3009),nt=d(826),$t=d(448);function Gt(...u){if(1===u.length){if(!(0,z.k)(u[0]))return u[0];u=u[0]}return(0,Dt.n)(u,void 0).lift(new Vt)}class Vt{call(o,r){return r.subscribe(new Kt(o))}}class Kt extends nt.L{constructor(o){super(o),this.hasFirst=!1,this.observables=[],this.subscriptions=[]}_next(o){this.observables.push(o)}_complete(){const o=this.observables,r=o.length;if(0===r)this.destination.complete();else{for(let l=0;l<r&&!this.hasFirst;l++){const g=(0,$t.D)(this,o[l],void 0,l);this.subscriptions&&this.subscriptions.push(g),this.add(g)}this.observables=null}}notifyNext(o,r,l){if(!this.hasFirst){this.hasFirst=!0;for(let p=0;p<this.subscriptions.length;p++)if(p!==l){let g=this.subscriptions[p];g.unsubscribe(),this.remove(g)}this.subscriptions=null}this.destination.next(r)}}function Xt(u=0,o,r){return new _.y(l=>{void 0===o&&(o=u,u=0);let p=0,g=u;if(r)return r.schedule(te,0,{index:p,count:o,start:u,subscriber:l});for(;;){if(p++>=o){l.complete();break}if(l.next(g++),l.closed)break}})}function te(u){const{start:o,index:r,count:l,subscriber:p}=u;r>=l?p.complete():(p.next(o),!p.closed&&(u.index=r+1,u.start=o+1,this.schedule(u)))}var ee=d(1737),ne=d(8723);function ie(u,o){return new _.y(r=>{let l,p;try{l=u()}catch(b){return void r.error(b)}try{p=o(l)}catch(b){return void r.error(b)}const x=(p?(0,tt.D)(p):W.E).subscribe(r);return()=>{x.unsubscribe(),l&&l.unsubscribe()}})}var it=d(5430),ct=d(1177);function Tt(...u){const o=u[u.length-1];return"function"==typeof o&&u.pop(),(0,Dt.n)(u,void 0).lift(new se(o))}class se{constructor(o){this.resultSelector=o}call(o,r){return r.subscribe(new oe(o,this.resultSelector))}}class oe extends Zt.L{constructor(o,r,l=Object.create(null)){super(o),this.resultSelector=r,this.iterators=[],this.active=0,this.resultSelector="function"==typeof r?r:void 0}_next(o){const r=this.iterators;(0,z.k)(o)?r.push(new re(o)):r.push("function"==typeof o[it.hZ]?new ae(o[it.hZ]()):new le(this.destination,this,o))}_complete(){const o=this.iterators,r=o.length;if(this.unsubscribe(),0!==r){this.active=r;for(let l=0;l<r;l++){let p=o[l];p.stillUnsubscribed?this.destination.add(p.subscribe()):this.active--}}else this.destination.complete()}notifyInactive(){this.active--,0===this.active&&this.destination.complete()}checkIterators(){const o=this.iterators,r=o.length,l=this.destination;for(let x=0;x<r;x++){let b=o[x];if("function"==typeof b.hasValue&&!b.hasValue())return}let p=!1;const g=[];for(let x=0;x<r;x++){let b=o[x],P=b.next();if(b.hasCompleted()&&(p=!0),P.done)return void l.complete();g.push(P.value)}this.resultSelector?this._tryresultSelector(g):l.next(g),p&&l.complete()}_tryresultSelector(o){let r;try{r=this.resultSelector.apply(this,o)}catch(l){return void this.destination.error(l)}this.destination.next(r)}}class ae{constructor(o){this.iterator=o,this.nextResult=o.next()}hasValue(){return!0}next(){const o=this.nextResult;return this.nextResult=this.iterator.next(),o}hasCompleted(){const o=this.nextResult;return Boolean(o&&o.done)}}class re{constructor(o){this.array=o,this.index=0,this.length=0,this.length=o.length}[it.hZ](){return this}next(o){const r=this.index++;return r<this.length?{value:this.array[r],done:!1}:{value:null,done:!0}}hasValue(){return this.array.length>this.index}hasCompleted(){return this.array.length===this.index}}class le extends ct.Ds{constructor(o,r,l){super(o),this.parent=r,this.observable=l,this.stillUnsubscribed=!0,this.buffer=[],this.isComplete=!1}[it.hZ](){return this}next(){const o=this.buffer;return 0===o.length&&this.isComplete?{value:null,done:!0}:{value:o.shift(),done:!1}}hasValue(){return this.buffer.length>0}hasCompleted(){return 0===this.buffer.length&&this.isComplete}notifyComplete(){this.buffer.length>0?(this.isComplete=!0,this.parent.notifyInactive()):this.destination.complete()}notifyNext(o){this.buffer.push(o),this.parent.checkIterators()}subscribe(){return(0,ct.ft)(this.observable,new ct.IY(this))}}var Pt=d(3998),ce=d(2830)},2185:(H,k,d)=>{"use strict";d.d(k,{c:()=>m});var _=d(8929),I=d(4096);class m extends _.xQ{constructor(){super(...arguments),this.value=null,this.hasNext=!1,this.hasCompleted=!1}_subscribe(t){return this.hasError?(t.error(this.thrownError),I.w.EMPTY):this.hasCompleted&&this.hasNext?(t.next(this.value),t.complete(),I.w.EMPTY):super._subscribe(t)}next(t){this.hasCompleted||(this.value=t,this.hasNext=!0)}error(t){this.hasCompleted||super.error(t)}complete(){this.hasCompleted=!0,this.hasNext&&super.next(this.value),super.complete()}}},7456:(H,k,d)=>{"use strict";d(2231)}}]);