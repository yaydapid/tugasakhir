(self.webpackChunkngx_admin_demo=self.webpackChunkngx_admin_demo||[]).push([[346],{1346:(B,U,d)=>{"use strict";d.r(U),d.d(U,{DashboardModule:()=>ge});var _=d(9808),w=d(4738),m=d(3254),I=d(2497),t=d(5e3);let L=(()=>{class i{constructor(){}ngOnInit(){}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=t.Xpm({type:i,selectors:[["ngx-dashboard"]],decls:1,vars:0,template:function(e,n){1&e&&t._UZ(0,"router-outlet")},directives:[I.lC],encapsulation:2}),i})();var C=d(3872),S=d(2340),F=d(520);let y=(()=>{class i{constructor(e){this.httpClient=e,this.apiUrl=S.N.apiUrl}addImage(e){return this.httpClient.post(this.apiUrl+"/image",e)}showImage(e){return this.httpClient.get(this.apiUrl+"/image/"+e)}addDocument(e){return this.httpClient.post(this.apiUrl+"/document",e,{reportProgress:!0,observe:"events"})}showDocument(e){return this.httpClient.get(this.apiUrl+"/document/"+e)}}return i.\u0275fac=function(e){return new(e||i)(t.LFG(F.eN))},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();var g=d(3075);function k(i,c){if(1&i&&(t.TgZ(0,"div",41)(1,"label",42),t._uU(2),t.qZA(),t._UZ(3,"input",43),t.TgZ(4,"span",44),t._uU(5),t.qZA()()),2&i){const e=c.$implicit,n=t.oxw();t.xp6(1),t.Q6J("for",e.id),t.xp6(1),t.Oqu(e.name),t.xp6(1),t.Q6J("id",e.id)("name",e.id)("ngModel",null==n.dialogData||null==n.dialogData.data?null:n.dialogData.data[e.id]),t.xp6(2),t.hij(" ",null==e?null:e.unit," ")}}function A(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"div",45)(1,"div",46)(2,"img",47),t.NdJ("click",function(){return t.CHM(e),t.oxw(),t.MAs(22).click()}),t.qZA()()()}if(2&i){const e=c.$implicit;t.Q6J("ngClass",0==c.index?"active":""),t.xp6(2),t.Q6J("src",e.src,t.LSH)("alt",null==e?null:e.alt)}}function P(i,c){if(1&i&&(t.TgZ(0,"nb-option",48),t._uU(1),t.qZA()),2&i){const e=c.$implicit;t.Q6J("value",e),t.xp6(1),t.Oqu(e)}}const V=function(i){return{display:i}},W=function(){return[1,2,3,4]};let R=(()=>{class i{constructor(e,n,o){this.dialog=e,this.pageMenuService=n,this.toastr=o,this.spesificationItem=[{id:"piping_id",name:"Piping Id"},{id:"piping_name",name:"Piping Name",unbit:"mm"},{id:"nominal_pipe_size",name:"Nominal Pipe Size"},{id:"pipe_design_code",name:"Pipe Design Code"},{id:"schedule",name:"Schedule"},{id:"outside_diameter",name:"Outside Diameter",unit:"mm"},{id:"longtd_quality_factor",name:"Longtd. Quality Factor (E)"},{id:"weld_joint_factor",name:"Weld Joint Factor (W)"},{id:"allowable_unit_stress",name:"Allowable Unit Stress (S)",unit:"psi"},{id:"coefficient",name:"Coefficient (Y)"},{id:"min_design_pressure",name:"Min. Design Pressure (P min)",unit:"psig"},{id:"max_design_pressure",name:"Max. Design Pressure (P max)",unit:"psig"},{id:"min_design_temperature",name:"Min. Design Temperature (T min)",unit:"F"},{id:"max_design_temperature",name:"Max Design Temperature (T max)",unit:"F"},{id:"corrosion_allowance",name:"Corrosion Allowance",unit:"mm"},{id:"mechanical_allowance",name:"Mechanical Allowances",unit:"mm"},{id:"min_structural_thickness",name:"Min. Structural Thickness",unit:"mm"},{id:"min_alert_thickness",name:"Min. Alert Thickness",unit:"mm"},{id:"nominal_thickness",name:"Nominal Thickness",unit:"mm"}],this.imageLink=[],this.loading=null}ngOnInit(){var e,n;const o=null===(n=null===(e=this.dialogData)||void 0===e?void 0:e.data)||void 0===n?void 0:n.images;o&&(this.imageLink=null==o?void 0:o.map(r=>({src:S.N.apiUrl+"/image/"+r,alt:"Piping Assets"})))}parseToInt(e){return parseInt(e)}onFileChange(e){const n=e.target.files;this.uploadImageFile=n;for(let r of n){var o=new FileReader;o.readAsDataURL(r),o.onload=h=>{this.imageLink.push({src:h.target.result,alt:r.name})}}}onUploadAttachment(e){const n=e.target.files[0],o=new FormData;o.append("document",n),this.pageMenuService.addDocument(o).subscribe(r=>{if(r.type===F.dt.UploadProgress)this.loading=100*Math.round(r.loaded/r.total);else if(r.type===F.dt.Response){const h=r,{id:x}=h.body.data;this.attachment=x,this.loading=null,this.toastr.success("Your File has been uploaded.","Success upload file.")}})}closeDialog(e=null){e||this.dialog.close(),e&&(e=Object.assign(Object.assign({},e),{image:this.uploadImageFile,attachment:this.attachment}),console.log(this.attachment),this.dialog.close(e))}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(m.X4l),t.Y36(y),t.Y36(m.quB))},i.\u0275cmp=t.Xpm({type:i,selectors:[["ngx-add-assets"]],inputs:{dialogData:"dialogData"},decls:58,vars:18,consts:[[1,"w-100","d-flex","justify-content-center","mt-5"],["nbSpinnerStatus","success",1,"mt-5",2,"max-height","35rem","min-width","90rem",3,"nbSpinner","nbSpinnerMessage"],[1,"d-flex"],[1,"w-100"],[1,"flex-shrink-1"],["nbButton","","status","danger","size","tiny",3,"click"],["icon","close-outline"],[3,"ngSubmit"],["addAssetsForm","ngForm"],[1,"row"],[1,"col-8"],[1,"row","row-cols-3"],["class","col mb-2",4,"ngFor","ngForOf"],[1,"col-4"],["id","carouselExampleInterval","data-bs-ride","carousel",1,"carousel","slide"],[1,"carousel-inner"],["class","carousel-item","data-bs-interval","10000",3,"ngClass",4,"ngFor","ngForOf"],["for","addImage"],["placeholder","Add image","multiple","","fullWidth","","nbInput","","type","file","accept","image/png, image/gif, image/jpeg","id","addImage",2,"display","none",3,"ngStyle","change"],["addImage",""],["type","button","data-bs-target","#carouselExampleInterval","data-bs-slide","prev",1,"carousel-control-prev"],["aria-hidden","true",1,"carousel-control-prev-icon"],[1,"visually-hidden"],["type","button","data-bs-target","#carouselExampleInterval","data-bs-slide","next",1,"carousel-control-next"],["aria-hidden","true",1,"carousel-control-next-icon"],[1,"row","row-cols-2"],["for","dateInService",1,"mb-1","d-block"],["fullWidth","","nbInput","","fieldSize","small","name","date_in_service","required","",3,"nbDatepicker","ngModel"],["datepicker",""],["for","class",1,"mb-1","d-block"],["placeholder","Class","size","small","status","primary","name","class",1,"",3,"ngModel"],[3,"value",4,"ngFor","ngForOf"],["for","notes",1,"mb-1","d-block"],["fullWidth","","nbInput","","fieldSize","small","type","text","id","notes","name","notes",3,"ngModel"],["for","addAttach",1,"d-block","mb-1"],["fullWidth","","fieldSize","tiny","nbInput","","type","file","id","addAttach","accept","application/pdf","id","addAttachment","name","attachment",3,"ngModel","change"],["addAttach",""],["for","recomendation",1,"d-block","mb-1"],["fullWidth","","nbInput","","name","recomendation","id","recomendation","rows","2",3,"ngModel"],[1,"d-flex","justify-content-center"],["nbButton","","status","success","type","submit",1,"m-1","w-100",3,"disabled"],[1,"col","mb-2"],[1,"d-block",2,"font-size",".9rem",3,"for"],["fieldSize","small","required","","nbInput","","type","text",1,"col-8",3,"id","name","ngModel"],[1,"col"],["data-bs-interval","10000",1,"carousel-item",3,"ngClass"],[1,"overflow-hidden","d-flex","align-justify-center",2,"height","13rem"],[1,"w-100",3,"src","alt","click"],[3,"value"]],template:function(e,n){if(1&e){const o=t.EpF();t.TgZ(0,"div",0)(1,"nb-card",1)(2,"nb-card-header",2)(3,"h5",3),t._uU(4),t.qZA(),t.TgZ(5,"div",4)(6,"button",5),t.NdJ("click",function(){return n.closeDialog()}),t._UZ(7,"nb-icon",6),t.qZA()()(),t.TgZ(8,"nb-card-body")(9,"form",7,8),t.NdJ("ngSubmit",function(){t.CHM(o);const h=t.MAs(10);return n.closeDialog(h.value)}),t.TgZ(11,"div",9)(12,"div",10)(13,"div",11),t.YNc(14,k,6,6,"div",12),t.qZA()(),t.TgZ(15,"div",13)(16,"div",14)(17,"div",15),t.YNc(18,A,3,3,"div",16),t.TgZ(19,"label",17),t._uU(20,"Image"),t.qZA(),t.TgZ(21,"input",18,19),t.NdJ("change",function(h){return n.onFileChange(h)}),t.qZA()(),t.TgZ(23,"button",20),t._UZ(24,"span",21),t.TgZ(25,"span",22),t._uU(26,"Previous"),t.qZA()(),t.TgZ(27,"button",23),t._UZ(28,"span",24),t.TgZ(29,"span",22),t._uU(30,"Next"),t.qZA()()(),t.TgZ(31,"div",25)(32,"div")(33,"label",26),t._uU(34,"Date In Service"),t.qZA(),t._UZ(35,"input",27)(36,"nb-datepicker",null,28),t.qZA(),t.TgZ(38,"div")(39,"label",29),t._uU(40,"Class"),t.qZA(),t.TgZ(41,"nb-select",30),t.YNc(42,P,2,2,"nb-option",31),t.qZA()(),t.TgZ(43,"div")(44,"label",32),t._uU(45,"Notes"),t.qZA(),t._UZ(46,"input",33),t.qZA(),t.TgZ(47,"div")(48,"label",34),t._uU(49,"Attachment"),t.qZA(),t.TgZ(50,"input",35,36),t.NdJ("change",function(h){return n.onUploadAttachment(h)}),t.qZA()()()()(),t.TgZ(52,"label",37),t._uU(53,"Recomendation"),t.qZA(),t._UZ(54,"textarea",38),t.TgZ(55,"div",39)(56,"button",40),t._uU(57),t.qZA()()()()()()}if(2&e){const o=t.MAs(10),r=t.MAs(37);t.xp6(1),t.Q6J("nbSpinner",n.loading)("nbSpinnerMessage",n.loading),t.xp6(3),t.Oqu(null==n.dialogData?null:n.dialogData.title),t.xp6(10),t.Q6J("ngForOf",n.spesificationItem),t.xp6(4),t.Q6J("ngForOf",n.imageLink),t.xp6(3),t.Q6J("ngStyle",t.VKq(15,V,n.imageLink.length?"none":"block")),t.xp6(14),t.Q6J("nbDatepicker",r)("ngModel",null==n.dialogData||null==n.dialogData.data?null:n.dialogData.data.date_in_service),t.xp6(6),t.Q6J("ngModel",n.parseToInt(null==n.dialogData||null==n.dialogData.data?null:n.dialogData.data.class)),t.xp6(1),t.Q6J("ngForOf",t.DdM(17,W)),t.xp6(4),t.Q6J("ngModel",null==n.dialogData||null==n.dialogData.data?null:n.dialogData.data.notes),t.xp6(4),t.Q6J("ngModel",null==n.dialogData||null==n.dialogData.data?null:n.dialogData.data.attachment),t.xp6(4),t.Q6J("ngModel",null==n.dialogData||null==n.dialogData.data?null:n.dialogData.data.recomendation),t.xp6(2),t.Q6J("disabled",!o.form.valid),t.xp6(1),t.Oqu(null==n.dialogData?null:n.dialogData.title)}},directives:[m.Asz,m.Q7R,m.ndF,m.DPz,m.fMN,m.yKW,g._Y,g.JL,g.F,_.sg,m.h8i,g.Fj,g.Q7,g.JJ,g.On,_.mk,_.PC,m.$kf,m.B4C,m.rs,m.q51],encapsulation:2}),i})();var E=d(3858),q=d(7625),Y=d(8929),dt=d(2185),Q=d(574),Tt=d(9441),ut=(d(7456),d(4641)),N=d.n(ut),K=d(8493),it=d(7238),st=d.n(it);const Zt=["pdfAssets"];function Mt(i,c){if(1&i&&(t.TgZ(0,"th")(1,"b",6),t._uU(2),t.qZA()()),2&i){const e=c.$implicit;t.xp6(2),t.Oqu(e.name)}}function St(i,c){if(1&i&&(t.TgZ(0,"td"),t._uU(1),t.qZA()),2&i){const e=c.$implicit,n=t.oxw().$implicit;t.xp6(1),t.hij(" ",n[null==e?null:e.props]," ")}}function Ft(i,c){if(1&i&&(t.TgZ(0,"div")(1,"tr"),t.YNc(2,St,2,1,"td",5),t.qZA(),t.TgZ(3,"tr")(4,"td",7)(5,"b",8),t._uU(6,"Notes"),t.qZA()(),t.TgZ(7,"td",9),t._uU(8),t.qZA()()()),2&i){const e=c.$implicit,n=t.oxw();t.xp6(2),t.Q6J("ngForOf",n.assetsHead),t.xp6(6),t.hij(" ",e.notes," ")}}const ue=function(){return{"font-size":"10px"}};N().vfs=K.I.vfs;let pt=(()=>{class i{constructor(){this.assetsHead=[{name:"Id",props:"piping_id"},{name:"Name",props:"piping_name"},{name:"Date In Service",props:"date_in_service"},{name:"Class",props:"class"},{name:"TM",props:"tm_inspection_interval"},{name:"VE",props:"ve_inspection_interval"}]}generateData(e){this.tableData=e,setTimeout(()=>{this.downloadAsPDF()},500)}downloadAsPDF(){N().tableLayouts={exampleLayout:{hLineWidth:function(r,h){return 0===r||r===h.table.body.length?0:r===h.table.headerRows?2:1},vLineWidth:function(r){return 0},hLineColor:function(r){return 1===r?"black":"#aaa"},paddingLeft:function(r){return 0===r?0:8},paddingRight:function(r,h){return r===h.table.widths.length-1?0:8}}};const e=this.pdfAssets.nativeElement,o={content:[st()(e.innerHTML),{pageBreak:"before",text:"Attachment\n",style:{bold:!0,fontSize:16,color:"#5588EE"},pageOrientation:"landscape"}],pageBreakBefore:function(r){return r.style&&r.style.indexOf("pdf-pagebreak-before")>-1}};N().createPdf(o).open()}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=t.Xpm({type:i,selectors:[["pdf-assets-dashboard"]],viewQuery:function(e,n){if(1&e&&t.Gf(Zt,5),2&e){let o;t.iGM(o=t.CRH())&&(n.pdfAssets=o.first)}},decls:9,vars:5,consts:[[1,"container",2,"display","none"],["id","pdfTable"],["pdfAssets",""],[2,"width","100%","margin","0 0 1rem 0","color","#5588EE"],["data-pdfmake","{'widths':[ 'auto', '*', '*', 20, '*', '*' ], 'layout' : 'exampleLayout'}"],[4,"ngFor","ngForOf"],[2,"font-weight","bold"],["colspan","1"],[2,"color","darkcyan"],["colspan","5"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1,2)(3,"h5",3),t._uU(4," Piping Assets "),t.qZA(),t.TgZ(5,"table",4)(6,"tr"),t.YNc(7,Mt,3,1,"th",5),t.qZA(),t.YNc(8,Ft,9,2,"div",5),t.qZA()()()),2&e&&(t.xp6(5),t.Akn(t.DdM(4,ue)),t.xp6(2),t.Q6J("ngForOf",n.assetsHead),t.xp6(1),t.Q6J("ngForOf",n.tableData))},directives:[_.sg],encapsulation:2}),i})(),X=(()=>{class i{constructor(e){this.httpClient=e,this.apiUrl=S.N.apiUrl}getPipingAssets(){const e=this.apiUrl+"/assets",n=new F.WM;return n.append("enctype","multipart/form-data"),n.append("Accept","*/*"),this.httpClient.get(e)}addPipingAssets(e){return this.httpClient.post(this.apiUrl+"/assets",e)}updatePipingAssets(e){return this.httpClient.put(this.apiUrl+"/assets/"+e.id,e)}deletePipingAssets(e){return this.httpClient.delete(this.apiUrl+"/assets/"+e)}uploadImage(e){return this.httpClient.post(this.apiUrl+"/file/upload",e,{reportProgress:!0,observe:"events"})}importAsset(e){return this.httpClient.post(this.apiUrl+"/import_assets",e)}}return i.\u0275fac=function(e){return new(e||i)(t.LFG(F.eN))},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();var ht=d(7024);function H(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"button",2),t.NdJ("click",function(){const r=t.CHM(e).$implicit,h=t.MAs(2),x=t.oxw();return"New"==r.name?x.addAssets():"Import"==r.name?h.click():"Export"==r.name?x.exportExcelFile():"Print"==r.name?x.pdfAssets.generateData(x.tableData):null}),t.TgZ(1,"input",3,4),t.NdJ("change",function(o){return t.CHM(e),t.oxw().importExcelFile(o)}),t.qZA(),t._UZ(3,"nb-icon",5),t.TgZ(4,"span"),t._uU(5),t.qZA()()}if(2&i){const e=c.$implicit,n=t.oxw();let o;t.Q6J("disabled",!("Export"!=(null==e?null:e.name)&&"Print"!=(null==e?null:e.name)||null!=n.tableData&&n.tableData.length)),t.xp6(3),t.Q6J("icon",e.icon)("pack",null!==(o=e.pack)&&void 0!==o?o:"eva"),t.xp6(2),t.Oqu(e.name)}}const ot=function(){return{name:"New",icon:"plus-outline"}},mt=function(){return{name:"Import",icon:"download-outline"}},Ut=function(){return{name:"Export",icon:"upload-outline"}},wt=function(){return{name:"Print",icon:"printer-outline"}},pe=function(i,c,e,n){return[i,c,e,n]};let It=(()=>{class i{constructor(e,n,o,r,h,x){this.assetsService=e,this.dialogService=n,this.toastrService=o,this.pageMenuService=r,this.datePipe=h,this.variables=x,this.destroy$=new Y.xQ,this.tableHeader={title:"Piping Assets",filter:[{name:"Class",value:["All",1,2,3,4],title:"class-assets"}]},this.columnDetails=[{type:"select",prop:"select",head:"",width:"20px"},{type:"text",prop:"piping_id",head:"Piping Id",width:"100px"},{type:"text",prop:"piping_name",head:"Piping Name",width:"200px"},{type:"text",prop:"date_in_service",head:"Date In Service",width:"200px"},{type:"text",prop:"class",head:"Class",width:"200px"},{type:"text",prop:"tm_inspection_interval",head:"TM Inspection Interval",width:"200px"},{type:"text",prop:"ve_inspection_interval",head:"VE Inspection Interval",width:"200px"},{type:"text",prop:"notes",head:"Notes",width:"200px"},{type:"button",prop:"edit",width:"80px",button:[{icon:"edit-outline",status:"info",title:"edit-assets"},{icon:"trash-2-outline",status:"danger",title:"delete-assets"}]}],this.dataSubject=new dt.c,this.transformExcelDate=M=>null==M?"":new Date(Math.round(86400*(M-25569)*1e3))}ngOnInit(){this.assetsService.getPipingAssets().subscribe(({data:e})=>{this.tableData=e.map(n=>{let{tm_inspection_interval:o,ve_inspection_interval:r}=n;return({tm_inspection_interval:o,ve_inspection_interval:r}=this.variables.getInspectionInt(n)),o=o?o.toFixed(1):0,r=r?r.toFixed(1):0,Object.assign(Object.assign({},n),{tm_inspection_interval:o,ve_inspection_interval:r})}),this.viewTable.regenerateTable(this.tableData)},()=>this.toastrService.danger("Please check your connection and try again.","Your request failed."))}onClickTable(e,n){"delete-assets"==n&&this.deleteAsset(e),"edit-assets"==n&&this.updateAssets(e),"class-assets"==n&&this.filterByClass(e),"Export To Excel"==n&&this.exportExcelFile()}filterByClass(e){if("All"==e)this.viewTable.regenerateTable(this.tableData);else{const n=this.tableData.filter(o=>o.class==e);this.viewTable.regenerateTable(n)}}uploadImage(e){const n=new FormData;n.append("image",e),this.pageMenuService.addImage(n).pipe((0,q.R)(this.destroy$)).subscribe(o=>{this.dataSubject.next(o),this.dataSubject.complete()},()=>this.toastrService.danger("Please check your connection and try again.","Failed to upload image."))}addAssets(){this.dialogService.open(R,{context:{dialogData:{title:"Add Assets"}}}).onClose.subscribe(e=>{!e||this.reconstructAssetsData(e,"add")})}updateAssets(e){this.dialogService.open(R,{context:{dialogData:{title:"Update Assets",data:Object.assign(Object.assign({},e),{date_in_service:new Date(e.date_in_service)})}}}).onClose.subscribe(n=>{!n||this.reconstructAssetsData(n,"update",e)})}reconstructAssetsData(e,n,o=null){const{image:r}=e,h=Object.assign(Object.assign(Object.assign({},o),e),{date_in_service:this.datePipe.transform(e.date_in_service,"yyyy-MM-dd")});if(r)for(let x of r)this.uploadImage(x);this.dataSubject.asObservable().pipe((0,q.R)(this.destroy$)).subscribe(x=>{var M;let O=[...null!==(M=null==o?void 0:o.images)&&void 0!==M?M:[]],j=x.data.id;for(let J=j;J<j+r.length;J++)O.push(J);h.images=O,"add"==n&&this.onUploadaddAsset(h),"update"==n&&this.onUploadUpdateAsset(h)}),"add"==n&&!r&&this.onUploadaddAsset(h),"update"==n&&!r&&this.onUploadUpdateAsset(h)}onUploadaddAsset(e){this.assetsService.addPipingAssets(e).subscribe(()=>this.ngOnInit(),()=>this.toastrService.danger("Please check your connection and try again.","Your request failed."),()=>this.toastrService.success("Data has been added.","Your request success."))}onUploadUpdateAsset(e){this.assetsService.updatePipingAssets(e).pipe((0,q.R)(this.destroy$)).subscribe(()=>this.ngOnInit(),()=>this.toastrService.danger("Please check your connection and try again.","Your request failed."),()=>this.toastrService.success("Data has been updated.","Your request success."))}deleteAsset(e){this.dialogService.open(C.F,{context:{dialogData:{title:"Delete Assets",name:e.piping_name,id:e.id}}}).onClose.subscribe(n=>{n&&this.assetsService.deletePipingAssets(n.id).pipe((0,q.R)(this.destroy$)).subscribe(()=>this.ngOnInit(),()=>this.toastrService.danger("Please check your connection and try again.","Your request failed."),()=>this.toastrService.success("Data has been delete.","Your request success."))})}exportExcelFile(){const e=this.viewTable.selectTableRow(),o={Sheets:{"Piping Assets":Q.P6.json_to_sheet(e)},SheetNames:["Piping Assets"]},r=Q.cW(o,{bookType:"xlsx",type:"array"});this.saveAsExcelFile(r,"Assets")}saveAsExcelFile(e,n){const o=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});Tt.saveAs(o,n+"_PIPING_MONITORING_"+(new Date).getTime()+".xlsx")}importExcelFile(e){const n=e.target.files[0];if(!n)return;const o=new FileReader;o.readAsBinaryString(n),o.onload=r=>{const M=Q.ij(r.target.result,{type:"binary"}).Sheets["Data Assets"];let O=0,j=!0;for(;j;){if(O>100&&(j=!1),M["A"+O]){j=!1;break}O++}const J=Q.P6.sheet_to_json(M,{range:O-1,defval:""});this.reconstructDataExcel(J)}}reconstructDataExcel(e){e=e.map(n=>{let{"Piping ID":o,"Piping Name":r,NPS:h,"Pipe Design Code":x,Schedule:M,"Outside Diameter":O,"Long. Quality Factor":j,"Weld Joint Factor":J,"Allowable Stress":G,Coefficient:be,"Min. Design Pressure":_e,"Max. Design Pressure":ve,"Min. Design Temperature":xe,"Max. Design Temperature":ye,"Corrosion Allowance":Ae,"Mechanical Allowance":Ce,"Min. Structural Thickness":De,"Min. Alert Thickness":Te,"Nominal Thickness":Pe,"Date in Service":de,Notes:Ze,Recomendation:Me,Class:Se}=n;return de=this.datePipe.transform(this.transformExcelDate(de),"yyyy-MM-dd"),{piping_id:o,piping_name:r,nominal_pipe_size:h,pipe_design_code:x,schedule:M,outside_diameter:O,longtd_quality_factor:j,weld_joint_factor:J,allowable_unit_stress:G,coefficient:be,min_design_pressure:_e,max_design_pressure:ve,min_design_temperature:xe,max_design_temperature:ye,corrosion_allowance:Ae,mechanical_allowance:Ce,min_structural_thickness:De,min_alert_thickness:Te,nominal_thickness:Pe,date_in_service:de,notes:Ze,recomendation:Me,class:Se}}),this.assetsService.importAsset(e).subscribe(()=>this.ngOnInit(),()=>this.toastrService.danger("Please check your connection and try again.","Your request failed."),()=>this.toastrService.success("Data has been delete.","Your request success."))}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(X),t.Y36(m.Gln),t.Y36(m.quB),t.Y36(y),t.Y36(_.uU),t.Y36(ht.L))},i.\u0275cmp=t.Xpm({type:i,selectors:[["ngx-piping-assets"]],viewQuery:function(e,n){if(1&e&&(t.Gf(E.V,5),t.Gf(pt,5)),2&e){let o;t.iGM(o=t.CRH())&&(n.viewTable=o.first),t.iGM(o=t.CRH())&&(n.pdfAssets=o.first)}},decls:5,vars:13,consts:[["nbButton","","outline","","size","small","status","primary","class","m-2",3,"disabled","click",4,"ngFor","ngForOf"],[3,"tableHeader","columnDetails","tableData","onClickTable"],["nbButton","","outline","","size","small","status","primary",1,"m-2",3,"disabled","click"],["type","file","accept",".xls,.xlsx",2,"display","none",3,"change"],["importExcel",""],[1,"m-1",3,"icon","pack"]],template:function(e,n){1&e&&(t.TgZ(0,"nb-card")(1,"nb-card-body"),t.YNc(2,H,6,4,"button",0),t.qZA()(),t.TgZ(3,"ngx-mat-table",1),t.NdJ("onClickTable",function(r){return n.onClickTable(r.data,r.title)}),t.qZA(),t._UZ(4,"pdf-assets-dashboard")),2&e&&(t.xp6(2),t.Q6J("ngForOf",t.l5B(8,pe,t.DdM(4,ot),t.DdM(5,mt),t.DdM(6,Ut),t.DdM(7,wt))),t.xp6(1),t.Q6J("tableHeader",n.tableHeader)("columnDetails",n.columnDetails)("tableData",n.tableData))},directives:[m.Asz,m.yKW,_.sg,m.DPz,m.fMN,E.V,pt],encapsulation:2}),i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function gt(i,c){if(1&i&&(t.TgZ(0,"nb-option",43),t._uU(1),t.qZA()),2&i){const e=c.$implicit;t.Q6J("value",e.id),t.xp6(1),t.hij("",null==e?null:e.piping_id," ")}}function Et(i,c){if(1&i&&(t.TgZ(0,"nb-option",43),t._uU(1),t.qZA()),2&i){const e=c.$implicit;t.Q6J("value",e),t.xp6(1),t.Oqu(e)}}function Ot(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"div",44)(1,"div",45)(2,"img",46),t.NdJ("click",function(){return t.CHM(e),t.oxw(),t.MAs(52).click()}),t.qZA()()()}if(2&i){const e=c.$implicit;t.Q6J("ngClass",0==c.index?"active":""),t.xp6(2),t.Q6J("src",e.src,t.LSH)("alt",null==e?null:e.alt)}}const bt=function(){return[]},z=function(){return[1,2,3,4]},Nt=function(i){return{display:i}};let tt=(()=>{class i{constructor(e,n,o,r){this.dialog=e,this.assetsService=n,this.pageMenuService=o,this.toastr=r,this.apiUrl=S.N.apiUrl,this.imageLink=[],this.loading=null}ngOnInit(){var e,n;this.assetsService.getPipingAssets().subscribe(({data:r})=>{this.piping=r.filter(h=>{var x,M;return!h.piping_circuit||(null===(M=null===(x=this.dialogData)||void 0===x?void 0:x.data)||void 0===M?void 0:M.piping_id.includes(h.id))})});const o=null===(n=null===(e=this.dialogData)||void 0===e?void 0:e.data)||void 0===n?void 0:n.images;o&&(this.imageLink=o.map(r=>({src:this.apiUrl+"/image/"+r,alt:"Piping Assets"})))}onFileChange(e){const n=e.target.files;this.uploadImageFile=n;for(let r of n){var o=new FileReader;o.readAsDataURL(r),o.onload=h=>{this.imageLink.push({src:h.target.result,alt:r.name})}}}parseInt(e){return e?parseInt(e):null}onUploadAttachment(e){const n=e.target.files[0],o=new FormData;o.append("document",n),this.pageMenuService.addDocument(o).subscribe(r=>{if(r.type===F.dt.UploadProgress)this.loading=100*Math.round(r.loaded/r.total);else if(r.type===F.dt.Response){const h=r,{id:x}=h.body.data;this.attachment=x,this.loading=null,this.toastr.success("Your File has been uploaded.","Success upload file.")}})}closeDialog(e=null){e||this.dialog.close(),e&&(e=Object.assign(Object.assign({},e),{image:this.uploadImageFile,attachment:this.attachment}),this.dialog.close(e))}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(m.X4l),t.Y36(X),t.Y36(y),t.Y36(m.quB))},i.\u0275cmp=t.Xpm({type:i,selectors:[["ngx-add-circuit"]],inputs:{dialogData:"dialogData"},decls:60,vars:22,consts:[[1,"d-flex","justify-content-center","align-items-center","mt-4"],["nbSpinnerStatus","success",1,"mt-5",2,"max-height","35rem","min-width","90rem",3,"nbSpinner","nbSpinnerMessage"],[1,"d-flex"],[1,"w-100"],[1,"flex-shrink-1"],["nbButton","","status","danger","size","tiny",3,"click"],["icon","close-outline"],[3,"ngSubmit"],["addCircuitForm","ngForm"],[1,"row"],[1,"col-6"],["for","piping_circuit_id",1,"mb-1","d-block"],["fullWidth","","nbInput","","fieldSize","small","type","text","id","piping_circuit_id","name","piping_circuit_id","required","",3,"ngModel"],["for","piping_id",1,"mb-1","d-block"],["multiple","","placeholder","Select Assets","name","piping_id",2,"min-width","35rem",3,"ngModel"],[3,"value",4,"ngFor","ngForOf"],["for","piping_circuit_name",1,"mb-1","d-block"],["fullWidth","","nbInput","","fieldSize","small","type","text","id","piping_circuit_name","name","piping_circuit_name","required","",3,"ngModel"],["for","dateInService",1,"mb-1","d-block"],["fullWidth","","nbInput","","fieldSize","small","name","date_in_service","required","",3,"nbDatepicker","ngModel"],["datepicker",""],["for","class",1,"mb-1","d-block"],["placeholder","Class","size","small","status","primary","name","class","required","",3,"ngModel"],["for","notes",1,"mb-1","d-block"],["fullWidth","","nbInput","","fieldSize","small","type","text","id","notes","name","notes",3,"ngModel"],["for","addAttach",1,"d-block","mb-1"],["fullWidth","","fieldSize","tiny","nbInput","","type","file","id","addAttach","accept","application/pdf","id","addAttachment","name","attachment",3,"ngModel","change"],["addAttach",""],[1,"col-6","align-self-center"],["id","carouselExampleInterval","data-bs-ride","carousel",1,"carousel","slide"],[1,"carousel-inner"],["class","carousel-item","data-bs-interval","10000",3,"ngClass",4,"ngFor","ngForOf"],["type","button","data-bs-target","#carouselExampleInterval","data-bs-slide","prev",1,"carousel-control-prev"],["aria-hidden","true",1,"carousel-control-prev-icon"],[1,"visually-hidden"],["type","button","data-bs-target","#carouselExampleInterval","data-bs-slide","next",1,"carousel-control-next"],["aria-hidden","true",1,"carousel-control-next-icon"],["placeholder","Add image","multiple","","fullWidth","","nbInput","","type","file","accept","image/png, image/gif, image/jpeg","id","addImage",2,"display","none",3,"ngStyle","change"],["addImage",""],["for","recomendation",1,"d-block","mb-1"],["fullWidth","","nbInput","","name","recomendation","id","recomendation","rows","2","name","recomendation",3,"ngModel"],[1,"d-flex","justify-content-center"],["nbButton","","status","success","type","submit",1,"m-1","w-100",3,"disabled"],[3,"value"],["data-bs-interval","10000",1,"carousel-item",3,"ngClass"],[1,"overflow-hidden","d-flex","align-justify-center",2,"height","18rem"],[1,"w-100",3,"src","alt","click"]],template:function(e,n){if(1&e){const o=t.EpF();t.TgZ(0,"div",0)(1,"nb-card",1)(2,"nb-card-header",2)(3,"h5",3),t._uU(4),t.qZA(),t.TgZ(5,"div",4)(6,"button",5),t.NdJ("click",function(){return n.closeDialog()}),t._UZ(7,"nb-icon",6),t.qZA()()(),t.TgZ(8,"nb-card-body")(9,"form",7,8),t.NdJ("ngSubmit",function(){t.CHM(o);const h=t.MAs(10);return n.closeDialog(h.value)}),t.TgZ(11,"div",9)(12,"div",10)(13,"label",11),t._uU(14,"Piping Circuit Id"),t.qZA(),t._UZ(15,"input",12),t.TgZ(16,"label",13),t._uU(17,"Piping Id"),t.qZA(),t.TgZ(18,"nb-select",14),t.YNc(19,gt,2,2,"nb-option",15),t.qZA(),t.TgZ(20,"label",16),t._uU(21,"Piping Circuit Name"),t.qZA(),t._UZ(22,"input",17),t.TgZ(23,"label",18),t._uU(24,"Date In Service"),t.qZA(),t._UZ(25,"input",19)(26,"nb-datepicker",null,20),t.TgZ(28,"label",21),t._uU(29,"Class"),t.qZA(),t.TgZ(30,"nb-select",22),t.YNc(31,Et,2,2,"nb-option",15),t.qZA(),t.TgZ(32,"label",23),t._uU(33,"Notes"),t.qZA(),t._UZ(34,"input",24),t.TgZ(35,"label",25),t._uU(36,"Attachment"),t.qZA(),t.TgZ(37,"input",26,27),t.NdJ("change",function(h){return n.onUploadAttachment(h)}),t.qZA()(),t.TgZ(39,"div",28)(40,"div",29)(41,"div",30),t.YNc(42,Ot,3,3,"div",31),t.qZA(),t.TgZ(43,"button",32),t._UZ(44,"span",33),t.TgZ(45,"span",34),t._uU(46,"Previous"),t.qZA()(),t.TgZ(47,"button",35),t._UZ(48,"span",36),t.TgZ(49,"span",34),t._uU(50,"Next"),t.qZA()()(),t.TgZ(51,"input",37,38),t.NdJ("change",function(h){return n.onFileChange(h)}),t.qZA()(),t.TgZ(53,"div")(54,"label",39),t._uU(55,"Recomendation"),t.qZA(),t._UZ(56,"textarea",40),t.qZA(),t.TgZ(57,"div",41)(58,"button",42),t._uU(59),t.qZA()()()()()()()}if(2&e){const o=t.MAs(10),r=t.MAs(27);let h;t.xp6(1),t.Q6J("nbSpinner",n.loading)("nbSpinnerMessage",n.loading),t.xp6(3),t.Oqu(null==n.dialogData?null:n.dialogData.title),t.xp6(11),t.Q6J("ngModel",null==n.dialogData||null==n.dialogData.data?null:n.dialogData.data.piping_circuit_id),t.xp6(3),t.Q6J("ngModel",null!==(h=null==n.dialogData||null==n.dialogData.data?null:n.dialogData.data.piping_id)&&void 0!==h?h:t.DdM(18,bt)),t.xp6(1),t.Q6J("ngForOf",n.piping),t.xp6(3),t.Q6J("ngModel",null==n.dialogData||null==n.dialogData.data?null:n.dialogData.data.piping_circuit_name),t.xp6(3),t.Q6J("nbDatepicker",r)("ngModel",null==n.dialogData||null==n.dialogData.data?null:n.dialogData.data.date_in_service),t.xp6(5),t.Q6J("ngModel",n.parseInt(null==n.dialogData||null==n.dialogData.data?null:n.dialogData.data.class)),t.xp6(1),t.Q6J("ngForOf",t.DdM(19,z)),t.xp6(3),t.Q6J("ngModel",null==n.dialogData||null==n.dialogData.data?null:n.dialogData.data.notes),t.xp6(3),t.Q6J("ngModel",null==n.dialogData||null==n.dialogData.data?null:n.dialogData.data.attachment),t.xp6(5),t.Q6J("ngForOf",n.imageLink),t.xp6(9),t.Q6J("ngStyle",t.VKq(20,Nt,n.imageLink.length?"none":"block")),t.xp6(5),t.Q6J("ngModel",null==n.dialogData||null==n.dialogData.data?null:n.dialogData.data.recomendation),t.xp6(2),t.Q6J("disabled",!o.form.valid),t.xp6(1),t.Oqu(null==n.dialogData?null:n.dialogData.title)}},directives:[m.Asz,m.Q7R,m.ndF,m.DPz,m.fMN,m.yKW,g._Y,g.JL,g.F,m.h8i,g.Fj,g.Q7,g.JJ,g.On,m.rs,_.sg,m.q51,m.$kf,m.B4C,_.mk,_.PC],encapsulation:2}),i})();const jt=["pdfCircuit"];function Jt(i,c){if(1&i&&(t.TgZ(0,"th")(1,"b",6),t._uU(2),t.qZA()()),2&i){const e=c.$implicit;t.xp6(2),t.Oqu(e.name)}}function _t(i,c){if(1&i&&(t.TgZ(0,"td"),t._uU(1),t.qZA()),2&i){const e=c.$implicit,n=t.oxw().$implicit;t.xp6(1),t.hij(" ",n[null==e?null:e.props]," ")}}function Lt(i,c){if(1&i&&(t.TgZ(0,"div")(1,"tr"),t.YNc(2,_t,2,1,"td",5),t.qZA(),t.TgZ(3,"tr")(4,"td",7)(5,"b",8),t._uU(6,"Notes"),t.qZA()(),t.TgZ(7,"td",9),t._uU(8),t.qZA()()()),2&i){const e=c.$implicit,n=t.oxw();t.xp6(2),t.Q6J("ngForOf",n.assetsHead),t.xp6(6),t.hij(" ",e.notes," ")}}const qt=function(){return{"font-size":"10px"}};N().vfs=K.I.vfs;let vt=(()=>{class i{constructor(){this.assetsHead=[{name:"Id",props:"piping_circuit_id"},{name:"Name",props:"piping_circuit_name"},{name:"Date In Service",props:"date_in_service"},{name:"Class",props:"class"}]}generateData(e){this.tableData=e,setTimeout(()=>{this.downloadAsPDF()},500)}downloadAsPDF(){N().tableLayouts={exampleLayout:{hLineWidth:function(r,h){return 0===r||r===h.table.body.length?0:r===h.table.headerRows?2:1},vLineWidth:function(r){return 0},hLineColor:function(r){return 1===r?"black":"#aaa"},paddingLeft:function(r){return 0===r?0:8},paddingRight:function(r,h){return r===h.table.widths.length-1?0:8}}};const e=this.pdfCircuit.nativeElement,o={content:[st()(e.innerHTML),{pageBreak:"before",text:"Attachment\n",style:{bold:!0,fontSize:16,color:"#5588EE"},pageOrientation:"landscape"}],pageBreakBefore:function(r){return r.style&&r.style.indexOf("pdf-pagebreak-before")>-1}};N().createPdf(o).open()}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=t.Xpm({type:i,selectors:[["pdf-circuit-dashboard"]],viewQuery:function(e,n){if(1&e&&t.Gf(jt,5),2&e){let o;t.iGM(o=t.CRH())&&(n.pdfCircuit=o.first)}},decls:9,vars:5,consts:[[1,"container",2,"display","none"],["id","pdfTable"],["pdfCircuit",""],[2,"width","100%","margin","0 0 1rem 0","color","#5588EE"],["data-pdfmake","{'widths':[ '*', '*', '*', '*' ], 'layout' : 'exampleLayout'}"],[4,"ngFor","ngForOf"],[2,"font-weight","bold"],["colspan","1"],[2,"color","darkcyan"],["colspan","3"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1,2)(3,"h5",3),t._uU(4," Piping Circuits "),t.qZA(),t.TgZ(5,"table",4)(6,"tr"),t.YNc(7,Jt,3,1,"th",5),t.qZA(),t.YNc(8,Lt,9,2,"div",5),t.qZA()()()),2&e&&(t.xp6(5),t.Akn(t.DdM(4,qt)),t.xp6(2),t.Q6J("ngForOf",n.assetsHead),t.xp6(1),t.Q6J("ngForOf",n.tableData))},directives:[_.sg],encapsulation:2}),i})();var xt=d(2787);function Qt(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"button",2),t.NdJ("click",function(){const r=t.CHM(e).$implicit,h=t.MAs(2),x=t.oxw();return"New"==r.name?x.addCircuit():"Import"==r.name?h.click():"Export"==r.name?x.export():"Print"==r.name?x.pdfCircuit.generateData(x.tableData):null}),t.TgZ(1,"input",3,4),t.NdJ("change",function(o){return t.CHM(e),t.oxw().importExcelFile(o)}),t.qZA(),t._UZ(3,"nb-icon",5),t.TgZ(4,"span"),t._uU(5),t.qZA()()}if(2&i){const e=c.$implicit,n=t.oxw();let o;t.Q6J("disabled",!("Export"!=(null==e?null:e.name)&&"Print"!=(null==e?null:e.name)||null!=n.tableData&&n.tableData.length)),t.xp6(3),t.Q6J("icon",e.icon)("pack",null!==(o=e.pack)&&void 0!==o?o:"eva"),t.xp6(2),t.Oqu(e.name)}}const yt=function(){return{name:"New",icon:"plus-outline"}},Rt=function(){return{name:"Import",icon:"download-outline"}},Yt=function(){return{name:"Export",icon:"upload-outline"}},at=function(){return{name:"Print",icon:"printer-outline"}},Bt=function(i,c,e,n){return[i,c,e,n]};let Ht=(()=>{class i{constructor(e,n,o,r,h){this.circuitService=e,this.dialogService=n,this.toastrService=o,this.datePipe=r,this.pageMenuService=h,this.tableHeader={title:"Piping Circuits",filter:[{name:"Class",value:["All",1,2,3,4],title:"class-circuit"}]},this.columnDetails=[{type:"select",prop:"select",head:"",width:"20px"},{type:"text",prop:"piping_circuit_id",head:"Piping Circuit Id",width:"100px"},{type:"text",prop:"piping_circuit_name",head:"Piping Circuit Name",width:"200px"},{type:"text",prop:"date_in_service",head:"Date In Service",width:"200px"},{type:"text",prop:"class",head:"Class",width:"200px"},{type:"text",prop:"notes",head:"Notes",width:"200px"},{type:"button",prop:"edit",width:"80px",button:[{icon:"edit-outline",status:"info",title:"update-circuits"},{icon:"trash-2-outline",status:"danger",title:"delete-circuits"}]}],this.dataSubject=new dt.c}ngOnInit(){this.circuitService.getPipingCircuits().subscribe(({data:e})=>{this.tableData=e,this.viewTable.regenerateTable(e)})}onClickTable(e,n){if("class-circuit"==n)if("All"==e)this.viewTable.regenerateTable(this.tableData);else{const o=this.tableData.filter(r=>r.class==e);this.viewTable.regenerateTable(o)}"update-circuits"==n&&this.updateCircuit(e),"delete-circuits"==n&&this.deleteCircuit(e)}uploadImage(e){const n=new FormData;n.append("image",e),this.pageMenuService.addImage(n).subscribe(o=>{this.dataSubject.next(o),this.dataSubject.complete()},()=>this.toastrService.danger("Please check your connection and try again.","Failed to upload image."))}addCircuit(){this.dialogService.open(tt,{context:{dialogData:{title:"Add Circuit"}}}).onClose.subscribe(e=>{!e||this.reconstructDataCircuit(e,"add")})}updateCircuit(e){const n=e.piping.map(o=>o.id);this.dialogService.open(tt,{context:{dialogData:{title:"Update Circuit",data:Object.assign(Object.assign({},e),{date_in_service:new Date(e.date_in_service),piping_id:n})}}}).onClose.subscribe(o=>{!o||this.reconstructDataCircuit(o,"update",e)})}reconstructDataCircuit(e,n,o=null){const{image:r}=e;if(r)for(let x of r)this.uploadImage(x);this.dataSubject.asObservable().subscribe(x=>{var M;let O=[...null!==(M=null==o?void 0:o.images)&&void 0!==M?M:[]],j=x.data.id;for(let G=j;G<j+r.length;G++)O.push(G);const J=Object.assign(Object.assign(Object.assign({},o),e),{images:O,date_in_service:this.datePipe.transform(e.date_in_service,"yyyy-MM-dd")});console.log(J),"add"==n&&this.onUploadaddCircuit(J),"update"==n&&this.onUploadUpdateCircuit(J)});const h=Object.assign(Object.assign(Object.assign({},o),e),{date_in_service:this.datePipe.transform(e.date_in_service,"yyyy-MM-dd")});"add"==n&&!r&&this.onUploadaddCircuit(h),"update"==n&&!r&&this.onUploadUpdateCircuit(h)}onUploadaddCircuit(e){this.circuitService.addPipingCircuits(e).subscribe(()=>this.ngOnInit(),()=>this.toastrService.danger("Please check your connection and try again.","Your request failed."),()=>this.toastrService.success("Data has been added.","Your request success."))}onUploadUpdateCircuit(e){this.circuitService.updatePipingCircuits(e).subscribe(()=>this.ngOnInit(),()=>this.toastrService.danger("Please check your connection and try again.","Your request failed."),()=>this.toastrService.success("Data has been added.","Your request success."))}deleteCircuit(e){this.dialogService.open(C.F,{context:{dialogData:{title:"Add Circuit",name:e.piping_circuit_name,id:e.id}}}).onClose.subscribe(n=>{!n||this.circuitService.deletePipingCircuits(n.id).subscribe(()=>this.ngOnInit(),()=>this.toastrService.danger("Please check your connection and try again.","Your request failed."),()=>this.toastrService.success("Data has been added.","Your request success."))})}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(xt.t),t.Y36(m.Gln),t.Y36(m.quB),t.Y36(_.uU),t.Y36(y))},i.\u0275cmp=t.Xpm({type:i,selectors:[["ngx-piping-circuits"]],viewQuery:function(e,n){if(1&e&&(t.Gf(E.V,5),t.Gf(vt,5)),2&e){let o;t.iGM(o=t.CRH())&&(n.viewTable=o.first),t.iGM(o=t.CRH())&&(n.pdfCircuit=o.first)}},decls:5,vars:13,consts:[["nbButton","","outline","","size","small","status","primary","class","m-2",3,"disabled","click",4,"ngFor","ngForOf"],[3,"tableHeader","columnDetails","tableData","onClickTable"],["nbButton","","outline","","size","small","status","primary",1,"m-2",3,"disabled","click"],["type","file","accept",".xls,.xlsx",2,"display","none",3,"change"],["importExcel",""],[1,"m-1",3,"icon","pack"]],template:function(e,n){1&e&&(t.TgZ(0,"nb-card")(1,"nb-card-body"),t.YNc(2,Qt,6,4,"button",0),t.qZA()(),t.TgZ(3,"ngx-mat-table",1),t.NdJ("onClickTable",function(r){return n.onClickTable(r.data,r.title)}),t.qZA(),t._UZ(4,"pdf-circuit-dashboard")),2&e&&(t.xp6(2),t.Q6J("ngForOf",t.l5B(8,Bt,t.DdM(4,yt),t.DdM(5,Rt),t.DdM(6,Yt),t.DdM(7,at))),t.xp6(1),t.Q6J("tableHeader",n.tableHeader)("columnDetails",n.columnDetails)("tableData",n.tableData))},directives:[m.Asz,m.yKW,_.sg,m.DPz,m.fMN,E.V,vt],encapsulation:2}),i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();var rt=d(4204),lt=d(4107),At=d(3252);const et=function(i){return{color:i}};function Ct(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"nb-list-item",34)(1,"span",35,36),t.NdJ("mouseover",function(){return t.CHM(e),t.MAs(2).style.color="#0492c2"})("mouseout",function(){const r=t.CHM(e).index;return t.MAs(2).style.color=t.oxw(2).selectionCircuit==r?"#0492c2":"black"})("click",function(){const r=t.CHM(e).index;return t.oxw(2).selectCircuit(r)}),t._uU(3),t.qZA()()}if(2&i){const e=c.$implicit,n=c.index,o=t.oxw(2);t.xp6(1),t.Q6J("ngStyle",t.VKq(2,et,o.selectionCircuit==n?"#0492c2":"black")),t.xp6(2),t.hij(" ",e.piping_circuit_name," ")}}function zt(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"nb-list-item",34)(1,"span",35,37),t.NdJ("mouseover",function(){return t.CHM(e),t.MAs(2).style.color="#0492c2"})("mouseout",function(){const r=t.CHM(e).index;return t.MAs(2).style.color=t.oxw(2).selectionPipe==r?"#0492c2":"black"})("click",function(){const o=t.CHM(e),r=o.index,h=o.$implicit;return t.oxw(2).selectPipe(r,h)}),t._uU(3),t.qZA()()}if(2&i){const e=c.$implicit,n=c.index,o=t.oxw(2);t.xp6(1),t.Q6J("ngStyle",t.VKq(2,et,o.selectionPipe==n?"#0492c2":"black")),t.xp6(2),t.hij(" ",e.piping_id," ")}}function Wt(i,c){if(1&i&&(t.TgZ(0,"nb-list-item",34)(1,"span",null,37),t._uU(3),t.qZA()()),2&i){const e=c.$implicit;t.xp6(3),t.hij(" ",null==e?null:e.piping_id," ")}}function $t(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"mat-option",38),t.NdJ("click",function(){const r=t.CHM(e).$implicit;return t.oxw(2).selectInspectionType(r)}),t._uU(1),t.qZA()}if(2&i){const e=c.$implicit;t.Q6J("value",e),t.xp6(1),t.hij(" ",e," ")}}function Gt(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"nb-list-item",39)(1,"span",35,40),t.NdJ("mouseover",function(){return t.CHM(e),t.MAs(2).style.color="#0492c2"})("mouseout",function(){const r=t.CHM(e).index;return t.MAs(2).style.color=t.oxw(2).selectionMethod==r?"#0492c2":"black"})("click",function(){const r=t.CHM(e).index;return t.oxw(2).selectMethod(r)}),t._uU(3),t.qZA()()}if(2&i){const e=c.$implicit,n=c.index,o=t.oxw(2);t.xp6(1),t.Q6J("ngStyle",t.VKq(2,et,o.selectionMethod==n?"#0492c2":"black")),t.xp6(2),t.hij(" ",null==e?null:e.name," ")}}function Vt(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"nb-list-item",34)(1,"span",35,41),t.NdJ("mouseover",function(){return t.CHM(e),t.MAs(2).style.color="#0492c2"})("mouseout",function(){const r=t.CHM(e).index;return t.MAs(2).style.color=t.oxw(2).selectionTechnique==r?"#0492c2":"black"})("click",function(){const o=t.CHM(e),r=o.index,h=o.$implicit;return t.oxw(2).selectTechnique(r,h.name)}),t._uU(3),t.qZA()()}if(2&i){const e=c.$implicit,n=c.index,o=t.oxw(2);t.xp6(1),t.Q6J("ngStyle",t.VKq(2,et,o.selectionTechnique==n?"#0492c2":"black")),t.xp6(2),t.hij(" ",null==e?null:e.name," ")}}function Kt(i,c){if(1&i&&(t.TgZ(0,"span",47),t._uU(1),t.qZA()),2&i){const e=t.oxw().$implicit;t.xp6(1),t.hij(" + ",null==e?null:e.method," ")}}function Xt(i,c){if(1&i&&(t.TgZ(0,"span",47),t._uU(1),t.qZA()),2&i){const e=t.oxw().$implicit;t.xp6(1),t.hij(" + ",null==e?null:e.technique," ")}}function te(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"nb-list-item",42)(1,"div",43)(2,"span",44),t.NdJ("click",function(){const r=t.CHM(e).index;return t.oxw(2).activationMethod(r)}),t.TgZ(3,"div",45)(4,"span"),t._uU(5),t.qZA(),t._UZ(6,"nb-icon",46),t.qZA()(),t.TgZ(7,"span",47),t._uU(8),t.qZA(),t.YNc(9,Kt,2,1,"span",48),t.YNc(10,Xt,2,1,"span",48),t._UZ(11,"input",49),t.TgZ(12,"div",50)(13,"button",6),t.NdJ("click",function(){const r=t.CHM(e).index;return t.oxw(2).deleteMethod(r)}),t._UZ(14,"nb-icon",51),t.qZA()()()()}if(2&i){const e=c.$implicit,n=c.index;t.xp6(5),t.hij(" ",n+1," "),t.xp6(1),t.Q6J("icon",null!=e&&e.active?"radio-button-on-outline":"radio-button-off-outline")("status",null!=e&&e.active?"success":"basic"),t.xp6(2),t.hij(" ",null==e?null:e.type," "),t.xp6(1),t.Q6J("ngIf",null==e?null:e.method),t.xp6(1),t.Q6J("ngIf",null==e?null:e.technique)}}const ee=function(){return["Instrusive","Non Instrusive"]};function ne(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"div",1)(1,"nb-card",2)(2,"nb-card-header",3)(3,"h5",4),t._uU(4),t.qZA(),t.TgZ(5,"div",5)(6,"button",6),t.NdJ("click",function(){return t.CHM(e),t.oxw().closeDialog()}),t._UZ(7,"nb-icon",7),t.qZA()()(),t.TgZ(8,"nb-card-body")(9,"form",8,9),t.NdJ("ngSubmit",function(){t.CHM(e);const o=t.MAs(10);return t.oxw().closeDialog(o.value)}),t.TgZ(11,"h6"),t._uU(12,"IN"),t.qZA(),t.TgZ(13,"section")(14,"nb-card",10)(15,"nb-card-body",3)(16,"div",4)(17,"span",11),t._uU(18,"Circuit ID"),t.qZA(),t.TgZ(19,"nb-list"),t.YNc(20,Ct,4,4,"nb-list-item",12),t.qZA()(),t.TgZ(21,"div",13)(22,"span",11),t._uU(23,"Piping ID"),t.qZA(),t.TgZ(24,"nb-list"),t.YNc(25,zt,4,4,"nb-list-item",12),t.qZA()(),t.TgZ(26,"div",13)(27,"span",11),t._uU(28,"Choosen Pipe"),t.qZA(),t.TgZ(29,"nb-list"),t.YNc(30,Wt,4,1,"nb-list-item",12),t.qZA()()()(),t.TgZ(31,"div")(32,"div",14)(33,"div")(34,"label",15),t._uU(35,"Proposal ID"),t.qZA(),t._UZ(36,"input",16),t.qZA(),t.TgZ(37,"div")(38,"label",15),t._uU(39,"Inspection Planned Date"),t.qZA(),t._UZ(40,"input",17)(41,"nb-datepicker",null,18),t.qZA(),t.TgZ(43,"div")(44,"label",15),t._uU(45,"Recomendation Date"),t.qZA(),t._UZ(46,"input",19)(47,"nb-datepicker",null,20),t.qZA()(),t.TgZ(49,"div",4)(50,"label",21),t._uU(51,"Remarks"),t.qZA(),t._UZ(52,"textarea",22),t.qZA()()(),t.TgZ(53,"h6",23),t._uU(54,"Inspection Method"),t.qZA(),t.TgZ(55,"section",24)(56,"div",25)(57,"mat-form-field",26)(58,"mat-label"),t._uU(59,"Inspection Type"),t.qZA(),t.TgZ(60,"mat-select"),t.YNc(61,$t,2,2,"mat-option",27),t.qZA()()(),t.TgZ(62,"div",28)(63,"nb-card")(64,"nb-card-body",3)(65,"div",29)(66,"span",11),t._uU(67,"Inspection Method"),t.qZA(),t.TgZ(68,"nb-list"),t.YNc(69,Gt,4,4,"nb-list-item",30),t.qZA()(),t.TgZ(70,"div",4)(71,"span",11),t._uU(72,"Inspection Technique"),t.qZA(),t.TgZ(73,"nb-list"),t.YNc(74,Vt,4,4,"nb-list-item",12),t.qZA()()()()(),t.TgZ(75,"div",28)(76,"nb-card",31)(77,"nb-list"),t.YNc(78,te,15,6,"nb-list-item",32),t.qZA()()()(),t.TgZ(79,"button",33),t._uU(80,"Add Proposal"),t.qZA()()()()()}if(2&i){const e=t.MAs(42),n=t.MAs(48),o=t.oxw();t.xp6(4),t.Oqu(null==o.dialogData?null:o.dialogData.title),t.xp6(16),t.Q6J("ngForOf",o.circuitData),t.xp6(5),t.Q6J("ngForOf",null==o.circuitData[o.selectionCircuit]?null:o.circuitData[o.selectionCircuit].piping),t.xp6(5),t.Q6J("ngForOf",o.choosenPipe),t.xp6(10),t.Q6J("nbDatepicker",e),t.xp6(6),t.Q6J("nbDatepicker",n),t.xp6(15),t.Q6J("ngForOf",t.DdM(11,ee)),t.xp6(8),t.Q6J("ngForOf",o.inspectionMethod),t.xp6(5),t.Q6J("ngForOf",null==o.inspectionMethod[o.selectionMethod]?null:o.inspectionMethod[o.selectionMethod].children),t.xp6(4),t.Q6J("ngForOf",o.inspectionMethodList),t.xp6(1),t.Q6J("disabled",!o.choosenPipe.length)}}let nt=(()=>{class i{constructor(e,n,o){this.circuitService=e,this.toastr=n,this.dialog=o,this.selectionCircuit=0,this.selectionMethod=0,this.inspectionMethodList=[],this.choosenPipe=[],this.inspectionMethod=[{name:"Acoustic Emission",children:[{name:"Crack Detection"},{name:"Leak Detection"}]},{name:"Eddy Current",children:[{name:"ACFM"},{name:"Low Frequency"},{name:"Pulsed"},{name:"Remote Field"},{name:"Standard (flat coil)"}]},{name:"Magnetic",children:[{name:"Magnetic Fluorescent Inspection"},{name:"Magnetic Flux Leakage"},{name:"Magnetic Particle Inspection"}]},{name:"Metallurgical",children:[{name:"Hardness Surveys"},{name:"Microstructure Replication"}]},{name:"Monitoring",children:[{name:"On-line Monitoring"}]},{name:"Penetrant",children:[{name:"Liquid Penetrant Inspection"},{name:"Penetrant Leak Inspection"}]},{name:"Radiography",children:[{name:"Compton Scatter"},{name:"Gamma Radiography"},{name:"Real-time Radiography"},{name:"X-Radiography"}]},{name:"Thermography",children:[{name:"Passive Thermography"},{name:"Transient Thermography"}]},{name:"Ultrasonic",children:[{name:"Advanced Ultrasonic Backscatter Technique"},{name:"Angled Compression Wave"},{name:"Angled Shear Wave"},{name:"A-scan Thickness Survey"},{name:"B-Scan"},{name:"Chime"},{name:"C-Scan"},{name:"Digital Ultrasonic Thickness Gauge"},{name:"Internal Rotational Inspection System"},{name:"Lorus"},{name:"Surface Waves"},{name:"Teletest"},{name:"TOFD"}]},{name:"Visual",children:[{name:"Endoscopy"},{name:"Holiday Test"},{name:"Hydrotesting"},{name:"Naked Eye"},{name:"Video"}]}]}ngOnInit(){this.circuitService.getPipingCircuits().subscribe(({data:e})=>{this.circuitData=e})}selectCircuit(e){this.selectionPipe=null,this.selectionCircuit=e}selectPipe(e,n){this.selectionPipe=e,this.choosenPipe.includes(n)||this.choosenPipe.push(n)}selectMethod(e){if(!this.inspectionMethodList.length)return this.toastr.danger("Please input inspection type first.","Selection denied.");this.selectionTechnique=null,this.selectionMethod=e,this.inspectionMethodList[this.activeMethod].method=this.inspectionMethod[this.selectionMethod].name}selectTechnique(e,n){if(!this.inspectionMethodList.length)return this.toastr.danger("Please input inspection type first.","Selection denied.");this.selectionTechnique=e,this.inspectionMethodList[this.activeMethod].method=this.inspectionMethod[this.selectionMethod].name,this.inspectionMethodList[this.activeMethod].technique=n}selectInspectionType(e){this.inspectionMethodList=this.inspectionMethodList.map(n=>Object.assign(Object.assign({},n),{active:!1})),this.inspectionMethodList.push({type:e,active:!0}),this.activeMethod=this.inspectionMethodList.length-1}activationMethod(e){this.inspectionMethodList=this.inspectionMethodList.map(n=>Object.assign(Object.assign({},n),{active:!1})),this.inspectionMethodList[e].active=!0,this.activeMethod=e}deleteMethod(e){console.log(e),this.inspectionMethodList[e]=null,this.inspectionMethodList=this.inspectionMethodList.filter(n=>null!=n),e==this.inspectionMethodList.length&&this.activationMethod(e-1),console.log(this.inspectionMethodList)}closeDialog(e=null){e||this.dialog.close(),e&&(e=Object.assign(Object.assign({},e),{list_of_piping_id:this.choosenPipe.map(n=>n.id),inspection_method:this.inspectionMethodList}),this.dialog.close(e))}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(xt.t),t.Y36(m.quB),t.Y36(m.X4l))},i.\u0275cmp=t.Xpm({type:i,selectors:[["ngx-add-proposal"]],inputs:{dialogData:"dialogData"},decls:1,vars:1,consts:[["class","w-100 d-flex justify-content-center mt-5",4,"ngIf"],[1,"w-100","d-flex","justify-content-center","mt-5"],[1,"mt-5",2,"max-height","35rem","min-width","90rem"],[1,"d-flex"],[1,"w-100"],[1,"flex-shrink-1"],["nbButton","","status","danger","size","tiny",3,"click"],["icon","close-outline"],[3,"ngSubmit"],["proposalForm","ngForm"],[2,"max-height","15rem"],[1,"text-secondary"],["style","max-height: .7rem;",4,"ngFor","ngForOf"],[1,"w-100","ms-4"],[1,"d-flex","justify-content-evenly"],["for","dateInService",1,"mb-1","d-block"],["fullWidth","","nbInput","","fieldSize","small","name","proposal_id","ngModel",""],["fullWidth","","nbInput","","fieldSize","small","name","inspection_planned_date","ngModel","",3,"nbDatepicker"],["inspection_planned_date",""],["fullWidth","","nbInput","","fieldSize","small","name","recomendation_date","ngModel","","disabled","true",3,"nbDatepicker"],["recomendation_date",""],["for","remarks",1,"d-block"],["nbInput","","ngModel","","name","remarks","id","remarks","rows","2","fullWidth",""],[1,"mt-5"],[1,"row"],[1,"col-12"],[1,"my-2"],[3,"value","click",4,"ngFor","ngForOf"],[1,"col-6","p-1"],[1,"w-50"],["style","max-height: .7rem; cursor: pointer;",4,"ngFor","ngForOf"],[2,"max-height","24rem"],["style","cursor: pointer;","class","w-100",4,"ngFor","ngForOf"],["nbButton","","status","success","size","small",1,"w-100",3,"disabled"],[2,"max-height",".7rem"],[2,"cursor","pointer",3,"ngStyle","mouseover","mouseout","click"],["circuitcell",""],["pipingcell",""],[3,"value","click"],[2,"max-height",".7rem","cursor","pointer"],["methodcell",""],["techniquecell",""],[1,"w-100",2,"cursor","pointer"],[1,"d-flex","justify-content-between","w-100","row"],[1,"col-1",3,"click"],[1,"d-flex","align-items-center"],[1,"align-self-center","ms-2",2,"font-size","20px",3,"icon","status"],[1,"col-2"],["class","col-2",4,"ngIf"],["type","number","nbInput","","min","0","max","100","fieldSize","tiny",1,"col-2"],[1,"col-1","d-flex","justify-content-center","align-items-center"],["icon","trash-2-outline"]],template:function(e,n){1&e&&t.YNc(0,ne,81,12,"div",0),2&e&&t.Q6J("ngIf",n.circuitData)},directives:[_.O5,m.Asz,m.ndF,m.DPz,m.fMN,m.yKW,g._Y,g.JL,g.F,m.zP_,_.sg,m.qBV,_.PC,m.h8i,g.Fj,g.JJ,g.On,m.$kf,m.B4C,rt.KE,rt.hX,lt.gD,At.ey],encapsulation:2}),i})();const ct=["pdfCircuit"];function ie(i,c){if(1&i&&(t.TgZ(0,"th")(1,"b",6),t._uU(2),t.qZA()()),2&i){const e=c.$implicit;t.xp6(2),t.Oqu(e.name)}}function se(i,c){if(1&i&&(t.TgZ(0,"td"),t._uU(1),t.qZA()),2&i){const e=c.$implicit,n=t.oxw().$implicit;t.xp6(1),t.hij(" ",n[null==e?null:e.props]," ")}}function oe(i,c){if(1&i&&(t.TgZ(0,"div")(1,"tr"),t.YNc(2,se,2,1,"td",5),t.qZA(),t.TgZ(3,"tr")(4,"td",7)(5,"b",8),t._uU(6,"Remarks"),t.qZA()(),t.TgZ(7,"td",9),t._uU(8),t.qZA()()()),2&i){const e=c.$implicit,n=t.oxw();t.xp6(2),t.Q6J("ngForOf",n.assetsHead),t.xp6(6),t.hij(" ",e.remarks," ")}}const ae=function(){return{"font-size":"10px"}};N().vfs=K.I.vfs;let Dt=(()=>{class i{constructor(){this.assetsHead=[{name:"Id",props:"proposal_id"},{name:"Insp Plan Date",props:"inspection_planned_date"},{name:"Piping Circuit",props:"piping_circuit"}]}generateData(e){this.tableData=e,setTimeout(()=>{this.downloadAsPDF()},500)}downloadAsPDF(){N().tableLayouts={exampleLayout:{hLineWidth:function(r,h){return 0===r||r===h.table.body.length?0:r===h.table.headerRows?2:1},vLineWidth:function(r){return 0},hLineColor:function(r){return 1===r?"black":"#aaa"},paddingLeft:function(r){return 0===r?0:8},paddingRight:function(r,h){return r===h.table.widths.length-1?0:8}}};const e=this.pdfCircuit.nativeElement,o={content:[st()(e.innerHTML),{pageBreak:"before",text:"Attachment\n",style:{bold:!0,fontSize:16,color:"#5588EE"},pageOrientation:"landscape"}],pageBreakBefore:function(r){return r.style&&r.style.indexOf("pdf-pagebreak-before")>-1}};N().createPdf(o).open()}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=t.Xpm({type:i,selectors:[["pdf-proposal-dashboard"]],viewQuery:function(e,n){if(1&e&&t.Gf(ct,5),2&e){let o;t.iGM(o=t.CRH())&&(n.pdfCircuit=o.first)}},decls:9,vars:5,consts:[[1,"container",2,"display","none"],["id","pdfTable"],["pdfCircuit",""],[2,"width","100%","margin","0 0 1rem 0","color","#5588EE"],["data-pdfmake","{'widths':[ '*', '*', '*' ], 'layout' : 'exampleLayout'}"],[4,"ngFor","ngForOf"],[2,"font-weight","bold"],["colspan","1"],[2,"color","darkcyan"],["colspan","2"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1,2)(3,"h5",3),t._uU(4," Proposals "),t.qZA(),t.TgZ(5,"table",4)(6,"tr"),t.YNc(7,ie,3,1,"th",5),t.qZA(),t.YNc(8,oe,9,2,"div",5),t.qZA()()()),2&e&&(t.xp6(5),t.Akn(t.DdM(4,ae)),t.xp6(2),t.Q6J("ngForOf",n.assetsHead),t.xp6(1),t.Q6J("ngForOf",n.tableData))},directives:[_.sg],encapsulation:2}),i})(),re=(()=>{class i{constructor(e){this.httpClient=e,this.apiUrl=S.N.apiUrl}getProposals(){return this.httpClient.get(this.apiUrl+"/proposal")}addProposals(e){return this.httpClient.post(this.apiUrl+"/proposal",e)}}return i.\u0275fac=function(e){return new(e||i)(t.LFG(F.eN))},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function le(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"button",2),t.NdJ("click",function(){const r=t.CHM(e).$implicit,h=t.oxw();return"New"==r.name?h.addProposal():"Print"==r.name?h.pdfProposals.generateData(h.tableData):null}),t._UZ(1,"nb-icon",3),t.TgZ(2,"span"),t._uU(3),t.qZA()()}if(2&i){const e=c.$implicit,n=t.oxw();let o;t.Q6J("disabled",!("Export"!=(null==e?null:e.name)&&"Print"!=(null==e?null:e.name)||null!=n.tableData&&n.tableData.length)),t.xp6(1),t.Q6J("icon",e.icon)("pack",null!==(o=e.pack)&&void 0!==o?o:"eva"),t.xp6(2),t.Oqu(e.name)}}const ce=function(){return{name:"New",icon:"plus-outline"}},u=function(){return{name:"Print",icon:"printer-outline"}},s=function(i,c){return[i,c]},a=function(){return{title:"Proposal"}},p=[{path:"",component:L,children:[{path:"piping-assets",component:It,data:{routename:"assets"}},{path:"piping-circuits",component:Ht,data:{routename:"circuit"}},{path:"view-proposal",component:(()=>{class i{constructor(e,n,o,r){this.proposalService=e,this.dialogService=n,this.datePipe=o,this.toastrService=r,this.tableData=[],this.columnDetails=[{type:"select",prop:"select",head:"",width:"20px"},{type:"text",prop:"proposal_id",head:"Proposal ID",width:"100px"},{type:"text",prop:"inspection_planned_date",head:"Inspection Plan Date",width:"200px"},{type:"text",prop:"piping_circuit",head:"Piping Circuit",width:"200px"},{type:"text",prop:"remarks",head:"Remarks",width:"200px"}]}ngOnInit(){this.proposalService.getProposals().subscribe(({data:e})=>{this.tableData=e,this.viewTable.regenerateTable(e)})}addProposal(){this.dialogService.open(nt,{context:{dialogData:{title:"Add Proposal"}}}).onClose.subscribe(e=>{if(!e)return;const{inspection_planned_date:n,recomendation_date:o}=e;e=Object.assign(Object.assign({},e),{inspection_planned_date:this.datePipe.transform(n,"yyyy-MM-dd"),recomendation_date:this.datePipe.transform(o,"yyyy-MM-dd")}),console.log(e),this.proposalService.addProposals(e).subscribe(()=>this.ngOnInit(),()=>this.toastrService.danger("Please check your connection and try again.","Your request failed."),()=>this.toastrService.success("Data has been added.","Your request success."))})}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(re),t.Y36(m.Gln),t.Y36(_.uU),t.Y36(m.quB))},i.\u0275cmp=t.Xpm({type:i,selectors:[["ngx-view-proposal"]],viewQuery:function(e,n){if(1&e&&(t.Gf(E.V,5),t.Gf(Dt,5)),2&e){let o;t.iGM(o=t.CRH())&&(n.viewTable=o.first),t.iGM(o=t.CRH())&&(n.pdfProposals=o.first)}},decls:5,vars:10,consts:[["nbButton","","outline","","size","small","status","primary","class","m-2",3,"disabled","click",4,"ngFor","ngForOf"],[3,"tableHeader","columnDetails","tableData"],["nbButton","","outline","","size","small","status","primary",1,"m-2",3,"disabled","click"],[1,"m-1",3,"icon","pack"]],template:function(e,n){1&e&&(t.TgZ(0,"nb-card")(1,"nb-card-body"),t.YNc(2,le,4,4,"button",0),t.qZA()(),t._UZ(3,"ngx-mat-table",1)(4,"pdf-proposal-dashboard")),2&e&&(t.xp6(2),t.Q6J("ngForOf",t.WLB(6,s,t.DdM(4,ce),t.DdM(5,u))),t.xp6(1),t.Q6J("tableHeader",t.DdM(9,a))("columnDetails",n.columnDetails)("tableData",n.tableData))},directives:[m.Asz,m.yKW,_.sg,m.DPz,m.fMN,E.V,Dt],encapsulation:2}),i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),data:{routename:"proposal"}}]}];let f=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[[I.Bz.forChild(p)],I.Bz]}),i})();var v=d(2356),b=d(9511),T=d(2368),D=d(8279),Z=d(7446),$=d(5331),he=d(7531),me=d(8246);let fe=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[[_.ez,w.O,m.j7H.forChild({closeOnBackdropClick:!0}),m.zyh,m.KdK,m.T2N]]}),i})(),ge=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[[_.ez,w.O,m.j5J,m.zyh,m.x4g,m.IIj,m.oGl,m.nKr,m.OA,m.T2N,m.KdK,m.COg,m.KdK,m.LW9.forRoot({destroyByClick:!0,duration:3e3,position:m.fe3.BOTTOM_RIGHT,preventDuplicates:!0,limit:3}),m.uuI,me.F5,g.u5,f,v.Z,b.H,T.rP,D.p0,Z.p9,$.TU,rt.lN,he.c,lt.LD,fe]]}),i})()},2787:(B,U,d)=>{"use strict";d.d(U,{t:()=>I});var _=d(2340),w=d(5e3),m=d(520);let I=(()=>{class t{constructor(C){this.httpClient=C,this.apiUrl=_.N.apiUrl}getPipingCircuits(){return this.httpClient.get(this.apiUrl+"/circuit")}addPipingCircuits(C){return this.httpClient.post(this.apiUrl+"/circuit",C)}updatePipingCircuits(C){return this.httpClient.put(this.apiUrl+"/circuit/"+C.id,C)}deletePipingCircuits(C){return this.httpClient.delete(this.apiUrl+"/circuit/"+C)}}return t.\u0275fac=function(C){return new(C||t)(w.LFG(m.eN))},t.\u0275prov=w.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},9441:function(B,U){var w;void 0!==(w=function(){"use strict";function I(y,g,k){var A=new XMLHttpRequest;A.open("GET",y),A.responseType="blob",A.onload=function(){F(A.response,g,k)},A.onerror=function(){console.error("could not download file")},A.send()}function t(y){var g=new XMLHttpRequest;g.open("HEAD",y,!1);try{g.send()}catch(k){}return 200<=g.status&&299>=g.status}function L(y){try{y.dispatchEvent(new MouseEvent("click"))}catch(k){var g=document.createEvent("MouseEvents");g.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),y.dispatchEvent(g)}}var C="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof global&&global.global===global?global:void 0,S=C.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),F=C.saveAs||("object"!=typeof window||window!==C?function(){}:"download"in HTMLAnchorElement.prototype&&!S?function(y,g,k){var A=C.URL||C.webkitURL,P=document.createElement("a");P.download=g=g||y.name||"download",P.rel="noopener","string"==typeof y?(P.href=y,P.origin===location.origin?L(P):t(P.href)?I(y,g,k):L(P,P.target="_blank")):(P.href=A.createObjectURL(y),setTimeout(function(){A.revokeObjectURL(P.href)},4e4),setTimeout(function(){L(P)},0))}:"msSaveOrOpenBlob"in navigator?function(y,g,k){if(g=g||y.name||"download","string"!=typeof y)navigator.msSaveOrOpenBlob(function m(y,g){return void 0===g?g={autoBom:!1}:"object"!=typeof g&&(console.warn("Deprecated: Expected third argument to be a object"),g={autoBom:!g}),g.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(y.type)?new Blob(["\ufeff",y],{type:y.type}):y}(y,k),g);else if(t(y))I(y,g,k);else{var A=document.createElement("a");A.href=y,A.target="_blank",setTimeout(function(){L(A)})}}:function(y,g,k,A){if((A=A||open("","_blank"))&&(A.document.title=A.document.body.innerText="downloading..."),"string"==typeof y)return I(y,g,k);var P="application/octet-stream"===y.type,V=/constructor/i.test(C.HTMLElement)||C.safari,W=/CriOS\/[\d]+/.test(navigator.userAgent);if((W||P&&V||S)&&"undefined"!=typeof FileReader){var R=new FileReader;R.onloadend=function(){var Y=R.result;Y=W?Y:Y.replace(/^data:[^;]*;/,"data:attachment/file;"),A?A.location.href=Y:location=Y,A=null},R.readAsDataURL(y)}else{var E=C.URL||C.webkitURL,q=E.createObjectURL(y);A?A.location=q:location.href=q,A=null,setTimeout(function(){E.revokeObjectURL(q)},4e4)}});C.saveAs=F.saveAs=F,B.exports=F}.apply(U,[]))&&(B.exports=w)},2231:(B,U,d)=>{"use strict";Object.defineProperty(U,"__esModule",{value:!0});var _=d(2403);_.Observable.forkJoin=_.forkJoin},2403:(B,U,d)=>{"use strict";d.r(U),d.d(U,{ArgumentOutOfRangeError:()=>Zt.W,AsyncSubject:()=>P.c,BehaviorSubject:()=>k.X,ConnectableObservable:()=>w.c,EMPTY:()=>z.E,EmptyError:()=>Mt.K,GroupedObservable:()=>S,NEVER:()=>yt,Notification:()=>ut.P,NotificationKind:()=>ut.W,ObjectUnsubscribedError:()=>St.N,Observable:()=>_.y,ReplaySubject:()=>A.t,Scheduler:()=>Tt.b,Subject:()=>g.xQ,Subscriber:()=>Pt.L,Subscription:()=>m.w,TimeoutError:()=>pt,UnsubscriptionError:()=>Ft.B,VirtualAction:()=>Q,VirtualTimeScheduler:()=>dt,animationFrame:()=>E.r,animationFrameScheduler:()=>E.Z,asap:()=>V.e,asapScheduler:()=>V.E,async:()=>W.P,asyncScheduler:()=>W.z,bindCallback:()=>mt,bindNodeCallback:()=>ft,combineLatest:()=>Et.aj,concat:()=>Ot.z,config:()=>ce.v,defer:()=>bt.P,empty:()=>z.c,forkJoin:()=>Nt.D,from:()=>tt.D,fromEvent:()=>jt.R,fromEventPattern:()=>_t,generate:()=>Lt,identity:()=>it.y,iif:()=>vt,interval:()=>xt.F,isObservable:()=>st.b,merge:()=>Qt.T,never:()=>Rt,noop:()=>K.Z,observable:()=>y.L,of:()=>Yt.of,onErrorResumeNext:()=>at,pairs:()=>Bt,partition:()=>et,pipe:()=>N.z,queue:()=>R.c,queueScheduler:()=>R.N,race:()=>$t,range:()=>Kt,scheduled:()=>le.x,throwError:()=>te._,timer:()=>ee.H,using:()=>ne,zip:()=>ie});var _=d(4202),w=d(1762),m=d(4096);class S extends _.y{constructor(s,a,l){super(),this.key=s,this.groupSubject=a,this.refCountSubscription=l}_subscribe(s){const a=new m.w,{refCountSubscription:l,groupSubject:p}=this;return l&&!l.closed&&a.add(new F(l)),a.add(p.subscribe(s)),a}}class F extends m.w{constructor(s){super(),this.parent=s,s.count++}unsubscribe(){const s=this.parent;!s.closed&&!this.closed&&(super.unsubscribe(),s.count-=1,0===s.count&&s.attemptedToUnsubscribe&&s.unsubscribe())}}var y=d(3821),g=d(8929),k=d(591),A=d(2247),P=d(2185),V=d(8139),W=d(353),R=d(341),E=d(352),q=d(6686),Y=d(198);let dt=(()=>{class u extends Y.v{constructor(a=Q,l=Number.POSITIVE_INFINITY){super(a,()=>this.frame),this.maxFrames=l,this.frame=0,this.index=-1}flush(){const{actions:a,maxFrames:l}=this;let p,f;for(;(f=a[0])&&f.delay<=l&&(a.shift(),this.frame=f.delay,!(p=f.execute(f.state,f.delay))););if(p){for(;f=a.shift();)f.unsubscribe();throw p}}}return u.frameTimeFactor=10,u})();class Q extends q.o{constructor(s,a,l=(s.index+=1)){super(s,a),this.scheduler=s,this.work=a,this.index=l,this.active=!0,this.index=s.index=l}schedule(s,a=0){if(!this.id)return super.schedule(s,a);this.active=!1;const l=new Q(this.scheduler,this.work);return this.add(l),l.schedule(s,a)}requestAsyncId(s,a,l=0){this.delay=s.frame+l;const{actions:p}=s;return p.push(this),p.sort(Q.sortActions),!0}recycleAsyncId(s,a,l=0){}_execute(s,a){if(!0===this.active)return super._execute(s,a)}static sortActions(s,a){return s.delay===a.delay?s.index===a.index?0:s.index>a.index?1:-1:s.delay>a.delay?1:-1}}var Tt=d(2221),Pt=d(3489),ut=d(9312),N=d(4843),K=d(7876),it=d(5379),st=d(4715),Zt=d(4231),Mt=d(4450),St=d(5279),Ft=d(7964);const pt=(()=>{function u(){return Error.call(this),this.message="Timeout has occurred",this.name="TimeoutError",this}return u.prototype=Object.create(Error.prototype),u})();var X=d(4850),ht=d(9476),H=d(6688),ot=d(2866);function mt(u,s,a){if(s){if(!(0,ot.K)(s))return(...l)=>mt(u,a)(...l).pipe((0,X.U)(p=>(0,H.k)(p)?s(...p):s(p)));a=s}return function(...l){const p=this;let f;const v={context:p,subject:f,callbackFunc:u,scheduler:a};return new _.y(b=>{if(a)return a.schedule(Ut,0,{args:l,subscriber:b,params:v});if(!f){f=new P.c;const T=(...D)=>{f.next(D.length<=1?D[0]:D),f.complete()};try{u.apply(p,[...l,T])}catch(D){(0,ht._)(f)?f.error(D):console.warn(D)}}return f.subscribe(b)})}}function Ut(u){const{args:a,subscriber:l,params:p}=u,{callbackFunc:f,context:v,scheduler:b}=p;let{subject:T}=p;if(!T){T=p.subject=new P.c;const D=(...Z)=>{this.add(b.schedule(wt,0,{value:Z.length<=1?Z[0]:Z,subject:T}))};try{f.apply(v,[...a,D])}catch(Z){T.error(Z)}}this.add(T.subscribe(l))}function wt(u){const{value:s,subject:a}=u;a.next(s),a.complete()}function ft(u,s,a){if(s){if(!(0,ot.K)(s))return(...l)=>ft(u,a)(...l).pipe((0,X.U)(p=>(0,H.k)(p)?s(...p):s(p)));a=s}return function(...l){const p={subject:void 0,args:l,callbackFunc:u,scheduler:a,context:this};return new _.y(f=>{const{context:v}=p;let{subject:b}=p;if(a)return a.schedule(kt,0,{params:p,subscriber:f,context:v});if(!b){b=p.subject=new P.c;const T=(...D)=>{const Z=D.shift();Z?b.error(Z):(b.next(D.length<=1?D[0]:D),b.complete())};try{u.apply(v,[...l,T])}catch(D){(0,ht._)(b)?b.error(D):console.warn(D)}}return b.subscribe(f)})}}function kt(u){const{params:s,subscriber:a,context:l}=u,{callbackFunc:p,args:f,scheduler:v}=s;let b=s.subject;if(!b){b=s.subject=new P.c;const T=(...D)=>{const Z=D.shift();this.add(Z?v.schedule(gt,0,{err:Z,subject:b}):v.schedule(It,0,{value:D.length<=1?D[0]:D,subject:b}))};try{p.apply(l,[...f,T])}catch(D){this.add(v.schedule(gt,0,{err:D,subject:b}))}}this.add(b.subscribe(a))}function It(u){const{value:s,subject:a}=u;a.next(s),a.complete()}function gt(u){const{err:s,subject:a}=u;a.error(s)}var Et=d(6053),Ot=d(1221),bt=d(8514),z=d(8896),Nt=d(567),tt=d(3527),jt=d(3753),Jt=d(7043);function _t(u,s,a){return a?_t(u,s).pipe((0,X.U)(l=>(0,H.k)(l)?a(...l):a(l))):new _.y(l=>{const p=(...v)=>l.next(1===v.length?v[0]:v);let f;try{f=u(p)}catch(v){return void l.error(v)}if((0,Jt.m)(s))return()=>s(p,f)})}function Lt(u,s,a,l,p){let f,v;return 1==arguments.length?(v=u.initialState,s=u.condition,a=u.iterate,f=u.resultSelector||it.y,p=u.scheduler):void 0===l||(0,ot.K)(l)?(v=u,f=it.y,p=l):(v=u,f=l),new _.y(b=>{let T=v;if(p)return p.schedule(qt,0,{subscriber:b,iterate:a,condition:s,resultSelector:f,state:T});for(;;){if(s){let Z;try{Z=s(T)}catch($){return void b.error($)}if(!Z){b.complete();break}}let D;try{D=f(T)}catch(Z){return void b.error(Z)}if(b.next(D),b.closed)break;try{T=a(T)}catch(Z){return void b.error(Z)}}})}function qt(u){const{subscriber:s,condition:a}=u;if(s.closed)return;if(u.needIterate)try{u.state=u.iterate(u.state)}catch(p){return void s.error(p)}else u.needIterate=!0;if(a){let p;try{p=a(u.state)}catch(f){return void s.error(f)}if(!p)return void s.complete();if(s.closed)return}let l;try{l=u.resultSelector(u.state)}catch(p){return void s.error(p)}return s.closed||(s.next(l),s.closed)?void 0:this.schedule(u)}function vt(u,s=z.E,a=z.E){return(0,bt.P)(()=>u()?s:a)}var xt=d(1715),Qt=d(6787);const yt=new _.y(K.Z);function Rt(){return yt}var Yt=d(1086);function at(...u){if(0===u.length)return z.E;const[s,...a]=u;return 1===u.length&&(0,H.k)(s)?at(...s):new _.y(l=>{const p=()=>l.add(at(...a).subscribe(l));return(0,tt.D)(s).subscribe({next(f){l.next(f)},error:p,complete:p})})}function Bt(u,s){return new _.y(s?a=>{const l=Object.keys(u),p=new m.w;return p.add(s.schedule(Ht,0,{keys:l,index:0,subscriber:a,subscription:p,obj:u})),p}:a=>{const l=Object.keys(u);for(let p=0;p<l.length&&!a.closed;p++){const f=l[p];u.hasOwnProperty(f)&&a.next([f,u[f]])}a.complete()})}function Ht(u){const{keys:s,index:a,subscriber:l,subscription:p,obj:f}=u;if(!l.closed)if(a<s.length){const v=s[a];l.next([v,f[v]]),p.add(this.schedule({keys:s,index:a+1,subscriber:l,subscription:p,obj:f}))}else l.complete()}function rt(u,s){function a(){return!a.pred.apply(a.thisArg,arguments)}return a.pred=u,a.thisArg=s,a}var lt=d(9249),At=d(2198);function et(u,s,a){return[(0,At.h)(s,a)(new _.y((0,lt.s)(u))),(0,At.h)(rt(s,a))(new _.y((0,lt.s)(u)))]}var Ct=d(3009),zt=d(826),Wt=d(448);function $t(...u){if(1===u.length){if(!(0,H.k)(u[0]))return u[0];u=u[0]}return(0,Ct.n)(u,void 0).lift(new Gt)}class Gt{call(s,a){return a.subscribe(new Vt(s))}}class Vt extends zt.L{constructor(s){super(s),this.hasFirst=!1,this.observables=[],this.subscriptions=[]}_next(s){this.observables.push(s)}_complete(){const s=this.observables,a=s.length;if(0===a)this.destination.complete();else{for(let l=0;l<a&&!this.hasFirst;l++){const f=(0,Wt.D)(this,s[l],void 0,l);this.subscriptions&&this.subscriptions.push(f),this.add(f)}this.observables=null}}notifyNext(s,a,l){if(!this.hasFirst){this.hasFirst=!0;for(let p=0;p<this.subscriptions.length;p++)if(p!==l){let f=this.subscriptions[p];f.unsubscribe(),this.remove(f)}this.subscriptions=null}this.destination.next(a)}}function Kt(u=0,s,a){return new _.y(l=>{void 0===s&&(s=u,u=0);let p=0,f=u;if(a)return a.schedule(Xt,0,{index:p,count:s,start:u,subscriber:l});for(;;){if(p++>=s){l.complete();break}if(l.next(f++),l.closed)break}})}function Xt(u){const{start:s,index:a,count:l,subscriber:p}=u;a>=l?p.complete():(p.next(s),!p.closed&&(u.index=a+1,u.start=s+1,this.schedule(u)))}var te=d(1737),ee=d(8723);function ne(u,s){return new _.y(a=>{let l,p;try{l=u()}catch(b){return void a.error(b)}try{p=s(l)}catch(b){return void a.error(b)}const v=(p?(0,tt.D)(p):z.E).subscribe(a);return()=>{v.unsubscribe(),l&&l.unsubscribe()}})}var nt=d(5430),ct=d(1177);function ie(...u){const s=u[u.length-1];return"function"==typeof s&&u.pop(),(0,Ct.n)(u,void 0).lift(new se(s))}class se{constructor(s){this.resultSelector=s}call(s,a){return a.subscribe(new oe(s,this.resultSelector))}}class oe extends Pt.L{constructor(s,a,l=Object.create(null)){super(s),this.resultSelector=a,this.iterators=[],this.active=0,this.resultSelector="function"==typeof a?a:void 0}_next(s){const a=this.iterators;(0,H.k)(s)?a.push(new Dt(s)):a.push("function"==typeof s[nt.hZ]?new ae(s[nt.hZ]()):new re(this.destination,this,s))}_complete(){const s=this.iterators,a=s.length;if(this.unsubscribe(),0!==a){this.active=a;for(let l=0;l<a;l++){let p=s[l];p.stillUnsubscribed?this.destination.add(p.subscribe()):this.active--}}else this.destination.complete()}notifyInactive(){this.active--,0===this.active&&this.destination.complete()}checkIterators(){const s=this.iterators,a=s.length,l=this.destination;for(let v=0;v<a;v++){let b=s[v];if("function"==typeof b.hasValue&&!b.hasValue())return}let p=!1;const f=[];for(let v=0;v<a;v++){let b=s[v],T=b.next();if(b.hasCompleted()&&(p=!0),T.done)return void l.complete();f.push(T.value)}this.resultSelector?this._tryresultSelector(f):l.next(f),p&&l.complete()}_tryresultSelector(s){let a;try{a=this.resultSelector.apply(this,s)}catch(l){return void this.destination.error(l)}this.destination.next(a)}}class ae{constructor(s){this.iterator=s,this.nextResult=s.next()}hasValue(){return!0}next(){const s=this.nextResult;return this.nextResult=this.iterator.next(),s}hasCompleted(){const s=this.nextResult;return Boolean(s&&s.done)}}class Dt{constructor(s){this.array=s,this.index=0,this.length=0,this.length=s.length}[nt.hZ](){return this}next(s){const a=this.index++;return a<this.length?{value:this.array[a],done:!1}:{value:null,done:!0}}hasValue(){return this.array.length>this.index}hasCompleted(){return this.array.length===this.index}}class re extends ct.Ds{constructor(s,a,l){super(s),this.parent=a,this.observable=l,this.stillUnsubscribed=!0,this.buffer=[],this.isComplete=!1}[nt.hZ](){return this}next(){const s=this.buffer;return 0===s.length&&this.isComplete?{value:null,done:!0}:{value:s.shift(),done:!1}}hasValue(){return this.buffer.length>0}hasCompleted(){return 0===this.buffer.length&&this.isComplete}notifyComplete(){this.buffer.length>0?(this.isComplete=!0,this.parent.notifyInactive()):this.destination.complete()}notifyNext(s){this.buffer.push(s),this.parent.checkIterators()}subscribe(){return(0,ct.ft)(this.observable,new ct.IY(this))}}var le=d(3998),ce=d(2830)},2185:(B,U,d)=>{"use strict";d.d(U,{c:()=>m});var _=d(8929),w=d(4096);class m extends _.xQ{constructor(){super(...arguments),this.value=null,this.hasNext=!1,this.hasCompleted=!1}_subscribe(t){return this.hasError?(t.error(this.thrownError),w.w.EMPTY):this.hasCompleted&&this.hasNext?(t.next(this.value),t.complete(),w.w.EMPTY):super._subscribe(t)}next(t){this.hasCompleted||(this.value=t,this.hasNext=!0)}error(t){this.hasCompleted||super.error(t)}complete(){this.hasCompleted=!0,this.hasNext&&super.next(this.value),super.complete()}}},7456:(B,U,d)=>{"use strict";d(2231)}}]);