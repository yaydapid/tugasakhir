"use strict";(self.webpackChunkngx_admin_demo=self.webpackChunkngx_admin_demo||[]).push([[945],{8945:(Ye,S,c)=>{c.r(S),c.d(S,{ReportModule:()=>Se});var f=c(9808),G=c(4738),k=c(2497),t=c(5e3);let V=(()=>{class n{constructor(){}ngOnInit(){}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=t.Xpm({type:n,selectors:[["ngx-report"]],decls:1,vars:0,template:function(e,i){1&e&&t._UZ(0,"router-outlet")},directives:[k.lC],encapsulation:2}),n})();var u=c(8279),Z=c(4847),D=c(8246),C=c(5331),x=c(2340),w=c(3858),q=c(7313);let I=(()=>{class n extends q.Z{constructor(){super(),this.defineOptions({chartTitle:"Thickness vs Year",yTitle:"Thickness (mm)",xTitle:"Year"})}ngOnInit(){this.generateChart("DashboardThickness")}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=t.Xpm({type:n,selectors:[["ngx-dashboard-thickness-chart"]],features:[t.qOj],decls:1,vars:0,consts:[["id","DashboardThickness"]],template:function(e,i){1&e&&t._UZ(0,"canvas",0)},encapsulation:2}),n})(),J=(()=>{class n extends q.Z{constructor(){super(),this.defineOptions({chartTitle:"Remaining Life vs Year",yTitle:"Remaining Life (years)",xTitle:"Year"})}ngOnInit(){this.generateChart("DashboardRemaining")}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=t.Xpm({type:n,selectors:[["ngx-dashboard-remaining-chart"]],features:[t.qOj],decls:1,vars:0,consts:[["id","DashboardRemaining"]],template:function(e,i){1&e&&t._UZ(0,"canvas",0)},encapsulation:2}),n})();var W=c(4641),A=c.n(W),L=c(8493),X=c(7238),Q=c.n(X),l=c(3254),K=c(520);let P=(()=>{class n{constructor(e){this.httpClient=e,this.apiUrl=x.N.apiUrl}getAssetsReport(e){return this.httpClient.get(this.apiUrl+"/asset_report/"+e)}getCircuitReport(e){return this.httpClient.get(this.apiUrl+"/circuit_report/"+e)}getAttachment(e){return this.httpClient.get(this.apiUrl+"/document/"+e,{responseType:"arraybuffer"})}publishReportAsett(e,i){return this.httpClient.put(this.apiUrl+"/publish_asset/"+i,e)}publishReportCircuit(e,i){return this.httpClient.put(this.apiUrl+"/publish_circuit/"+i,e)}addQRCode(e){return this.httpClient.post(this.apiUrl+"/qr_code",e)}getQRCode(e){return this.httpClient.get(this.apiUrl+"/qr_code/"+e,{responseType:"arraybuffer"})}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(K.eN))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const tt=["pdfThickness"];function et(n,s){if(1&n&&(t.TgZ(0,"tr")(1,"td",6),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td",6),t._uU(6),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.qZA()()),2&n){const e=s.$implicit,i=s.index,a=t.oxw();t.xp6(2),t.hij(" ",null==e?null:e.name," "),t.xp6(2),t.AsE(" ",(null==a.tableData?null:a.tableData[e.props])||"-"," ",e.unit," "),t.xp6(2),t.hij(" ",null==a.spesificationItem[1][i]?null:a.spesificationItem[1][i].name," "),t.xp6(2),t.AsE(" ",null==a.tableData?null:a.tableData[null==a.spesificationItem[1][i]?null:a.spesificationItem[1][i].props]," ",null==a.spesificationItem[1][i]?null:a.spesificationItem[1][i].unit," ")}}function it(n,s){if(1&n&&(t.TgZ(0,"div")(1,"td",6),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA()()),2&n){const e=s.$implicit,i=t.oxw().$implicit,a=t.oxw();t.xp6(2),t.hij(" ",null==a.tableData||null==a.tableData.piping_visual[i+e]?null:a.tableData.piping_visual[i+e].name," "),t.xp6(2),t.hij(" ",null==a.tableData||null==a.tableData.piping_visual[i+e]?null:a.tableData.piping_visual[i+e].data," ")}}const nt=function(){return[0,1,2]};function at(n,s){1&n&&(t.TgZ(0,"tr"),t.YNc(1,it,5,2,"div",10),t.qZA()),2&n&&(t.xp6(1),t.Q6J("ngForOf",t.DdM(1,nt)))}function st(n,s){if(1&n&&(t.TgZ(0,"div")(1,"td",6),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA()()),2&n){const e=s.$implicit,i=t.oxw().$implicit,a=t.oxw();t.xp6(2),t.hij(" ",null==a.tableData||null==a.tableData.piping_thickness[i+e]?null:a.tableData.piping_thickness[i+e].name," "),t.xp6(2),t.hij(" ",null==a.tableData||null==a.tableData.piping_thickness[i+e]?null:a.tableData.piping_thickness[i+e].data," ")}}const ot=function(){return[0,1]};function rt(n,s){1&n&&(t.TgZ(0,"tr"),t.YNc(1,st,5,2,"div",10),t.qZA()),2&n&&(t.xp6(1),t.Q6J("ngForOf",t.DdM(1,ot)))}function pt(n,s){if(1&n&&(t.TgZ(0,"th"),t._uU(1),t.qZA()),2&n){const e=s.$implicit;t.xp6(1),t.Oqu(null==e?null:e.head)}}function lt(n,s){if(1&n&&(t.TgZ(0,"td"),t._uU(1),t.qZA()),2&n){const e=s.$implicit,i=t.oxw().$implicit;t.xp6(1),t.Oqu(i[null==e?null:e.prop])}}function ct(n,s){if(1&n&&(t.TgZ(0,"tr"),t.YNc(1,lt,2,1,"td",10),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.damageMechanismDetails)}}function ut(n,s){if(1&n&&(t.TgZ(0,"th"),t._uU(1),t.qZA()),2&n){const e=s.$implicit;t.xp6(1),t.Oqu(e)}}function dt(n,s){if(1&n&&(t.TgZ(0,"td"),t._uU(1),t.qZA()),2&n){const e=s.$implicit,i=t.oxw().$implicit;t.xp6(1),t.Oqu(i[e])}}const _t=function(){return["proposal_id","inspection_date","inspection_summary","carried_out"]};function mt(n,s){1&n&&(t.TgZ(0,"tr"),t.YNc(1,dt,2,1,"td",10),t.qZA()),2&n&&(t.xp6(1),t.Q6J("ngForOf",t.DdM(1,_t)))}const ht=function(){return[0,3]},gt=function(){return[0,2,4,6]},ft=function(){return["Insp Id","Insp Date","Insp Summary","Caried Out"]};A().vfs=L.I.vfs;let H=(()=>{class n{constructor(e,i){this.toastr=e,this.reportService=i,this.tableStyle={"font-size":"12px"},this.pdfHead=[{name:"Id",props:"cml_id",width:"*"},{name:"Gauge Point",props:"gauge_point",width:"auto"},{name:"Location",props:"point_location",width:"auto"},{name:"Nom Thickness",props:"nominal_thickness",width:"auto"},{name:"Min Req Thickness",props:"min_required_thickness",width:"auto"},{name:"Last Thick Read",props:"last_thickness_reading",width:"auto"},{name:"Last Thick Date",props:"last_thickness_reading_date",width:"auto"},{name:"Calc CR",props:"calculated_cr",width:"*"}],this.damageMechanismDetails=[{type:"text",prop:"piping_damage_mechanism",head:"Piping Damage Mechanism",width:"200px"},{type:"text",prop:"notes",head:"Notes",width:"200px"},{type:"text",prop:"type_location",head:"Expected Type/Location",width:"200px"},{type:"text",prop:"last_insp_date",head:"Last Insp.Date",width:"200px"},{type:"text",prop:"insp_due_date",head:"Insp. Due Date",width:"200px"}],this.spesificationItem=[[{props:"nominal_pipe_size",name:"Nominal Pipe Size",unit:"mm"},{props:"pipe_design_code",name:"Pipe Design Code"},{props:"schedule",name:"Schedule",unit:"mm"},{props:"outside_diameter",name:"Outside Diameter"},{props:"longtd_quality_factor",name:"Longtd. Quality Factor (E)"},{props:"weld_joint_factor",name:"Weld Joint Factor (W)"},{props:"allowable_unit_stress",name:"Allowable Unit Stress (S)",unit:"psi"},{props:"coefficient",name:"Coefficient (Y)"},{props:"min_design_pressure",name:"Min. Design Pressure (P min)",unit:"psig"}],[{props:"max_design_pressure",name:"Max. Design Pressure (P max)",unit:"psig"},{props:"min_design_temperature",name:"Min. Design Temp (T min)",unit:"F"},{props:"max_design_temperature",name:"Max Design Temp (T max)",unit:"F"},{props:"corrosion_allowance",name:"Corrosion Allowance",unit:"mm"},{props:"mechanical_allowance",name:"Mechanical Allowances",unit:"mm"},{props:"min_structural_thickness",name:"Min. Structural Thickness",unit:"mm"},{props:"min_alert_thickness",name:"Min. Alert Thickness",unit:"mm"},{props:"nominal_thickness",name:"Nominal Thickness",unit:"mm"}]],this.refreshPage=new t.vpe}ngOnInit(){this.randomString=(Math.random()+1).toString(36).substring(7),A().tableLayouts={exampleLayout:{hLineWidth:function(e,i){return 0===e||e===i.table.body.length?0:e===i.table.headerRows?2:1},vLineWidth:function(e){return 0},hLineColor:function(e){return 1===e?"black":"#aaa"},paddingLeft:function(e){return 0===e?0:8},paddingRight:function(e,i){return e===i.table.widths.length-1?0:8}}}}printAsPDF(e){this.tableData=e,setTimeout(()=>{this.downloadAsPDF().print()},500)}publishReport(e){this.tableData=e,setTimeout(()=>{const i=this.downloadAsPDF();i.getBlob(a=>{var o;const r=null===(o=this.tableData)||void 0===o?void 0:o.piping_name,g=new File([a],r+".pdf"),p=new FormData;p.append("qr_code",g),p.append("title",this.randomString),this.reportService.addQRCode(p).subscribe(()=>this.toastr.success("Your Report has been published.","QR Code has been added."),()=>this.toastr.danger("Your Report failed to published.","Failed to generate qr code.")),this.reportService.publishReportAsett({qr_code:this.randomString},this.tableData.id).subscribe(()=>this.toastr.success("Your Report has been published.","Success Publish Report."),()=>this.toastr.danger("Your Report failed to published.","Failed Publish Report."),()=>this.refreshPage.emit(!0))}),i.download()},500)}downloadAsPDF(){var e;const i=this.pdfThickness.nativeElement;let a=Q()(i.innerHTML);(null===(e=this.tableData)||void 0===e?void 0:e.qr_code)&&(a[2].table.body[0][2].stack[0]={qr:x.N.apiUrl+"/qr_code/"+this.tableData.qr_code,fit:"135"}),this.tableData.qr_code||(a[2].table.body[0][2].stack[0]={qr:x.N.apiUrl+"/qr_code/"+this.randomString,fit:"135"}),a[2].table.body[0][2].stack[1]={text:this.tableData.piping_id,alignment:"center",bold:!0};const o={content:[a,{image:this.tableData.thickness_chart,fit:[500,500]},{image:this.tableData.remaining_chart,fit:[500,500]},{image:this.tableData.corrosion_chart,fit:[500,500]}],pageBreakBefore:function(r){return r.style&&r.style.indexOf("pdf-pagebreak-before")>-1}};return A().createPdf(o)}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(l.quB),t.Y36(P))},n.\u0275cmp=t.Xpm({type:n,selectors:[["report-assets-pdf"]],viewQuery:function(e,i){if(1&e&&t.Gf(tt,5),2&e){let a;t.iGM(a=t.CRH())&&(i.pdfThickness=a.first)}},outputs:{refreshPage:"refresh"},decls:61,vars:15,consts:[[1,"container",2,"display","none"],["id","Thickness"],["pdfThickness",""],[2,"width","100%","margin","0 0 1rem 0","color","#5588EE"],[2,"margin","1rem 0 0 0"],["data-pdfmake","{'layout' : 'noBorders', 'widths' : ['20%', '55%', '*']}"],[2,"color","darkgray"],["rowspan","4",1,"qr_code"],[2,"color","darkgray","font-size","8px"],["data-pdfmake","{'layout' : 'noBorders', 'widths' : ['35%', '15%', '35%', '15%']}"],[4,"ngFor","ngForOf"],["data-pdfmake","{'layout' : 'noBorders', 'widths' : ['*', '*', '*', '*', '*', '*']}"],["data-pdfmake","{'layout' : 'noBorders', 'widths' : ['*', '*', '*', '*']}"],["data-pdfmake","{'layout' : 'noBorders', 'widths' : ['*', '*', '*', '*', '*']}"],[1,"pdf-pagebreak-before",2,"margin","1rem 0 0 0"],["data-pdfmake","{'layout' : 'noBorders', 'widths' : ['*', '*', '*', '10%']}"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0)(1,"div",1,2)(3,"h5",3),t._uU(4),t.qZA(),t.TgZ(5,"span",4)(6,"b"),t._uU(7,"Pipe Details"),t.qZA()(),t.TgZ(8,"table",5)(9,"tr")(10,"td",6),t._uU(11," Date in Service "),t.qZA(),t.TgZ(12,"td"),t._uU(13),t.qZA(),t.TgZ(14,"td",7)(15,"div",8),t._uU(16,"QR Code Not Available"),t.qZA()()(),t.TgZ(17,"tr")(18,"td",6),t._uU(19," Class "),t.qZA(),t.TgZ(20,"td"),t._uU(21),t.qZA()(),t.TgZ(22,"tr")(23,"td",6),t._uU(24," Notes "),t.qZA(),t.TgZ(25,"td"),t._uU(26),t.qZA()(),t.TgZ(27,"tr")(28,"td",6),t._uU(29," Recomendation "),t.qZA(),t.TgZ(30,"td"),t._uU(31),t.qZA()()(),t.TgZ(32,"table",9),t.YNc(33,et,9,6,"tr",10),t.qZA(),t.TgZ(34,"span",4)(35,"b"),t._uU(36,"Pipe Visual"),t.qZA()(),t.TgZ(37,"table",11),t.YNc(38,at,2,2,"tr",10),t.qZA(),t.TgZ(39,"span",4)(40,"b"),t._uU(41,"Pipe Calculation"),t.qZA()(),t.TgZ(42,"table",12),t.YNc(43,rt,2,2,"tr",10),t.qZA(),t.TgZ(44,"span",4)(45,"b"),t._uU(46,"Pipe Damage Mechanism"),t.qZA()(),t.TgZ(47,"table",13)(48,"tr"),t.YNc(49,pt,2,1,"th",10),t.qZA(),t.YNc(50,ct,2,1,"tr",10),t.qZA(),t.TgZ(51,"span",14)(52,"b"),t._uU(53,"Inspection History"),t.qZA()(),t.TgZ(54,"table",15)(55,"tr"),t.YNc(56,ut,2,1,"th",10),t.qZA(),t.YNc(57,mt,2,2,"tr",10),t.qZA(),t.TgZ(58,"span",4)(59,"b"),t._uU(60,"Trend"),t.qZA()()()()),2&e&&(t.xp6(4),t.hij("Report ",null==i.tableData?null:i.tableData.piping_id,""),t.xp6(9),t.hij(" ",null==i.tableData?null:i.tableData.date_in_service," "),t.xp6(8),t.hij(" ",null==i.tableData?null:i.tableData.class," "),t.xp6(5),t.hij(" ",null==i.tableData?null:i.tableData.notes," "),t.xp6(5),t.hij(" ",(null==i.tableData?null:i.tableData.recomendation)||"-"," "),t.xp6(2),t.Q6J("ngForOf",i.spesificationItem[0]),t.xp6(5),t.Q6J("ngForOf",t.DdM(12,ht)),t.xp6(5),t.Q6J("ngForOf",t.DdM(13,gt)),t.xp6(6),t.Q6J("ngForOf",i.damageMechanismDetails),t.xp6(1),t.Q6J("ngForOf",null==i.tableData?null:i.tableData.damage_mechanism),t.xp6(6),t.Q6J("ngForOf",t.DdM(14,ft)),t.xp6(1),t.Q6J("ngForOf",null==i.tableData?null:i.tableData.inspection))},directives:[f.sg],encapsulation:2}),n})(),Y=(()=>{class n extends q.Z{constructor(){super(),this.defineOptions({chartTitle:"Corrosion Rate vs Year",yTitle:"CR",xTitle:"Piping"})}ngOnInit(){this.generateChart("DashboardCorrosion")}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=t.Xpm({type:n,selectors:[["ngx-dashboard-corrosion-chart"]],features:[t.qOj],decls:1,vars:0,consts:[["id","DashboardCorrosion"]],template:function(e,i){1&e&&t._UZ(0,"canvas",0)},encapsulation:2}),n})();var j=c(7024),bt=c(9371),y=c(4204),U=c(7531),xt=c(4039);const B=function(){return{show:!1}};function Tt(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"ngx-mat-table",1),t.NdJ("onClickTable",function(a){return t.CHM(e),t.oxw().onClickTable(a)}),t.qZA()}if(2&n){const e=t.oxw();t.Q6J("tableHeader",t.DdM(4,B))("tableFooter",t.DdM(5,B))("columnDetails",e.inspectionHistoryDetails)("tableData",e.tableData)}}let $=(()=>{class n{constructor(e,i,a){this.toastr=e,this.proposalService=i,this.datePipe=a,this.tableData=[],this.inspectionHistoryDetails=[{type:"text",prop:"proposal_id",head:"Inspection Id",width:"100px"},{type:"editable date",prop:"inspection_date",head:"Inspection Date",width:"200px"},{type:"text",prop:"inspection_summary",head:"Inspection Summary",width:"300px"},{type:"text",prop:"coverage",head:"%",width:"30px"},{type:"check",prop:"carried_out",head:"Caried Out",width:"50px"}]}ngOnInit(){this.tableData=this.tableData.map((e,i)=>{const{inspection_date:a}=e;return Object.assign(Object.assign({},e),{method_index:i,inspection_date:a?new Date(a):null})})}onClickTable({$event:e,element:i}){let{inspection_date:a,id:o,inspection_method:r,method_index:g}=i;if(!a)return this.toastr.danger("Please input Inspection date","Inspection Date is Empty");a=this.datePipe.transform(a,"yyyy-MM-dd"),console.log(a),r[g]=Object.assign(Object.assign({},r[g]),{carried_out:e,inspection_date:a}),i=Object.assign(Object.assign({},i),{inspection_method:r}),this.proposalService.updateProposal(i,o).subscribe(()=>this.ngOnInit(),()=>this.toastr.danger("Please check your connection and try again.","Your request failed."),()=>this.toastr.success("Data has been updated.","Your request success."))}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(l.quB),t.Y36(xt.R),t.Y36(f.uU))},n.\u0275cmp=t.Xpm({type:n,selectors:[["ngx-inspection_history_table"]],inputs:{tableData:"tableData"},decls:1,vars:1,consts:[[3,"tableHeader","tableFooter","columnDetails","tableData","onClickTable",4,"ngIf"],[3,"tableHeader","tableFooter","columnDetails","tableData","onClickTable"]],template:function(e,i){1&e&&t.YNc(0,Tt,1,6,"ngx-mat-table",0),2&e&&t.Q6J("ngIf",i.tableData.length)},directives:[f.O5,w.V],encapsulation:2}),n})();function Zt(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"nb-option",30),t.NdJ("click",function(){const o=t.CHM(e).$implicit;return t.oxw().filterByClass(o)}),t._uU(1),t.qZA()}if(2&n){const e=s.$implicit;t.Q6J("value",e),t.xp6(1),t.Oqu(e)}}function Dt(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"nb-option",30),t.NdJ("click",function(){const o=t.CHM(e).$implicit;return t.oxw().filterByClass(o)}),t._uU(1),t.qZA()}if(2&n){const e=s.$implicit;t.Q6J("value",e),t.xp6(1),t.Oqu(e)}}function vt(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"nb-option",30),t.NdJ("click",function(){const o=t.CHM(e).$implicit;return t.oxw().filterByClass(o)}),t._uU(1),t.qZA()}if(2&n){const e=s.$implicit;t.Q6J("value",e),t.xp6(1),t.Oqu(e)}}function At(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"nb-option",30),t.NdJ("click",function(){const o=t.CHM(e).$implicit;return t.oxw().filterByMawp(o)}),t._uU(1),t.qZA()}if(2&n){const e=s.$implicit;t.Q6J("value",e),t.xp6(1),t.Oqu(e)}}const Ct=function(){return{width:"40px"}};function yt(n,s){1&n&&(t.TgZ(0,"th",31),t._uU(1," Piping ID "),t.qZA()),2&n&&t.Q6J("ngStyle",t.DdM(1,Ct))}const Rt=function(n){return{color:n}};function wt(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"td",32,33),t.NdJ("mouseover",function(){return t.CHM(e),t.MAs(1).style.color="#0492c2"})("mouseout",function(){const o=t.CHM(e).$implicit;return t.MAs(1).style.color=t.oxw().pipeData==o?"#0492c2":"black"})("click",function(){const o=t.CHM(e).$implicit;return t.oxw().showData(o)}),t._uU(2),t.qZA()}if(2&n){const e=s.$implicit,i=t.oxw();t.Q6J("ngStyle",t.VKq(2,Rt,i.pipeData==e?"#0492c2":"black")),t.xp6(2),t.hij(" ",e.piping_id," ")}}function qt(n,s){1&n&&t._UZ(0,"tr",34)}function Pt(n,s){1&n&&t._UZ(0,"tr",35)}function kt(n,s){1&n&&(t.TgZ(0,"h5"),t._uU(1,"Please Add Asset Data."),t.qZA())}function Ut(n,s){1&n&&(t.TgZ(0,"span"),t._uU(1,"No Image Available"),t.qZA())}function Ft(n,s){if(1&n&&(t.TgZ(0,"div",57)(1,"div",58),t._UZ(2,"img",59),t.qZA()()),2&n){const e=s.$implicit;t.Q6J("ngClass",0==s.index?"active":""),t.xp6(2),t.Q6J("src",e.src,t.LSH)("alt",null==e?null:e.alt)}}function Mt(n,s){if(1&n&&(t.TgZ(0,"div",60),t._UZ(1,"ngx-qrcode",61),t.qZA()),2&n){const e=t.oxw(2);t.xp6(1),t.Q6J("elementType",e.elementType)("errorCorrectionLevel",e.correctionLevel)("value",e.reportURL)}}function Ot(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"button",62),t.NdJ("click",function(){t.CHM(e);const a=t.oxw(2);return a.pdfReportAssets.publishReport(a.reportData)}),t._uU(1," Publish Report "),t.qZA()}}function Nt(n,s){if(1&n&&(t.TgZ(0,"div",63)(1,"span",64),t._uU(2),t.qZA(),t.TgZ(3,"span",4),t._uU(4),t.qZA()()),2&n){const e=s.$implicit,i=t.oxw(2);t.xp6(2),t.Oqu(e.name),t.xp6(2),t.Oqu(i.reportData[e.props])}}function St(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"section")(1,"h6",21),t._uU(2),t.qZA(),t.TgZ(3,"div",10)(4,"div",36)(5,"div",37)(6,"div",38),t.YNc(7,Ut,2,0,"span",20),t.YNc(8,Ft,3,3,"div",39),t.qZA(),t.TgZ(9,"button",40),t._UZ(10,"span",41),t.TgZ(11,"span",42),t._uU(12,"Previous"),t.qZA()(),t.TgZ(13,"button",43),t._UZ(14,"span",44),t.TgZ(15,"span",42),t._uU(16,"Next"),t.qZA()()()(),t.TgZ(17,"div",45)(18,"div"),t.YNc(19,Mt,2,3,"div",46),t.YNc(20,Ot,2,0,"button",47),t.TgZ(21,"div",48)(22,"button",49),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return a.pdfReportAssets.printAsPDF(a.reportData)}),t._UZ(23,"nb-icon",50),t.qZA(),t.TgZ(24,"button",51),t.NdJ("click",function(){return t.CHM(e),t.oxw().seeDocument()}),t._UZ(25,"nb-icon",52),t.qZA()()()()(),t.TgZ(26,"div")(27,"span",53),t._uU(28,"Comment"),t.qZA(),t.TgZ(29,"span",54),t._uU(30),t.qZA()(),t.TgZ(31,"div",55)(32,"span",56),t._uU(33,"Date In Service"),t.qZA(),t.TgZ(34,"span",36),t._uU(35),t.qZA(),t.TgZ(36,"span",56),t._uU(37,"Class"),t.qZA(),t.TgZ(38,"span",36),t._uU(39),t.qZA(),t.TgZ(40,"span",56),t._uU(41,"Notes"),t.qZA(),t.TgZ(42,"span",36),t._uU(43),t.qZA()(),t.TgZ(44,"span",53),t._uU(45,"Recomendation"),t.qZA(),t.TgZ(46,"p"),t._uU(47),t.qZA(),t.TgZ(48,"div",25),t.YNc(49,Nt,5,2,"div",26),t.qZA()()}if(2&n){const e=t.oxw();t.xp6(2),t.hij("Piping Assets ",null==e.reportData?null:e.reportData.piping_id,""),t.xp6(5),t.Q6J("ngIf",!e.imageLink),t.xp6(1),t.Q6J("ngForOf",e.imageLink),t.xp6(11),t.Q6J("ngIf",e.reportURL),t.xp6(1),t.Q6J("ngIf",!e.reportURL),t.xp6(4),t.Q6J("disabled",!(null!=e.reportData&&e.reportData.attachment)),t.xp6(6),t.Oqu((null==e.reportData?null:e.reportData.comment)||"-"),t.xp6(5),t.Oqu((null==e.reportData?null:e.reportData.date_in_service)||"-"),t.xp6(4),t.Oqu((null==e.reportData?null:e.reportData.class)||"-"),t.xp6(4),t.Oqu((null==e.reportData?null:e.reportData.notes)||"-"),t.xp6(4),t.Oqu((null==e.reportData?null:e.reportData.recomendation)||"-"),t.xp6(2),t.Q6J("ngForOf",e.spesificationItem)}}function It(n,s){if(1&n&&(t.TgZ(0,"div",10)(1,"span",65),t._uU(2),t.qZA(),t.TgZ(3,"span",4),t._uU(4),t.qZA()()),2&n){const e=s.$implicit;t.xp6(2),t.Oqu(e.name),t.xp6(2),t.Oqu(e.data||"-")}}function Jt(n,s){if(1&n&&(t.TgZ(0,"div",63)(1,"span",64),t._uU(2),t.qZA(),t.TgZ(3,"span",4),t._uU(4),t.qZA()()),2&n){const e=s.$implicit;t.xp6(2),t.Oqu(e.name),t.xp6(2),t.Oqu((null==e?null:e.data)||"-")}}function Lt(n,s){1&n&&(t.TgZ(0,"span"),t._uU(1,"Data Not Available"),t.qZA())}const F=function(){return{show:!1}};function Qt(n,s){if(1&n&&t._UZ(0,"ngx-inspection_history_table",66),2&n){const e=t.oxw();t.Q6J("tableHeader",t.DdM(3,F))("tableFooter",t.DdM(4,F))("tableData",e.inspectionHistoryData)}}const Ht=function(){return["All",1,2,3,4]},Yt=function(){return["No Filter","Excellent","Good","Average","Below Average","Poor"]},jt=function(){return["No Filter","Low","Medium","High"]},Bt=function(){return["No Filter","Normal","Abnormal"]},$t=function(){return{pageSize:5}};let Et=(()=>{class n{constructor(e,i,a,o){this.reportService=e,this.variables=i,this.toastr=a,this.thicknesService=o,this.elementType=D.TT.URL,this.correctionLevel=D.Jk.HIGH,this.tablePosition=[],this.displayedColumns=["piping_id"],this.resultsLength=0,this.imageLink=[],this.spesificationItem=[{props:"nominal_pipe_size",name:"Nominal Pipe Size",unit:"mm"},{props:"pipe_design_code",name:"Pipe Design Code"},{props:"schedule",name:"Schedule",unit:"mm"},{props:"outside_diameter",name:"Outside Diameter"},{props:"longtd_quality_factor",name:"Longtd. Quality Factor (E)"},{props:"weld_joint_factor",name:"Weld Joint Factor (W)"},{props:"allowable_unit_stress",name:"Allowable Unit Stress (S)",unit:"psi"},{props:"coefficient",name:"Coefficient (Y)"},{props:"min_design_pressure",name:"Min. Design Pressure (P min)",unit:"psig"},{props:"max_design_pressure",name:"Max. Design Pressure (P max)",unit:"psig"},{props:"min_design_temperature",name:"Min. Design Temperature (T min)",unit:"F"},{props:"max_design_temperature",name:"Max Design Temperature (T max)",unit:"F"},{props:"corrosion_allowance",name:"Corrosion Allowance",unit:"mm"},{props:"mechanical_allowance",name:"Mechanical Allowances",unit:"mm"},{props:"min_structural_thickness",name:"Min. Structural Thickness",unit:"mm"},{props:"min_alert_thickness",name:"Min. Alert Thickness",unit:"mm"},{props:"nominal_thickness",name:"Nominal Thickness",unit:"mm"}],this.pipingVisual=[{name:"Leaks",props:"leaks_condition",data:null},{name:"Misalignment",props:"misalignment_condition",data:null},{name:"Vibration",props:"vibration_condition",data:null},{name:"Supports",props:"supports_condition",data:null},{name:"Corrosion",props:"corrosion_condition",data:null},{name:"Insulation",props:"insulation_condition",data:null}],this.pipingThickness=[{name:"Reading",props:"reading"},{name:"Long Term Cr",props:"lt_cr"},{name:"Remaining Life",props:"remaining_life"},{name:"Thick. Min",props:"t_min"},{name:"Short Term CR",props:"st_cr"},{name:"Half Life",props:"half_life"},{name:"Retirement Date",props:"retirement_date"}],this.damageMechanismDetails=[{type:"text",prop:"piping_damage_mechanism",head:"Piping Damage Mechanism",width:"200px"},{type:"text",prop:"notes",head:"Notes",width:"200px"},{type:"text",prop:"type_location",head:"Expected Type/Location",width:"200px"},{type:"text",prop:"last_insp_date",head:"Last Insp.Date",width:"200px"},{type:"text",prop:"insp_due_date",head:"Insp. Due Date",width:"200px"}],this.inspectionHistoryData=[]}ngOnInit(){this.thicknesService.getDataThickness().subscribe(({data:e})=>{this.tablePosition=e;const i=e[0];!i||(this.showData(i),this.getReportData(null==i?void 0:i.id),this.dataSource=new u.by(e),this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort)},()=>this.toastr.danger("Please add asset data.","Data not found."))}getReportData(e){this.reportService.getAssetsReport(e).subscribe(({data:{damage_mechanism:i,visual_condition:a,asset:o,cml:r,proposals:g=[]}})=>{var p,h;this.damageMechanismData=null===(p=this.variables.damageMechanismName)||void 0===p?void 0:p.map(({id:d,piping_damage_mechanism:_})=>{const m=null==i?void 0:i[d];return m?Object.assign(Object.assign({},m),{piping_damage_mechanism:_}):null}).filter(d=>null!=d),this.viewTable.regenerateTable(this.damageMechanismData),this.pipingVisual=this.pipingVisual.map(({name:d,props:_})=>{var m;return{name:d,props:_,data:null!==(m=a[_])&&void 0!==m?m:null}});let b=[];for(let d of g)null===(h=null==d?void 0:d.inspection_method)||void 0===h||h.forEach(({type:_,method:m,technique:T,coverage:v,active:R})=>{b.push(Object.assign(Object.assign({},d),{inspection_summary:` ${_} ${m} ${T}`,type:_,method:m,technique:T,coverage:v,active:R}))});this.inspectionHistoryData=b,this.pipingThickness=this.pipingThickness.map(({name:d,props:_})=>{const{reading:m,min_required_thickness:T,lt_cr:v,st_cr:R,remaining_life:O,half_life:N,retirement_date:Ie,next_tm_insp_date:Je,next_ve_insp_date:Le,mawp:Qe}=this.variables.getThicknessCalculation(Object.assign(Object.assign({},o),{cml:r}));return{name:d,props:_,data:Object.assign(Object.assign({},o),{reading:m.toFixed(4),t_min:T.toFixed(4),lt_cr:v.toFixed(4),st_cr:R.toFixed(4),remaining_life:O.toFixed(4),half_life:N.toFixed(4),retirement_date:Ie,next_tm_insp_date:Je,next_ve_insp_date:Le,mawp:Qe.toFixed(4)})[_]}}),this.reportData=Object.assign(Object.assign({},o),{corrosion_allowance:o.corrosion_allowance,mechanical_allowance:o.mechanical_allowance,nominal_thickness:o.nominal_thickness,damage_mechanism:this.damageMechanismData,piping_visual:this.pipingVisual,inspection:this.inspectionHistoryData,piping_thickness:this.pipingThickness,thickness_chart:this.thicknessChart.chart.toBase64Image(),remaining_chart:this.remainingChart.chart.toBase64Image(),corrosion_chart:this.corrosionChart.chart.toBase64Image()})},()=>this.toastr.danger("Please add asset data.","Data not found."))}seeDocument(){var e;this.reportService.getAttachment(null===(e=this.pipeData)||void 0===e?void 0:e.attachment).subscribe(i=>{this.toastr.info("Getting your document. Please Wait...","Download PDF");const a=new Blob([i],{type:"application/pdf"}),o=URL.createObjectURL(a);window.open(o)})}showData(e){var i;const a=e.qr_code;this.getReportData(e.id),a&&(this.reportURL=x.N.apiUrl+"/qr_code/"+e.qr_code),a||(this.reportURL=null),this.pipeData=e,this.imageLink="object"==typeof e.images?null===(i=null==e?void 0:e.images)||void 0===i?void 0:i.map(o=>({src:x.N.apiUrl+"/image/"+o,alt:"Pipe Asssets"})):[],e&&(this.variables.removeChartData(this.thicknessChart),this.variables.removeChartData(this.remainingChart),this.variables.removeChartData(this.corrosionChart),this.thicknessChartData(this.thicknessChart,e),this.remainingLifeChartData(this.remainingChart,e),this.remainingLifeChartData(this.corrosionChart,e))}thicknessChartData(e,{cml:i}){const{datasets:a,allYear:o}=this.variables.getCharCML(i,"last_thickness_reading");e.data.labels=o,e.chart.data.datasets=a,e.chart.update()}corrosionChartData(e,i){const a=this.variables.getCMLCalc(i),{datasets:o,allYear:r}=this.variables.getCharCML(a,"lt_cr");e.data.labels=r,e.chart.data.datasets=o,e.chart.update()}remainingLifeChartData(e,i){const a=this.variables.getCMLCalc(i),{datasets:o,allYear:r}=this.variables.getCharCML(a,"remaining_life");e.data.labels=r,e.chart.data.datasets=o,e.chart.update()}filterByClass(e){let i=this.tablePosition.filter(a=>a.class==e);"All"==e&&(i=this.tablePosition),this.dataSource=new u.by(i)}filterByMawp(e){if("No Filter"==e)return this.dataSource=new u.by(this.tablePosition);const i=this.variables.sortByMawp(this.tablePosition,e);this.dataSource=new u.by(i)}applyFilter(e){this.dataSource.filter=e.target.value.trim().toLowerCase(),this.dataSource.paginator&&this.dataSource.paginator.firstPage()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(P),t.Y36(j.L),t.Y36(l.quB),t.Y36(bt.O))},n.\u0275cmp=t.Xpm({type:n,selectors:[["ngx-report-piping-assets"]],viewQuery:function(e,i){if(1&e&&(t.Gf(w.V,5),t.Gf(C.NW,5),t.Gf(Z.YE,5),t.Gf(I,5),t.Gf(J,5),t.Gf(Y,5),t.Gf(H,5)),2&e){let a;t.iGM(a=t.CRH())&&(i.viewTable=a.first),t.iGM(a=t.CRH())&&(i.paginator=a.first),t.iGM(a=t.CRH())&&(i.sort=a.first),t.iGM(a=t.CRH())&&(i.thicknessChart=a.first),t.iGM(a=t.CRH())&&(i.remainingChart=a.first),t.iGM(a=t.CRH())&&(i.corrosionChart=a.first),t.iGM(a=t.CRH())&&(i.pdfReportAssets=a.first)}},decls:71,vars:30,consts:[[1,"d-flex","justify-content-between"],["matInput","","placeholder","Ex. Mia",3,"keyup"],["input",""],[1,"row","row-cols-4"],[1,"col"],["placeholder","Class","status","primary","size","small",1,"",3,"selected"],[3,"value","click",4,"ngFor","ngForOf"],["placeholder","Conditions","status","primary","size","small",1,"",3,"selected"],["placeholder","Susceptibility","status","primary","size","small",1,"",3,"selected"],["placeholder","MAWP","status","primary","size","small",1,"",3,"selected"],[1,"row"],[1,"col-3"],["mat-table","","matSort","",1,"mat-elevation-z8",2,"width","100%","box-shadow","none",3,"dataSource"],["matColumnDef","piping_id"],["mat-header-cell","","mat-sort-header","",3,"ngStyle",4,"matHeaderCellDef"],["mat-cell","","style","cursor : pointer",3,"ngStyle","mouseover","mouseout","click",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",4,"matRowDef","matRowDefColumns"],["aria-label","Select page of GitHub search results",3,"length","pageSize"],[1,"col-9"],[4,"ngIf"],[1,"fw-bolder","text-primary","mb-2","d-block"],[1,"row","row-cols-3"],["class","row",4,"ngFor","ngForOf"],[1,"mt-2"],[1,"row","row-cols-2","mt-3"],["class","row mb-2",4,"ngFor","ngForOf"],[3,"tableHeader","tableFooter","columnDetails","tableData"],[3,"tableHeader","tableFooter","tableData",4,"ngIf"],[3,"refresh"],[3,"value","click"],["mat-header-cell","","mat-sort-header","",3,"ngStyle"],["mat-cell","",2,"cursor","pointer",3,"ngStyle","mouseover","mouseout","click"],["nameCell",""],["mat-header-row",""],["mat-row",""],[1,"col-8"],["id","carouselExampleInterval","data-bs-ride","carousel",1,"carousel","slide"],[1,"carousel-inner"],["class","carousel-item","data-bs-interval","10000",3,"ngClass",4,"ngFor","ngForOf"],["type","button","data-bs-target","#carouselExampleInterval","data-bs-slide","prev",1,"carousel-control-prev"],["aria-hidden","true",1,"carousel-control-prev-icon"],[1,"visually-hidden"],["type","button","data-bs-target","#carouselExampleInterval","data-bs-slide","next",1,"carousel-control-next"],["aria-hidden","true",1,"carousel-control-next-icon"],[1,"col-4","d-flex","justify-content-center","align-self-center"],["class","border rounded",4,"ngIf"],["nbButton","","status","primary","class","mt-2 me-2 w-100","size","small","outline","",3,"click",4,"ngIf"],[1,"d-flex"],["nbButton","","status","primary","size","small","outline","","nbPopover","Print Report","nbPopoverTrigger","hint",1,"mt-2","me-2","w-100",3,"click"],["icon","printer-outline"],["nbButton","","status","primary","size","small","outline","","nbPopover","See Attachment","nbPopoverTrigger","hint",1,"mt-2","ms-2","w-100",3,"disabled","click"],["icon","file-text-outline"],[1,"text-secondary"],[1,"d-block"],[1,"row","mt-3"],[1,"text-secondary","col-4"],["data-bs-interval","10000",1,"carousel-item",3,"ngClass"],[1,"overflow-hidden","d-flex","align-justify-center",2,"height","15rem"],[1,"w-100","img-fluid",3,"src","alt"],[1,"border","rounded"],[3,"elementType","errorCorrectionLevel","value"],["nbButton","","status","primary","size","small","outline","",1,"mt-2","me-2","w-100",3,"click"],[1,"row","mb-2"],[1,"col-8","text-secondary"],[1,"col","text-secondary"],[3,"tableHeader","tableFooter","tableData"]],template:function(e,i){1&e&&(t.TgZ(0,"nb-card")(1,"nb-card-header",0)(2,"div")(3,"h5"),t._uU(4,"Piping Assets"),t.qZA(),t.TgZ(5,"mat-form-field")(6,"mat-label"),t._uU(7,"Hit Enter To Search"),t.qZA(),t.TgZ(8,"input",1,2),t.NdJ("keyup",function(o){return i.applyFilter(o)}),t.qZA()()(),t.TgZ(10,"div",3)(11,"div",4),t._uU(12,"Class"),t.qZA(),t.TgZ(13,"div",4)(14,"nb-select",5),t.YNc(15,Zt,2,2,"nb-option",6),t.qZA()(),t.TgZ(16,"div",4),t._uU(17,"Conditions"),t.qZA(),t.TgZ(18,"div",4)(19,"nb-select",7),t.YNc(20,Dt,2,2,"nb-option",6),t.qZA()(),t.TgZ(21,"div",4),t._uU(22,"Susceptibility"),t.qZA(),t.TgZ(23,"div",4)(24,"nb-select",8),t.YNc(25,vt,2,2,"nb-option",6),t.qZA()(),t.TgZ(26,"div",4),t._uU(27,"MAWP"),t.qZA(),t.TgZ(28,"div",4)(29,"nb-select",9),t.YNc(30,At,2,2,"nb-option",6),t.qZA()()()(),t.TgZ(31,"nb-card-body",10)(32,"div",11)(33,"table",12),t.ynx(34,13),t.YNc(35,yt,2,2,"th",14),t.YNc(36,wt,3,4,"td",15),t.BQk(),t.YNc(37,qt,1,0,"tr",16),t.YNc(38,Pt,1,0,"tr",17),t.qZA(),t._UZ(39,"mat-paginator",18),t.qZA(),t.TgZ(40,"div",19),t.YNc(41,kt,2,0,"h5",20),t.TgZ(42,"nb-card")(43,"nb-card-body"),t.YNc(44,St,50,12,"section",20),t.TgZ(45,"section")(46,"h6",21),t._uU(47,"Piping Visual"),t.qZA(),t.TgZ(48,"div",22),t.YNc(49,It,5,2,"div",23),t.qZA()(),t.TgZ(50,"section",24)(51,"h6",21),t._uU(52,"Piping Calculation"),t.qZA(),t.TgZ(53,"div",25),t.YNc(54,Jt,5,2,"div",26),t.qZA()(),t.TgZ(55,"section")(56,"h6",21),t._uU(57,"Piping Damage Mechanism"),t.qZA(),t._UZ(58,"ngx-mat-table",27),t.qZA(),t.TgZ(59,"section")(60,"h6",21),t._uU(61,"Inspection History"),t.qZA(),t.YNc(62,Lt,2,0,"span",20),t.YNc(63,Qt,1,5,"ngx-inspection_history_table",28),t.qZA(),t.TgZ(64,"section")(65,"h6",21),t._uU(66,"Trend"),t.qZA(),t._UZ(67,"ngx-dashboard-remaining-chart")(68,"ngx-dashboard-thickness-chart")(69,"ngx-dashboard-corrosion-chart"),t.qZA()()()()()(),t.TgZ(70,"report-assets-pdf",29),t.NdJ("refresh",function(){return i.ngOnInit()}),t.qZA()),2&e&&(t.xp6(14),t.Q6J("selected","All"),t.xp6(1),t.Q6J("ngForOf",t.DdM(24,Ht)),t.xp6(4),t.Q6J("selected","No Filter"),t.xp6(1),t.Q6J("ngForOf",t.DdM(25,Yt)),t.xp6(4),t.Q6J("selected","No Filter"),t.xp6(1),t.Q6J("ngForOf",t.DdM(26,jt)),t.xp6(4),t.Q6J("selected","No Filter"),t.xp6(1),t.Q6J("ngForOf",t.DdM(27,Bt)),t.xp6(3),t.Q6J("dataSource",i.dataSource),t.xp6(4),t.Q6J("matHeaderRowDef",i.displayedColumns)("matHeaderRowDefSticky",!0),t.xp6(1),t.Q6J("matRowDefColumns",i.displayedColumns),t.xp6(1),t.Q6J("length",i.resultsLength)("pageSize",30),t.xp6(2),t.Q6J("ngIf",!i.reportData),t.xp6(3),t.Q6J("ngIf",i.reportData),t.xp6(5),t.Q6J("ngForOf",i.pipingVisual),t.xp6(5),t.Q6J("ngForOf",i.pipingThickness),t.xp6(4),t.Q6J("tableHeader",t.DdM(28,F))("tableFooter",t.DdM(29,$t))("columnDetails",i.damageMechanismDetails)("tableData",i.damageMechanismData),t.xp6(4),t.Q6J("ngIf",!i.inspectionHistoryData.length),t.xp6(1),t.Q6J("ngIf",i.inspectionHistoryData.length))},directives:[l.Asz,l.ndF,y.KE,y.hX,U.Nt,l.rs,f.sg,l.q51,l.yKW,u.BZ,Z.YE,u.w1,u.fO,u.ge,Z.nU,f.PC,u.Dz,u.ev,u.as,u.XQ,u.nj,u.Gk,C.NW,f.O5,f.mk,D.zF,l.DPz,l.ydg,l.fMN,w.V,$,J,I,Y,H],encapsulation:2}),n})(),E=(()=>{class n extends q.Z{constructor(){super(),this.chartType="bar",this.yLabels=[],this.legendPosition="bottom",this.showRightSclae=!0,this.datasets=[],this.defineOptions({chartTitle:"Chart Piping Circuit"})}ngOnInit(){this.generateChart("piping_circuit_chart")}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=t.Xpm({type:n,selectors:[["ngx-piping-circuit-chart"]],features:[t.qOj],decls:1,vars:0,consts:[["id","piping_circuit_chart"]],template:function(e,i){1&e&&t._UZ(0,"canvas",0)},encapsulation:2}),n})();const zt=["pdfThickness"];function Gt(n,s){if(1&n&&(t.TgZ(0,"div")(1,"td",6),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA()()),2&n){const e=s.$implicit,i=t.oxw().$implicit,a=t.oxw();t.xp6(2),t.hij(" ",null==a.tableData||null==a.tableData.piping_visual[i+e]?null:a.tableData.piping_visual[i+e].name," "),t.xp6(2),t.hij(" ",null==a.tableData||null==a.tableData.piping_visual[i+e]?null:a.tableData.piping_visual[i+e].data," ")}}const Vt=function(){return[0,1,2]};function Wt(n,s){1&n&&(t.TgZ(0,"tr"),t.YNc(1,Gt,5,2,"div",10),t.qZA()),2&n&&(t.xp6(1),t.Q6J("ngForOf",t.DdM(1,Vt)))}function Xt(n,s){if(1&n&&(t.TgZ(0,"th")(1,"b",17),t._uU(2),t.qZA()()),2&n){const e=s.$implicit;t.xp6(2),t.Oqu(e.name)}}function Kt(n,s){if(1&n&&(t.TgZ(0,"td"),t._uU(1),t.qZA()),2&n){const e=s.$implicit,i=t.oxw().$implicit;t.xp6(1),t.hij(" ",null==i?null:i[e.props]," ")}}function te(n,s){if(1&n&&(t.TgZ(0,"tr"),t.YNc(1,Kt,2,1,"td",10),t.qZA()),2&n){const e=t.oxw(2);t.xp6(1),t.Q6J("ngForOf",e.thickness)}}function ee(n,s){if(1&n&&(t.TgZ(0,"table",16)(1,"tr"),t.YNc(2,Xt,3,1,"th",10),t.qZA(),t.YNc(3,te,2,1,"tr",10),t.qZA()),2&n){const e=t.oxw();t.Akn(e.tableStyle),t.xp6(2),t.Q6J("ngForOf",e.thickness),t.xp6(1),t.Q6J("ngForOf",e.tableData.thickness)}}function ie(n,s){if(1&n&&(t.TgZ(0,"div",18),t._uU(1),t.qZA()),2&n){const e=s.$implicit,i=s.index;t.xp6(1),t.AsE(" ",i+1,". ",e," ")}}function ne(n,s){if(1&n&&(t.TgZ(0,"th")(1,"b",17),t._uU(2),t.qZA()()),2&n){const e=s.$implicit;t.xp6(2),t.Oqu(e.name)}}function ae(n,s){if(1&n&&(t.TgZ(0,"td"),t._uU(1),t.qZA()),2&n){const e=s.$implicit,i=t.oxw().$implicit;t.xp6(1),t.hij(" ",i[e.props]," ")}}function se(n,s){if(1&n&&(t.TgZ(0,"tr"),t.YNc(1,ae,2,1,"td",10),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.inspectionHistory)}}const oe=function(){return[0,3]};A().vfs=L.I.vfs;let z=(()=>{class n{constructor(e,i){this.toastr=e,this.reportService=i,this.tableStyle={"font-size":"12px"},this.thickness=[{name:"Id",props:"piping_id",width:"*"},{name:"Reading",props:"reading",width:"auto"},{name:"T min",props:"min_required_thickness",width:"auto"},{name:"LT CR",props:"lt_cr",width:"auto"},{name:"ST CR",props:"min_required_thickness",width:"auto"},{name:"RL",props:"remaining_life",width:"auto"},{name:"HL",props:"half_life",width:"auto"},{name:"Retirement Date",props:"retirement_date",width:"*"},{name:"Next TM",props:"next_tm_insp_date",width:"*"},{name:"Next VE",props:"next_ve_insp_date",width:"*"},{name:"MAWP",props:"mawp",width:"*"}],this.inspectionHistory=[{name:"Insp Id",props:"proposal_id",width:"*"},{name:"Insp Date",props:"inspection_date",width:"auto"},{name:"Insp Summary",props:"inspection_summary",width:"auto"},{name:"Carried Out",props:"carried_out",width:"auto"}],this.refreshPage=new t.vpe}ngOnInit(){this.randomString=(Math.random()+1).toString(36).substring(7),A().tableLayouts={exampleLayout:{hLineWidth:function(e,i){return 0===e||e===i.table.body.length?0:e===i.table.headerRows?2:1},vLineWidth:function(e){return 0},hLineColor:function(e){return 1===e?"black":"#aaa"},paddingLeft:function(e){return 0===e?0:8},paddingRight:function(e,i){return e===i.table.widths.length-1?0:8}}}}printAsPDF(e){this.tableData=e,console.log(e),setTimeout(()=>{this.downloadAsPDF().print()},500)}publishReport(e){this.tableData=e,setTimeout(()=>{const i=this.downloadAsPDF();i.getBlob(a=>{var o;const r=null===(o=this.tableData)||void 0===o?void 0:o.piping_name,g=new File([a],r+".pdf"),p=new FormData;p.append("qr_code",g),p.append("title",this.randomString),this.reportService.addQRCode(p).subscribe(()=>this.toastr.success("Your Report has been published.","QR Code has been added."),()=>this.toastr.danger("Your Report failed to published.","Failed to generate qr code.")),this.reportService.publishReportCircuit({qr_code:this.randomString},this.tableData.id).subscribe(()=>this.toastr.success("Your Report has been published.","Success Publish Report."),()=>this.toastr.danger("Your Report failed to published.","Failed Publish Report."),()=>this.refreshPage.emit(!0))}),i.download()},500)}generateData(e){this.tableData=e,setTimeout(()=>{this.downloadAsPDF()},500)}downloadAsPDF(){var e;const i=this.pdfThickness.nativeElement;let a=Q()(i.innerHTML);(null===(e=this.tableData)||void 0===e?void 0:e.qr_code)&&(a[2].table.body[0][2].stack[0]={qr:x.N.apiUrl+"/qr_code/"+this.tableData.qr_code,fit:"135"}),this.tableData.qr_code||(a[2].table.body[0][2].stack[0]={qr:x.N.apiUrl+"/qr_code/"+this.randomString,fit:"135"}),a[2].table.body[0][2].stack[1]={text:this.tableData.circuit_id,alignment:"center",bold:!0};const o={content:[a,{image:this.tableData.trend_chart,fit:[500,500]}],pageBreakBefore:function(r){return r.style&&r.style.indexOf("pdf-pagebreak-before")>-1}};return A().createPdf(o)}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(l.quB),t.Y36(P))},n.\u0275cmp=t.Xpm({type:n,selectors:[["report-cml-pdf"]],viewQuery:function(e,i){if(1&e&&t.Gf(zt,5),2&e){let a;t.iGM(a=t.CRH())&&(i.pdfThickness=a.first)}},outputs:{refreshPage:"refresh"},decls:57,vars:13,consts:[[1,"container",2,"display","none"],["id","Thickness"],["pdfThickness",""],[2,"width","100%","margin","0 0 1rem 0","color","#5588EE"],[2,"margin","1rem 0 0 0"],["data-pdfmake","{'layout' : 'noBorders', 'widths' : ['20%', '55%', '*']}"],[2,"color","darkgray"],["rowspan","4",1,"qr_code"],[2,"color","darkgray","font-size","8px"],["data-pdfmake","{'layout' : 'noBorders', 'widths' : ['*', '*', '*', '*', '*', '*']}"],[4,"ngFor","ngForOf"],["data-pdfmake",'{"widths":["*", "auto", "auto", "auto", "auto", "auto", "auto", "*", "*", "*", "*"], "layout" : "exampleLayout"}',3,"style",4,"ngIf"],[2,"font-weight","bold","color","darkgray"],["style","margin: 0 0 0 0.5rem;",4,"ngFor","ngForOf"],["data-pdfmake",'{"widths":["*", "*", "*", "*"], "layout" : "exampleLayout"}'],[1,"pdf-pagebreak-before",2,"margin","1rem 0 0 0"],["data-pdfmake",'{"widths":["*", "auto", "auto", "auto", "auto", "auto", "auto", "*", "*", "*", "*"], "layout" : "exampleLayout"}'],[2,"font-weight","bold"],[2,"margin","0 0 0 0.5rem"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0)(1,"div",1,2)(3,"h5",3),t._uU(4),t.qZA(),t.TgZ(5,"span",4)(6,"b"),t._uU(7,"Pipe Details"),t.qZA()(),t.TgZ(8,"table",5)(9,"tr")(10,"td",6),t._uU(11," Date in Service "),t.qZA(),t.TgZ(12,"td"),t._uU(13),t.qZA(),t.TgZ(14,"td",7)(15,"div",8),t._uU(16,"QR Code Not Available"),t.qZA()()(),t.TgZ(17,"tr")(18,"td",6),t._uU(19," Class "),t.qZA(),t.TgZ(20,"td"),t._uU(21),t.qZA()(),t.TgZ(22,"tr")(23,"td",6),t._uU(24," Notes "),t.qZA(),t.TgZ(25,"td"),t._uU(26),t.qZA()(),t.TgZ(27,"tr")(28,"td",6),t._uU(29," Recomendation "),t.qZA(),t.TgZ(30,"td"),t._uU(31),t.qZA()()(),t.TgZ(32,"span",4)(33,"b"),t._uU(34,"Pipe Visual"),t.qZA()(),t.TgZ(35,"table",9),t.YNc(36,Wt,2,2,"tr",10),t.qZA(),t.TgZ(37,"span",4)(38,"b"),t._uU(39,"Pipe Thickness"),t.qZA()(),t.YNc(40,ee,4,4,"table",11),t.TgZ(41,"span",4)(42,"b"),t._uU(43,"Pipe Circuit Damage Mechanism"),t.qZA()(),t.TgZ(44,"span",12),t._uU(45,"Active Damage Mechanism"),t.qZA(),t.YNc(46,ie,2,2,"div",13),t.TgZ(47,"span",4)(48,"b"),t._uU(49,"Inspection History"),t.qZA()(),t.TgZ(50,"table",14)(51,"tr"),t.YNc(52,ne,3,1,"th",10),t.qZA(),t.YNc(53,se,2,1,"tr",10),t.qZA(),t.TgZ(54,"span",15)(55,"b"),t._uU(56,"Trend"),t.qZA()()()()),2&e&&(t.xp6(4),t.hij("Circuit ",null==i.tableData?null:i.tableData.piping_circuit_id,""),t.xp6(9),t.hij(" ",null==i.tableData?null:i.tableData.date_in_service," "),t.xp6(8),t.hij(" ",null==i.tableData?null:i.tableData.class," "),t.xp6(5),t.hij(" ",null==i.tableData?null:i.tableData.notes," "),t.xp6(5),t.hij(" ",(null==i.tableData?null:i.tableData.recomendation)||"-"," "),t.xp6(5),t.Q6J("ngForOf",t.DdM(12,oe)),t.xp6(4),t.Q6J("ngIf",i.tableData),t.xp6(6),t.Q6J("ngForOf",null==i.tableData?null:i.tableData.damage_mechanism),t.xp6(4),t.Akn(i.tableStyle),t.xp6(2),t.Q6J("ngForOf",i.inspectionHistory),t.xp6(1),t.Q6J("ngForOf",null==i.tableData?null:i.tableData.inspection_history))},directives:[f.sg,f.O5],encapsulation:2}),n})();var re=c(2787);function pe(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"nb-option",20),t.NdJ("click",function(){const o=t.CHM(e).$implicit;return t.oxw().filterByClass(o)}),t._uU(1),t.qZA()}if(2&n){const e=s.$implicit;t.Q6J("value",e),t.xp6(1),t.Oqu(e)}}function le(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"nb-option",20),t.NdJ("click",function(){const o=t.CHM(e).$implicit;return t.oxw().filterByClass(o)}),t._uU(1),t.qZA()}if(2&n){const e=s.$implicit;t.Q6J("value",e),t.xp6(1),t.Oqu(e)}}const ce=function(){return{width:"40px"}};function ue(n,s){1&n&&(t.TgZ(0,"th",21),t._uU(1," Circuit Id "),t.qZA()),2&n&&t.Q6J("ngStyle",t.DdM(1,ce))}const de=function(n){return{color:n}};function _e(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"td",22,23),t.NdJ("mouseover",function(){return t.CHM(e),t.MAs(1).style.color="#0492c2"})("mouseout",function(){const o=t.CHM(e).$implicit;return t.MAs(1).style.color=t.oxw().selectionData.piping_circuit_id==o.piping_circuit_id?"#0492c2":"black"})("click",function(){const o=t.CHM(e).$implicit;return t.oxw().showData(o)}),t._uU(2),t.qZA()}if(2&n){const e=s.$implicit,i=t.oxw();t.Q6J("ngStyle",t.VKq(2,de,i.selectionData.piping_circuit_id==e.piping_circuit_id?"#0492c2":"black")),t.xp6(2),t.hij(" ",e.piping_circuit_id," ")}}function me(n,s){1&n&&t._UZ(0,"tr",24)}function he(n,s){1&n&&t._UZ(0,"tr",25)}function ge(n,s){1&n&&(t.TgZ(0,"h5"),t._uU(1,"Please Add Circuit Data."),t.qZA())}function fe(n,s){1&n&&(t.TgZ(0,"span"),t._uU(1,"No Image Available"),t.qZA())}function be(n,s){if(1&n&&(t.TgZ(0,"div",54)(1,"div",55),t._UZ(2,"img",56),t.qZA()()),2&n){const e=s.$implicit;t.Q6J("ngClass",0==s.index?"active":""),t.xp6(2),t.Q6J("src",e.src,t.LSH)("alt",null==e?null:e.alt)}}function xe(n,s){if(1&n&&(t.TgZ(0,"div",57),t._UZ(1,"ngx-qrcode",58),t.qZA()),2&n){const e=t.oxw(2);t.xp6(1),t.Q6J("elementType",e.elementType)("errorCorrectionLevel",e.correctionLevel)("value",e.reportURL)}}function Te(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"button",59),t.NdJ("click",function(){t.CHM(e);const a=t.oxw(2);return a.pdfReportCML.publishReport(a.reportData)}),t._uU(1," Publish Report "),t.qZA()}}function Ze(n,s){if(1&n&&(t.TgZ(0,"div",8)(1,"span",60),t._uU(2),t.qZA(),t.TgZ(3,"span",4),t._uU(4),t.qZA()()),2&n){const e=s.$implicit;t.xp6(2),t.Oqu(e.name),t.xp6(2),t.Oqu(e.data)}}function De(n,s){1&n&&(t.TgZ(0,"div"),t._uU(1,"No data"),t.qZA())}const M=function(){return{show:!1}},ve=function(){return{pageSize:5}};function Ae(n,s){if(1&n&&t._UZ(0,"ngx-mat-table",61),2&n){const e=t.oxw(2);t.Q6J("tableHeader",t.DdM(4,M))("tableFooter",t.DdM(5,ve))("columnDetails",e.columnDetails)("tableData",e.pipingThicknessData)}}function Ce(n,s){if(1&n&&(t.TgZ(0,"nb-list-item",62),t._uU(1),t.qZA()),2&n){const e=s.$implicit;t.xp6(1),t.hij(" ",e," ")}}function ye(n,s){1&n&&(t.TgZ(0,"div"),t._uU(1,"No data"),t.qZA())}function Re(n,s){if(1&n&&t._UZ(0,"ngx-inspection_history_table",63),2&n){const e=t.oxw(2);t.Q6J("tableHeader",t.DdM(3,M))("tableFooter",t.DdM(4,M))("tableData",e.inspectionHistoryData)}}function we(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"nb-card")(1,"nb-card-body")(2,"section")(3,"h6",26),t._uU(4),t.qZA(),t.TgZ(5,"div",8)(6,"div",27)(7,"div",28)(8,"div",29),t.YNc(9,fe,2,0,"span",18),t.YNc(10,be,3,3,"div",30),t.qZA(),t.TgZ(11,"button",31),t._UZ(12,"span",32),t.TgZ(13,"span",33),t._uU(14,"Previous"),t.qZA()(),t.TgZ(15,"button",34),t._UZ(16,"span",35),t.TgZ(17,"span",33),t._uU(18,"Next"),t.qZA()()()(),t.TgZ(19,"div",36)(20,"div"),t.YNc(21,xe,2,3,"div",37),t.YNc(22,Te,2,0,"button",38),t.TgZ(23,"div",39)(24,"button",40),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return a.pdfReportCML.printAsPDF(a.reportData)}),t._UZ(25,"nb-icon",41),t.qZA(),t.TgZ(26,"button",42),t.NdJ("click",function(){return t.CHM(e),t.oxw().seeDocument()}),t._UZ(27,"nb-icon",43),t.qZA()()()()(),t.TgZ(28,"div")(29,"span",44),t._uU(30,"Comment"),t.qZA(),t.TgZ(31,"span",45),t._uU(32),t.qZA()(),t.TgZ(33,"div",46)(34,"span",47),t._uU(35,"Date In Service"),t.qZA(),t.TgZ(36,"span",27),t._uU(37),t.qZA(),t.TgZ(38,"span",47),t._uU(39,"Class"),t.qZA(),t.TgZ(40,"span",27),t._uU(41),t.qZA(),t.TgZ(42,"span",47),t._uU(43,"Notes"),t.qZA(),t.TgZ(44,"span",27),t._uU(45),t.qZA()(),t.TgZ(46,"span",44),t._uU(47,"Recomendation"),t.qZA(),t.TgZ(48,"p"),t._uU(49),t.qZA()(),t.TgZ(50,"section")(51,"h6",26),t._uU(52,"Piping Visual"),t.qZA(),t.TgZ(53,"div",48),t.YNc(54,Ze,5,2,"div",49),t.qZA()(),t.TgZ(55,"section",50)(56,"h6",26),t._uU(57,"Piping Thickness"),t.qZA(),t.YNc(58,De,2,0,"div",18),t.YNc(59,Ae,1,6,"ngx-mat-table",51),t.qZA(),t.TgZ(60,"section")(61,"h6",26),t._uU(62,"Piping Circuit Damage Mechanisms"),t.qZA(),t.TgZ(63,"span",44),t._uU(64,"Active Damage Mechanism"),t.qZA(),t.TgZ(65,"nb-list"),t.YNc(66,Ce,2,1,"nb-list-item",52),t.qZA()(),t.TgZ(67,"section")(68,"h6",26),t._uU(69,"Inspection History"),t.qZA(),t.YNc(70,ye,2,0,"div",18),t.YNc(71,Re,1,5,"ngx-inspection_history_table",53),t.qZA(),t.TgZ(72,"section")(73,"h6",26),t._uU(74,"Trend"),t.qZA(),t._UZ(75,"ngx-piping-circuit-chart"),t.qZA()()()}if(2&n){const e=t.oxw();t.xp6(4),t.Oqu(null==e.selectionData?null:e.selectionData.piping_circuit_id),t.xp6(5),t.Q6J("ngIf",!e.imageLink),t.xp6(1),t.Q6J("ngForOf",e.imageLink),t.xp6(11),t.Q6J("ngIf",e.reportURL),t.xp6(1),t.Q6J("ngIf",!e.reportURL),t.xp6(4),t.Q6J("disabled",!(null!=e.reportData&&e.reportData.attachment)),t.xp6(6),t.Oqu((null==e.selectionData?null:e.selectionData.comment)||"-"),t.xp6(5),t.Oqu(null==e.selectionData?null:e.selectionData.date_in_service),t.xp6(4),t.Oqu(null==e.selectionData?null:e.selectionData.class),t.xp6(4),t.Oqu(null==e.selectionData?null:e.selectionData.notes),t.xp6(4),t.Oqu(null==e.selectionData?null:e.selectionData.recomendation),t.xp6(5),t.Q6J("ngForOf",e.pipingVisual),t.xp6(4),t.Q6J("ngIf",!e.pipingThicknessData.length),t.xp6(1),t.Q6J("ngIf",e.pipingThicknessData.length),t.xp6(7),t.Q6J("ngForOf",e.activeDamageMechaninsm),t.xp6(4),t.Q6J("ngIf",!e.inspectionHistoryData.length),t.xp6(1),t.Q6J("ngIf",e.inspectionHistoryData.length)}}const qe=function(){return["All",1,2,3,4]},Pe=function(){return["No Filter","Normal","Abnormal"]},ke=[{path:"",component:V,children:[{path:"piping-assets",component:Et},{path:"piping-circuits",component:(()=>{class n{constructor(e,i,a){this.pipingCircuitService=e,this.reportService=i,this.variables=a,this.elementType=D.TT.URL,this.correctionLevel=D.Jk.HIGH,this.datasets=[{label:"Reading (mm)",yAxisID:"A",prop:"reading"},{label:"T minimum (mm)",yAxisID:"A",prop:"min_required_thickness"},{label:"Nominal Thickness (mm)",yAxisID:"A",prop:"nominal_thickness"},{label:"Corrosion Rate (mm/Year)",yAxisID:"B",prop:"lt_cr"}],this.tablePosition=[],this.dataSource=new u.by(this.tablePosition),this.displayedColumns=["piping_circuit_id"],this.resultsLength=0,this.imageLink=[],this.pipingVisual=[{name:"Leaks",props:"leaks_condition",data:null},{name:"Misalignment",props:"misalignment_condition",data:null},{name:"Vibration",props:"vibration_condition",data:null},{name:"Supports",props:"supports_condition",data:null},{name:"Corrosion",props:"corrosion_condition",data:null},{name:"Insulation",props:"insulation_condition",data:null}],this.activeDamageMechaninsm=[],this.pipingThicknessData=[],this.columnDetails=[{type:"text",prop:"piping_id",head:"Piping Id",width:"200px"},{type:"text",prop:"reading",head:"Reading (mm)",width:"200px"},{type:"text",prop:"min_required_thickness",head:"T min (mm)",width:"200px"},{type:"text",prop:"lt_cr",head:"LT CR (mm/Year)",width:"200px"},{type:"text",prop:"st_cr",head:"ST CR (mm/Year)",width:"200px"},{type:"text",prop:"remaining_life",head:"RL (Years)",width:"200px"},{type:"text",prop:"half_life",head:"HL (Years)",width:"200px"},{type:"text",prop:"retirement_date",head:"Retirement date",width:"200px"},{type:"text",prop:"next_tm_insp_date",head:"Next TM",width:"200px"},{type:"text",prop:"next_ve_insp_date",head:"Next VE",width:"200px"},{type:"text",prop:"mawp",head:"MAWP",width:"200px"}],this.inspectionHistoryData=[],this.inspectionHistoryDetails=[{type:"text",prop:"proposal_id",head:"Inspection Id",width:"100px"},{type:"editable date",prop:"inspection_date",head:"Inspection Date",width:"200px"},{type:"text",prop:"inspection_summary",head:"Inspection Summary",width:"300px"},{type:"text",prop:"coverage",head:"%",width:"30px"},{type:"check",prop:"caried_out",head:"Caried Out",width:"50px"}]}ngOnInit(){this.pipingCircuitService.getPipingCircuits().subscribe(({data:e})=>{this.tablePosition=e;const i=e[0];!i||(this.showData(i),this.getCircuitReport(null==i?void 0:i.id),this.dataSource=new u.by(e),this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort)})}getCircuitReport(e){this.reportService.getCircuitReport(e).subscribe(({data:{assets:i,proposals:a}})=>{var o;const r=i.map(({asset:p,cml:h})=>Object.assign(Object.assign({},p),{cml:h}));this.circuitChartData(this.circuitChart,{piping:r}),this.pipingVisual=this.pipingVisual.map(({name:p,props:h})=>({name:p,props:h,data:this.variables.visualToLevel(Math.round(this.variables.visualConditionAvg(i,h)/i.length))}));let g=[];for(let p of a)null===(o=null==p?void 0:p.inspection_method)||void 0===o||o.forEach(({type:h,method:b,technique:d,coverage:_,active:m,inspection_date:T,carried_out:v})=>{g.push(Object.assign(Object.assign({},p),{inspection_summary:` ${h} ${b} ${d}`,type:h,method:b,technique:d,coverage:_,active:m,carried_out:v,inspection_date:T}))});this.inspectionHistoryData=g,i.filter(p=>null!=p).forEach(({damage_mechanism:p})=>{this.variables.damageMechanismName.map(({id:d,piping_damage_mechanism:_})=>{const m=null==p?void 0:p[d];return m?Object.assign(Object.assign({},m),{piping_damage_mechanism:_}):null}).filter(d=>null!=d).map(({piping_damage_mechanism:d})=>d).forEach(d=>{this.activeDamageMechaninsm.includes(d)||this.activeDamageMechaninsm.push(d)})}),this.pipingThicknessData=i.map(p=>{const{min_required_thickness:h,reading:b,lt_cr:d,st_cr:_,remaining_life:m,half_life:T,retirement_date:v,next_tm_insp_date:R,next_ve_insp_date:O,mawp:N}=this.variables.getThicknessCalculation(Object.assign(Object.assign({},p.asset),{cml:p.cml}));return Object.assign(Object.assign({},p.asset),{min_required_thickness:h.toFixed(2),reading:b.toFixed(2),lt_cr:d.toFixed(2),st_cr:_.toFixed(2),remaining_life:m.toFixed(2),half_life:T.toFixed(2),retirement_date:v,next_tm_insp_date:R,next_ve_insp_date:O,mawp:N.toFixed(2)})}),this.reportData=Object.assign(Object.assign({},this.selectionData),{piping_visual:this.pipingVisual,thickness:this.pipingThicknessData,damage_mechanism:this.activeDamageMechaninsm,inspection_history:this.inspectionHistoryData,trend_chart:this.circuitChart.chart.toBase64Image()})})}circuitChartData(e,i){const{piping:a}=i,o=null==a?void 0:a.map(p=>p.piping_id);this.variables.removeChartData(this.circuitChart);const r=a.map(p=>this.variables.getThicknessCalculation(p));e.data.labels=o;const g=this.datasets.map(p=>{const h="#"+(16777216*Math.random()|0).toString(16).padStart(6,"0"),b=o.map(d=>r.find(_=>_.piping_id==d)[p.prop]);return Object.assign(Object.assign({},p),{borderColor:h,backgroundColor:h,data:b})});e.chart.data.datasets=g,e.chart.update()}filterByClass(e){let i=this.tablePosition.filter(a=>a.class==e);"All"==e&&(i=this.tablePosition),this.dataSource=new u.by(i)}showData(e){var i;this.selectionData=e,this.getCircuitReport(e.id),this.imageLink=null===(i=null==e?void 0:e.images)||void 0===i?void 0:i.map(o=>({src:x.N.apiUrl+"/image/"+o,alt:"Pipe Asssets"}));const a=e.qr_code;a&&(this.reportURL=x.N.apiUrl+"/qr_code/"+e.qr_code),a||(this.reportURL=null)}applyFilter(e){this.dataSource.filter=e.target.value.trim().toLowerCase(),this.dataSource.paginator&&this.dataSource.paginator.firstPage()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(re.t),t.Y36(P),t.Y36(j.L))},n.\u0275cmp=t.Xpm({type:n,selectors:[["ngx-report-piping-circuit"]],viewQuery:function(e,i){if(1&e&&(t.Gf(E,5),t.Gf(z,5),t.Gf(C.NW,5),t.Gf(Z.YE,5)),2&e){let a;t.iGM(a=t.CRH())&&(i.circuitChart=a.first),t.iGM(a=t.CRH())&&(i.pdfReportCML=a.first),t.iGM(a=t.CRH())&&(i.paginator=a.first),t.iGM(a=t.CRH())&&(i.sort=a.first)}},decls:34,vars:14,consts:[[1,"d-flex","justify-content-between"],["matInput","","placeholder","Ex. Mia",3,"keyup"],["input",""],[1,"row","row-cols-2"],[1,"col"],["placeholder","Class","status","primary","size","small",1,"",3,"selected"],[3,"value","click",4,"ngFor","ngForOf"],["placeholder","MAWP","status","primary","size","small",1,"",3,"selected"],[1,"row"],[1,"col-3"],["mat-table","","matSort","",1,"mat-elevation-z8",2,"width","100%","box-shadow","none",3,"dataSource"],["matColumnDef","piping_circuit_id"],["mat-header-cell","","mat-sort-header","",3,"ngStyle",4,"matHeaderCellDef"],["mat-cell","","style","cursor : pointer",3,"ngStyle","mouseover","mouseout","click",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",4,"matRowDef","matRowDefColumns"],["aria-label","Select page of GitHub search results",3,"length","pageSize"],[1,"col-9"],[4,"ngIf"],[3,"refresh"],[3,"value","click"],["mat-header-cell","","mat-sort-header","",3,"ngStyle"],["mat-cell","",2,"cursor","pointer",3,"ngStyle","mouseover","mouseout","click"],["nameCell",""],["mat-header-row",""],["mat-row",""],[1,"fw-bolder","text-primary","mb-2","d-block"],[1,"col-8"],["id","carouselExampleInterval","data-bs-ride","carousel",1,"carousel","slide"],[1,"carousel-inner"],["class","carousel-item","data-bs-interval","10000",3,"ngClass",4,"ngFor","ngForOf"],["type","button","data-bs-target","#carouselExampleInterval","data-bs-slide","prev",1,"carousel-control-prev"],["aria-hidden","true",1,"carousel-control-prev-icon"],[1,"visually-hidden"],["type","button","data-bs-target","#carouselExampleInterval","data-bs-slide","next",1,"carousel-control-next"],["aria-hidden","true",1,"carousel-control-next-icon"],[1,"col-4","d-flex","justify-content-center","align-self-center"],["class","border rounded",4,"ngIf"],["nbButton","","status","primary","class","mt-2 me-2 w-100","size","small","outline","",3,"click",4,"ngIf"],[1,"d-flex"],["nbButton","","status","primary","size","small","outline","","nbPopover","Print Report","nbPopoverTrigger","hint",1,"mt-2","me-2","w-100",3,"click"],["icon","printer-outline"],["nbButton","","status","primary","size","small","outline","","nbPopover","See Attachment","nbPopoverTrigger","hint",1,"mt-2","ms-2","w-100",3,"disabled","click"],["icon","file-text-outline"],[1,"text-secondary"],[1,"d-block"],[1,"row","mt-3"],[1,"text-secondary","col-4"],[1,"row","row-cols-3"],["class","row",4,"ngFor","ngForOf"],[1,"mt-3"],[3,"tableHeader","tableFooter","columnDetails","tableData",4,"ngIf"],["style","height: 1rem;",4,"ngFor","ngForOf"],[3,"tableHeader","tableFooter","tableData",4,"ngIf"],["data-bs-interval","10000",1,"carousel-item",3,"ngClass"],[1,"overflow-hidden","d-flex","align-justify-center",2,"height","15rem"],[1,"w-100","img-fluid",3,"src","alt"],[1,"border","rounded"],[3,"elementType","errorCorrectionLevel","value"],["nbButton","","status","primary","size","small","outline","",1,"mt-2","me-2","w-100",3,"click"],[1,"col","text-secondary"],[3,"tableHeader","tableFooter","columnDetails","tableData"],[2,"height","1rem"],[3,"tableHeader","tableFooter","tableData"]],template:function(e,i){1&e&&(t.TgZ(0,"nb-card")(1,"nb-card-header",0)(2,"div")(3,"h5"),t._uU(4,"Piping Circuit"),t.qZA(),t.TgZ(5,"mat-form-field")(6,"mat-label"),t._uU(7,"Hit Enter To Search"),t.qZA(),t.TgZ(8,"input",1,2),t.NdJ("keyup",function(o){return i.applyFilter(o)}),t.qZA()()(),t.TgZ(10,"div",3)(11,"div",4),t._uU(12,"Class"),t.qZA(),t.TgZ(13,"div",4)(14,"nb-select",5),t.YNc(15,pe,2,2,"nb-option",6),t.qZA()(),t.TgZ(16,"div",4),t._uU(17,"MAWP"),t.qZA(),t.TgZ(18,"div",4)(19,"nb-select",7),t.YNc(20,le,2,2,"nb-option",6),t.qZA()()()(),t.TgZ(21,"nb-card-body",8)(22,"div",9)(23,"table",10),t.ynx(24,11),t.YNc(25,ue,2,2,"th",12),t.YNc(26,_e,3,4,"td",13),t.BQk(),t.YNc(27,me,1,0,"tr",14),t.YNc(28,he,1,0,"tr",15),t.qZA(),t._UZ(29,"mat-paginator",16),t.qZA(),t.TgZ(30,"div",17),t.YNc(31,ge,2,0,"h5",18),t.YNc(32,we,76,17,"nb-card",18),t.qZA()()(),t.TgZ(33,"report-cml-pdf",19),t.NdJ("refresh",function(){return i.ngOnInit()}),t.qZA()),2&e&&(t.xp6(14),t.Q6J("selected","All"),t.xp6(1),t.Q6J("ngForOf",t.DdM(12,qe)),t.xp6(4),t.Q6J("selected","No Filter"),t.xp6(1),t.Q6J("ngForOf",t.DdM(13,Pe)),t.xp6(3),t.Q6J("dataSource",i.dataSource),t.xp6(4),t.Q6J("matHeaderRowDef",i.displayedColumns)("matHeaderRowDefSticky",!0),t.xp6(1),t.Q6J("matRowDefColumns",i.displayedColumns),t.xp6(1),t.Q6J("length",i.resultsLength)("pageSize",30),t.xp6(2),t.Q6J("ngIf",!i.selectionData),t.xp6(1),t.Q6J("ngIf",i.selectionData))},directives:[l.Asz,l.ndF,y.KE,y.hX,U.Nt,l.rs,f.sg,l.q51,l.yKW,u.BZ,Z.YE,u.w1,u.fO,u.ge,Z.nU,f.PC,u.Dz,u.ev,u.as,u.XQ,u.nj,u.Gk,C.NW,f.O5,f.mk,D.zF,l.DPz,l.ydg,l.fMN,w.V,l.zP_,l.qBV,$,E,z],encapsulation:2}),n})()}]}];let Ue=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[k.Bz.forChild(ke)],k.Bz]}),n})();var Fe=c(9511),Me=c(2368),Oe=c(7446),Ne=c(4107);let Se=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[f.ez,G.O,Ue,l.zyh,l.x4g,l.IIj,l.nKr,l.COg,l.T2N,l.KdK,Fe.H,Me.rP,u.p0,Oe.p9,C.TU,y.lN,U.c,Ne.LD,Z.JX,D.F5,l.LW9.forRoot({destroyByClick:!0,duration:3e3,position:l.fe3.BOTTOM_RIGHT,preventDuplicates:!0,limit:3}),l.spT]]}),n})()}}]);